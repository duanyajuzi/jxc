if(typeof JSON!=="object"){JSON={}}(function(){function f(n){return n<10?"0"+n:n}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+" "+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds()):null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)}if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){if(typeof rep[i]==="string"){k=rep[i];v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" "}}else{if(typeof space==="string"){indent=space}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":value})}}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}}());!function(b){"function"==typeof define&&define.amd?define(["jquery"],b):"object"==typeof exports?module.exports=b:b(jQuery)}(function(v){function u(z){var y=z||window.event,x=n.call(arguments,1),w=0,k=0,i=0,f=0,e=0,d=0;if(z=v.event.fix(y),z.type="mousewheel","detail" in y&&(i=-1*y.detail),"wheelDelta" in y&&(i=y.wheelDelta),"wheelDeltaY" in y&&(i=y.wheelDeltaY),"wheelDeltaX" in y&&(k=-1*y.wheelDeltaX),"axis" in y&&y.axis===y.HORIZONTAL_AXIS&&(k=-1*i,i=0),w=0===i?k:i,"deltaY" in y&&(i=-1*y.deltaY,w=i),"deltaX" in y&&(k=y.deltaX,0===i&&(w=-1*k)),0!==i||0!==k){if(1===y.deltaMode){var c=v.data(this,"mousewheel-line-height");w*=c,i*=c,k*=c}else{if(2===y.deltaMode){var a=v.data(this,"mousewheel-page-height");w*=a,i*=a,k*=a}}if(f=Math.max(Math.abs(i),Math.abs(k)),(!q||q>f)&&(q=f,s(y,f)&&(q/=40)),s(y,f)&&(w/=40,k/=40,i/=40),w=Math[w>=1?"floor":"ceil"](w/q),k=Math[k>=1?"floor":"ceil"](k/q),i=Math[i>=1?"floor":"ceil"](i/q),l.settings.normalizeOffset&&this.getBoundingClientRect){var A=this.getBoundingClientRect();e=z.clientX-A.left,d=z.clientY-A.top}return z.deltaX=k,z.deltaY=i,z.deltaFactor=q,z.offsetX=e,z.offsetY=d,z.deltaMode=0,x.unshift(z,w,k,i),r&&clearTimeout(r),r=setTimeout(t,200),(v.event.dispatch||v.event.handle).apply(this,x)}}function t(){q=null}function s(d,c){return l.settings.adjustOldDeltas&&"mousewheel"===d.type&&c%120===0}var r,q,p=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],o="onwheel" in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],n=Array.prototype.slice;if(v.event.fixHooks){for(var m=p.length;m;){v.event.fixHooks[p[--m]]=v.event.mouseHooks}}var l=v.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener){for(var a=o.length;a;){this.addEventListener(o[--a],u,!1)}}else{this.onmousewheel=u}v.data(this,"mousewheel-line-height",l.getLineHeight(this)),v.data(this,"mousewheel-page-height",l.getPageHeight(this))},teardown:function(){if(this.removeEventListener){for(var a=o.length;a;){this.removeEventListener(o[--a],u,!1)}}else{this.onmousewheel=null}v.removeData(this,"mousewheel-line-height"),v.removeData(this,"mousewheel-page-height")},getLineHeight:function(a){var f=v(a),e=f["offsetParent" in v.fn?"offsetParent":"parent"]();return e.length||(e=v("body")),parseInt(e.css("fontSize"),10)||parseInt(f.css("fontSize"),10)||16},getPageHeight:function(a){return v(a).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};v.fn.extend({mousewheel:function(b){return b?this.bind("mousewheel",b):this.trigger("mousewheel")},unmousewheel:function(b){return this.unbind("mousewheel",b)}})});$.extend({GLOBALCONFIG:{dateformat:"yyyy-MM-dd HH:mi:ss",ctxpath:"",basePath:"",fileServerBasePath:"",uploadFileAction:"",downloadFileAction:"",outputImgAction:"",defaultImg:"",errorImg:"",uploadBizFile:"",gotoURLAction:"",gridDefaultType:"opensql"},globalConfig:function(b){var d,c,a;if(!$.isPlainObject(b)){if(typeof b=="string"){return $.GLOBALCONFIG[b]}return}c=$.GLOBALCONFIG;a=$.Lang;$.each(c,function(e,f){b.hasOwnProperty(e)&&a.isString(d=b[e])&&d.length&&(c[e]=d)})},getGuid:function(){var a=false;$.ajax({url:"sqlmap/getuuid",type:"POST",data:{},dataType:"json",async:false,success:function(b){if(b.uuid){a=b.uuid}else{alert("生成guid异常!");throw new Error()}},error:function(){alert("生成guid异常!");throw new Error("生成guid异常!")}});return a},getViewportSize:function(b){var a;if(!$.isWindow(b)){return{w:0,h:0}}a=b.document;if(a.compatMode==="CSS1Compat"){return{w:a.documentElement.clientWidth,h:a.documentElement.clientHeight}}return{w:a.body.clientWidth,h:a.body.clientHeight}},getScrollOffsets:function(b){var a;if(!$.isWindow(b)){return{x:0,y:0}}if("pageXOffset" in b){return{x:b.pageXOffset,y:b.pageYOffset}}a=b.document;if(a.compatMode==="CSS1Compat"){return{x:a.documentElement.scrollLeft,y:a.documentElement.scrollTop}}return{x:a.body.scrollLeft,y:a.body.scrollTop}}});(function(d,c){function a(e){b(e.self,c.GLOBALCONFIG.ctxpath+"/"+c.GLOBALCONFIG.errorImg)}function b(e,f){e.onerror=null;e.src=f}d.imgErrorHandler=a})(window,jQuery);(function(c,e){if(e.browser.msie){function b(){return false}c.onhelp=b;function d(){if((c.event.altKey)&&((c.event.keyCode==37)||(c.event.keyCode==39))){alert("不准使用ALT+方向键前进或后退网页！");event.returnValue=false}if(event.keyCode==166||event.keyCode==167){event.keyCode=0;event.returnValue=false}if(event.keyCode==8){if(event.srcElement.type!="text"&&event.srcElement.type!="textarea"&&event.srcElement.type!="password"){event.keyCode=0;event.returnValue=false}else{if(e(event.srcElement).attr("readonly")){event.keyCode=0;event.returnValue=false}}}if((event.ctrlKey&&event.keyCode==82)){event.keyCode=0;event.returnValue=false}if((event.ctrlKey)&&(event.keyCode==78)){event.returnValue=false}if(c.event.srcElement.tagName=="A"&&(c.event.shiftKey||c.event.ctrlKey)){c.event.returnValue=false}if((c.event.altKey)&&(c.event.keyCode==115)){c.showModelessDialog("about:blank","","dialogWidth:1px;dialogheight:1px");return false}if(c.event.keyCode>=112&&c.event.keyCode<=123){c.event.keyCode=0;c.event.returnValue=false}}function a(){if(c.event.shiftKey){c.event.returnValue=false}}document.onkeydown=d;document.onclick=a}})(window,jQuery);$.extend({callAjax:function(a){if(!$.isPlainObject(a.data)){a.data={}}if(a.url){if(a.url.indexOf("jspaction/")>=0){a.data={jspactionreqjson:JSON.stringify(a.data||{})}}else{if(a.url.indexOf("workflow/")>=0){a.data={workflowreqjson:JSON.stringify(a.data||{})}}}}$.ajax($.extend({dataType:"JSON",type:"post",beforeSend:function(b){if(a.showWaiting){if(top.$showwaiting){top.$showwaiting()}else{if($.ShowWaiting){$.ShowWaiting()}}}},complete:function(c,b){if(a.showWaiting){if(top.$hidewaiting){top.$hidewaiting()}else{if($.HideWaiting){$.HideWaiting()}}}},error:function(f,c,d){var b="";if(a.name){b="["+a.name+"]"}alert("调用Ajax服务"+b+"出错!\n可能原因:\n	■与服务器的网络中断\n	■找不到请求的页面["+this.url+"]");if(a.fail){a.fail(c,true)}else{if(typeof a.err=="function"){a.err(c,true)}}},success:function(b){if(b){if(b.errorCode){var c="未知业务异常["+b.errorCode+"]";if(b.errorMsg){c=b.errorMsg}alert(c);if(a.fail){a.fail(b,false)}else{if(typeof a.err=="function"){a.err(b,false)}}return}}if(typeof a.ok=="function"){a.ok(b)}}},a))},callFile:function(a,g){var h=[];var m=$("#lesfiledownform");if(m.length<1){$("body").append('<iframe style="display:none" id="lesfiledownf" name="lesfiledownf"></iframe><form id="lesfiledownform" style="display:none;" action="" method="post" target="lesfiledownf"></form>');m=$("#lesfiledownform")}if(arguments.length==1&&$.isPlainObject(arguments[0])){g=arguments[0];a=false}if(a===undefined||!a){if($.GLOBALCONFIG.downloadFileAction){a=$.GLOBALCONFIG.downloadFileAction}else{a="fileservice/filedownload"}}if(g){if(a.indexOf("jspaction/")>=0){g={jspactionreqjson:JSON.stringify(g||{})}}for(var b in g){var l=g[b];if(typeof l=="string"){h.push('<input type="hidden" name="'+b+'" value=""/>')}}}var k=a.indexOf("?");if(k>1){var d=a.substring(k+1);var e=d.split("&");for(var f=0;f<e.length;f++){var c=e[f].split("=");if(c.length>1){h.push('<input type="hidden" name="'+c[0]+'" value=""/>');g[c[0]]=c[1]}}a=a.substring(0,k)}m.attr("action",a).empty().append(h.join(""));m.find(":input").each(function(n){var o=$(this);o.val(g[o.attr("name")])});m.submit();return true},callDoc:function(c){if(c&&c.url){var b=c.url;var d=c.data||{};var a=c.templateUrl||"";d._resultFilename=c.fileName||"未命名.doc";if(b.indexOf("?")>0){b+="&_resultTempfile="+a}else{b+="?_resultTempfile="+a}$.callFile(b,d)}else{throw new Error("callDoc参数错误")}},callXls:function(c){if(c&&c.url){var b=c.url;var d=c.data||{};var a=c.templateUrl||"";d._resultFilename=c.fileName||"未命名.xls";if(b.indexOf("?")>0){b+="&_resultTempfile="+a}else{b+="?_resultTempfile="+a}$.callFile(b,d)}else{throw new Error("callXls参数错误")}},ajaxFileUpload:function(b){var a=new Date().getTime();var f="fuiframe"+a;var l="fuform"+a;var h=0;var i=[];i.push('<iframe id="'+f+'" name="'+f+'" style="position:absolute;top:-999px;left:-999px;width:10px;height:10px;"');if(window.ActiveXObject){i.push(' src="javascript:false;"')}i.push("></iframe>");i.push('<form style="position:absolute;top:-999px;left:-999px;width:10px;height:10px;" action="" method="POST" name="'+l+'" id="'+l+'" enctype="multipart/form-data">');if(b.data){for(var c in b.data){var k=b.data[c];if(k&&(typeof k=="string"||typeof k=="number")){i.push('<input type="hidden" name="'+c+'" value="" />');h++}}}i.push("</form>");$("body").append(i.join(""));var p=$("#"+l);if(h>0){p.find(":input").each(function(n){var q=$(this);q.val(""+b.data[q.attr("name")])})}var o=$("#"+b.fileElementId);var m=o.clone(true);o.attr("id","fufile"+a);o.before(m);p.append(o);if($.isFunction(b.beforeSend)){b.beforeSend()}var d=false;var g=false;var e=function(n){var t="上传文件失败:";d=true;if(n=="timeout"){if($.isFunction(b.complete)){b.complete()}t+="请求超时["+b.timeout+"]";if($.isFunction(b.error)){b.error(t)}else{alert(t);throw new Error(t)}return false}var q=document.getElementById(f);try{var s=q.contentWindow||q.contentDocument;if(s&&$.isFunction(s._uploadComplete)){g=s._uploadComplete()}}catch(r){g=false;t+="未知异常("+r+")"}if(g&&g.error){t=g.errorMsg;g=false}if(!g){if($.isFunction(b.complete)){b.complete()}if($.isFunction(b.error)){b.error(t)}else{alert(t);throw new Error(t)}return false}if($.isFunction(b.success)){b.success(g)}$(q).unbind();setTimeout(function(){$("#"+f).remove();$("#"+l).remove()},100);if($.isFunction(b.complete)){b.complete()}};if(b.timeout>0){setTimeout(function(){if(!d){e("timeout")}},b.timeout*1000)}p.attr("action",b.url).attr("target",f);$("#"+f).load(e);p.submit()}});var $gf_form_keyenter=function(n){var h=this;var a=n.target;if(a==null){return}if(n.ctrlKey==false&&n.shiftKey==false&&n.which==13){var p=h.elements.length+1;for(var d=0;d<h.elements.length;d+=1){var c=h.elements[d];if(a==c){p=d}if(d>p){if(!(c.disabled||c.readOnly||c.type=="hidden"||c.type=="button"||c.type=="submit"||c.type=="reset"||c.type=="file")){var m=false;var o=$(c);while(!m&&o.get(0)!=document.body){if(o.is(":hidden")){m=true}o=o.parent()}if(!m){c.focus();return false}}}}if(p==(h.elements.length-1)){var b=document.forms.length+1;for(var l=0;l<document.forms.length;l+=1){var i=document.forms[l];if(h==i){b=l}if(l>b){for(var q=0;q<i.elements.length;q+=1){var g=i.elements[q];if(!(g.disabled||g.readOnly)){g.focus();return false}}}}}}};$(function(){$("form").unbind("keypress",$gf_form_keyenter);$("form").bind("keypress",$gf_form_keyenter)});(function(c){var b=function(f){f._row=0;this.id=f.id;this.inputid=f.inputid;this.ops=f};function a(f){return'<div class="cfi-file-div" id="'+f.id+"_r"+f._row+'"></div>'}b.prototype._init=function(){var n=this;var m=[];var o=this.ops.buttons;var g=false;for(var l=0;l<o.length;l++){if(o[l].act=="up"){g=o[l].id;break}}if(g){var f=c("#"+g+"_myfile");var h=f.data("$conf");var k=false;if(h){if(!h.fileParams){h.fileParams={}}if(h.fileParams.uploadSuccess){k=h.fileParams.uploadSuccess}h.fileParams.uploadSuccess=function(i){n._addf(i);if(c.isFunction(k)){k(i)}}}}};b.prototype._setv=function(){var f=c("#"+this.id);var g=[];f.find(".cfi-file-div").each(function(k){var m=c(this);var n=m.attr("data-fid");var l=m.attr("data-fn");var h=m.attr("data-fs");var o=m.attr("data-ft");g.push(n+"|"+(l||"")+"|"+(h||"")+"|"+(o||""))});c("#"+this.inputid).val(g.join("*"))};b.prototype._addf=function(l){var p=c("#"+this.id);var m=this;var k;var n=this.ops.mutliFile;var o=this.ops.fileParams;if(!n){if(o.updateMode=="delete"){this.remove(true)}else{p.find(".cfi-file-div").remove()}}else{if(o&&o.maxCount){if(o.maxCount>1){if(p.find(".cfi-file-div").length>=o.maxCount){alert("最多只能上传"+o.maxCount+"个附件,无法再上传");return false}}}}k=c(a(this.ops,false));this.ops._row++;if(n){k.hover(function(){c(this).addClass("cfi-i-hover")},function(){c(this).removeClass("cfi-i-hover")}).on("click",function(f){c("#"+m.id).find(".cfi-i-cur").removeClass("cfi-i-cur");c(this).addClass("cfi-i-cur")})}k.attr("data-fid",l.fid);k.attr("data-fn",l.fileName);l.fileSize&&k.attr("data-fs",l.fileSize);l.fileType&&k.attr("data-ft",l.fileType);var g=(l.fileSize)?("("+l.fileSize+")"):"";var r="&nbsp;";var i=l.fileName.split(".");if(i.length>1){r=i[i.length-1];i=null}k.attr("title",l.fileName+g);l.fileName="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"+l.fileName+"&nbsp;&nbsp;"+g;k.html(l.fileName);var q="oth";if(l.fileType){var h=l.fileType;if(h.indexOf("image/")>-1){q="image"}else{if(h.indexOf("application/")>-1){if(h.indexOf("word")>-1){q="word"}else{if(h.indexOf("excel")>-1){q="excel"}}}}}if(q=="oth"){k.append('<div class="ficon-ext">'+r.toLowerCase()+"</div>")}k.addClass("ficon-"+q);p.append(k);this._rz();this._setv()};b.prototype._rz=function(){var g=c("#"+this.id);if(this.ops.maxHeight){var k=g.find(".cfi-file-div");var h=0;for(var i=0;i<k.length;i++){h+=c(k.get(i)).height()}if(h<this.ops.maxHeight){g.css({height:"auto",overflow:"visible"})}else{g.css({height:this.ops.maxHeight+"px",overflow:"hidden","overflow-x":"hidden","overflow-y":"auto"})}}else{if(this.ops.height){g.css({height:this.ops.height+"px",overflow:"hidden","overflow-x":"hidden","overflow-y":"auto"})}}};b.prototype.setVal=function(k){if(!k||k.length<1){c("#"+this.id).empty();this._setv();return}var h=k.split("*");for(var g=0;g<h.length;g++){if(h[g]&&h[g].length>0){var f=h[g].split("|");var l={fid:f[0]};if(f.length>1){l.fileName=f[1];if(f.length>2){l.fileSize=f[2];if(f.length>3){l.fileType=f[3]}}}this._addf(l);if(!this.ops.mutliFile){break}}}this._setv()};function e(f,h){var k=false;var g=c("#"+f);var i=g.find(".cfi-file-div");if(i.length<1){if(h){alert("未选择文件，无法下载")}return false}else{if(i.length==1){k=i.attr("data-fid")}else{var i=g.find(".cfi-i-cur");if(i.length<1){if(h){alert("请先选择下载的文件")}return false}k=i.attr("data-fid")}}return k}b.prototype.getFileId=function(h){var f=c("#"+this.id);var g=f.find(".cfi-file-div");if(g.length<1){return false}if(h){return e(this.id,false)}return g.attr("data-fid")};b.prototype.getFileInfo=function(h){var f=c("#"+this.id);var g=f.find('.cfi-file-div[data-fid="'+h+'"]');if(g.length<1){return false}return{fileName:g.attr("data-fn"),fileSize:g.attr("data-fs"),fileType:g.attr("data-ft")}};b.prototype.remove=function(p){var o=c("#"+this.id);if(p==undefined){p=false}var h=o.find(".cfi-file-div");if(h.length<1){return false}else{if(h.length>1){h=o.find(".cfi-i-cur");if(h.length<1){alert("请选择需要删除的文件")}}}var l=this;var q=false;var m=this.ops.fileParams;if(m&&m.deleteAction){q=m.deleteAction}if(q){var i=h.attr("data-fid");if(i&&i.length>0){var k=this.getFileInfo(i);var f={fid:i};for(var g in m){if(typeof m[g]!="function"){f[g]=m[g]}}c.callAjax({url:q,data:f,complete:function(){h.remove();if(!p){l._rz();l._setv()}if(c.isFunction(m.deleteSuccess)){m.deleteSuccess(f)}}})}}else{h.remove();if(!p){this._rz();this._setv()}}};b.prototype.download=function(){var h=e(this.id,true);if(h){var g=false;var f=this.ops.fileParams;if(f&&f.downloadAction){g=f.downloadAction}c.callFile(g,c.extend({fid:h},f))}};var d=0;c.AjaxFileItem=function(h){if(arguments.length==1&&typeof arguments[0]=="string"){return c("#"+arguments[0]).data("$fi")}if(!h.inputid){alert("未设置AjaxFileItem的input");return false}var g="hfi"+(d++);var i=c.extend({id:g,mutliFile:false,buttons:[]},h);c("#"+h.inputid).after('<div class="cfi-div" id="'+i.id+'"></div>');var f=new b(i);f._init(i.id);c("#"+i.id).data("$fi",f);return f}})(jQuery);(function(l,g){var m=Object.prototype.toString,d={"undefined":"undefined",number:"number",string:"string","boolean":"boolean","[object Function]":"function","[object Array]":"array","[object RegExp]":"regexp","[object Date]":"date","[object Error]":"error"};var i="([-./])",c="\\d{4}",k=i+"(?:0?[1-9]|1[0-2])",n="\\1(?:0?[1-9]|[1-2][0-9]|3[0-1])",p=" (?:[01]?[0-9]|2[0-3])",x=":[0-5]?[0-9]",D=":[0-5]?[0-9](?:\\.\\d{1,3})?",A="yyyy",s=i+"mm?",w="\\1dd?",F=" hh?",v=":m?i",q=":ss?(?:\\.x(xx)?)?",C="\\D",e="^"+c+"(?:"+k+"(?:"+n+"(?:"+p+"(?:"+x+"(?:"+D+")?)?)?)?)?$",u="^"+A+"(?:"+s+"(?:"+w+"(?:"+F+"(?:"+v+"(?:"+q+")?)?)?)?)?$",b=new RegExp(e),y=new RegExp(u,"i"),o=new RegExp(C),a="yyyy|mm|m|dd|d|hh|h|in|i|ss|s|xxx|x".split("|"),r=new RegExp("^[mdhisx]$","i"),t=new RegExp("[a-z0-9]","i"),f={y:"(\\d{4})",m:"(\\d{1,2})",d:"(\\d{1,2})",h:"(\\d{1,2})",i:"(\\d{1,2})",s:"(\\d{1,2})",x:"(\\d{1,3})"},B={yyyy:{tokenReg:new RegExp("yyyy","ig"),arrayIndex:0,dateGetMethodName:"getFullYear"},mm:{tokenReg:new RegExp("mm","ig"),arrayIndex:1,dateGetMethodName:"getMonth"},m:{tokenReg:new RegExp("m","ig"),arrayIndex:1,dateGetMethodName:"getMonth"},dd:{tokenReg:new RegExp("dd","ig"),arrayIndex:2,dateGetMethodName:"getDate"},d:{tokenReg:new RegExp("d","ig"),arrayIndex:2,dateGetMethodName:"getDate"},hh:{tokenReg:new RegExp("hh","ig"),arrayIndex:3,dateGetMethodName:"getHours"},h:{tokenReg:new RegExp("h","ig"),arrayIndex:3,dateGetMethodName:"getHours"},"in":{tokenReg:new RegExp("in","ig"),arrayIndex:4,dateGetMethodName:"getMinutes"},i:{tokenReg:new RegExp("i","ig"),arrayIndex:4,dateGetMethodName:"getMinutes"},ss:{tokenReg:new RegExp("ss","ig"),arrayIndex:5,dateGetMethodName:"getSeconds"},s:{tokenReg:new RegExp("s","ig"),arrayIndex:5,dateGetMethodName:"getSeconds"},xxx:{tokenReg:new RegExp("xxx","ig"),arrayIndex:6,dateGetMethodName:"getMilliseconds"},x:{tokenReg:new RegExp("x","ig"),arrayIndex:6,dateGetMethodName:"getMilliseconds"}},z="(\\d)(?=(?:{0})+(?!\\d))",h=new RegExp("^([^#0.\\s])?(?:(#*|0*)\\.|)(#+|0+)([^#0.\\s])?$"),E=new RegExp("^[-+]?(?:(\\d*)\\.|)(\\d+)$");g.extend({Lang:{type:function(G){return d[typeof G]||d[m.call(G)]||(G?"object":"null")},isUndefined:function(G){return typeof G==="undefined"},isString:function(G){return typeof G==="string"},isNumber:function(G){return typeof G==="number"&&isFinite(G)},isBoolean:function(G){return typeof G==="boolean"},isNull:function(G){return G===null},isFunction:function(G){return this.type(G)==="function"},isArray:function(G){return this.type(G)==="array"},isDate:function(G){return this.type(G)==="date"&&G.toString()!=="Invalid Date"&&!isNaN(G)},isObject:function(I,H){var G=typeof I;return(I&&(G==="object"||(!H&&(G==="function"||this.isFunction(I)))))||false},throttle:function(I,H,G){H=this.isNumber(H)?H:150;if(H===-1){return function(){I.call(G,arguments)}}var J=g.now();return function(){var K=g.now();if(K-J>H){I.call(G,arguments)}}}},DateUtil:{toDate:function(Y,T,Q){var H={},V,W,P,M,G=B,J,K=r,U,R=[null,null,null,null,null,null,null],O,X,S,I,N;if(arguments.length===1){T=g.GLOBALCONFIG.dateformat;Q=false}else{if(arguments.length===2){Q=false}}Y=g.trim(String(Y));if(Y===""){return null}T=g.trim(String(T).toLowerCase());T===""&&(T="yyyy-mm-dd hh:mi:ss");T=T.replace(/mi/ig,"in");for(var V=0,W=a.length;V<W;V+=1){P=a[V];J=G[P]["tokenReg"];U=null;if(K.test(P)&&H.hasOwnProperty(P)){if(J.exec(T.replace(H[P]["token"],""))){if(!Q){alert("格式串不能重复")}return null}}else{if((U=J.exec(T))&&J.exec(T)){if(!Q){alert("格式串不能重复")}return null}}if(U){H[P.charAt(0)]={index:U.index,token:P}}}X=T;g.each(H,function(Z,aa){X=X.replace(aa.token,"")});if(t.test(X)){if(!Q){alert("无效的格式串")}return null}S=T.replace(/[^0-9a-z]/ig,function(Z){return"\\"+Z});S=S.replace(/yyyy|mm?|dd?|hh?|in?|ss?|x(?:xx)?/ig,function(Z){return f[Z.charAt(0)]});if(!(U=new RegExp("^"+S+"$","i").exec(Y))){if(!Q){alert("传入的值与格式串不匹配")}return null}O=[];g.each(H,function(Z,aa){O.push(aa)});O.sort(function(aa,Z){return aa.index-Z.index});for(V=1,W=U.length;V<W;V+=1){R[G[O[V-1]["token"]]["arrayIndex"]]=parseInt(U[V],10)}I=new Date();R[0]===null&&(R[0]=I.getFullYear());R[1]===null&&(R[1]=1);R[2]===null&&(R[2]=1);R[3]===null&&(R[3]=0);R[4]===null&&(R[4]=0);R[5]===null&&(R[5]=0);R[6]===null&&(R[6]=0);if(R[1]<1||R[1]>12){if(!Q){alert("无效的月")}return null}if(R[2]===0||(N=this.daysInMonth(new Date(R[0],R[1]-1)))===0||N<R[2]){if(!Q){alert("无效的日")}return null}if(R[3]<0||R[3]>23){if(!Q){alert("无效的时")}return null}if(R[4]<0||R[4]>59){if(!Q){alert("无效的分")}return null}if(R[5]<0||R[5]>59){if(!Q){alert("无效的秒")}return null}I=new Date(R[0],R[1]-1,R[2],R[3],R[4],R[5],R[6]);return I},verifyFormat:function(G){return y.test(g.trim(String(G)))},parse:function(N){var J=null,I,P,R,G,M,K,H,O,S,Q;if(this.isValidDate(N)){return new Date(N.getTime())}else{if(g.Lang.isString(N)){N=g.trim(N);if(b.test(N)){I=N.split(o);P=I.length;R=parseInt(I[0],10);G=P>1?parseInt(I[1],10):1;M=P>2?parseInt(I[2],10):1;K=P>3?parseInt(I[3],10):0;H=P>4?parseInt(I[4],10):0;O=P>5?parseInt(I[5],10):0;S=P>6?parseInt(I[6],10):0;J=new Date(R,G-1);if((Q=this.daysInMonth(J))>0&&Q>=M){J=new Date(R,G-1,M,K,H,O,S)}else{J=null}}}else{if(g.Lang.isNumber(N)){J=new Date(N)}}}!this.isValidDate(J)&&(J=null);return J},match:function(K,G){var H=this.parse(K),I,M,J,N;G=g.trim(String(G));if(H===null||!this.verifyFormat(G)){return null}M=new RegExp(i);I=this.format(H,G);J="";N="";M.test(K)&&(J=RegExp["$1"]);M.test(I)&&(N=RegExp["$1"]);if(J!==N){return null}I.split(o).length!==K.split(o).length&&(H=null);return H},isValidDate:function(G){return g.Lang.isDate(G)},areEqual:function(H,G){return(this.isValidDate(H)&&this.isValidDate(G)&&(H.getTime()===G.getTime()))},isGreater:function(H,G){return(this.isValidDate(H)&&this.isValidDate(G)&&(H.getTime()>G.getTime()))},isGreaterOrEqual:function(H,G){return(this.isValidDate(H)&&this.isValidDate(G)&&(H.getTime()>=G.getTime()))},isInRange:function(I,H,G){return(this.isGreaterOrEqual(I,H)&&this.isGreaterOrEqual(G,I))},addDays:function(H,G){return new Date(H.getTime()+86400000*G)},addMonths:function(J,G){var I=J.getFullYear(),K=J.getMonth()+G,H=new Date(J.getTime());I=Math.floor(I+K/12);K=(K%12+12)%12;H.setFullYear(I);H.setMonth(K);return H},addYears:function(J,I){var H=J.getFullYear()+I,G=new Date(J.getTime());G.setFullYear(H);return G},trunc:function(H,I){var G=null;if(!this.isValidDate(H)||!g.Lang.isString(I)){return G}I=I.toLowerCase();switch(I){case"y":G=new Date(H.getFullYear(),0);break;case"m":G=new Date(H.getFullYear(),H.getMonth());break;case"d":G=new Date(H.getFullYear(),H.getMonth(),H.getDate());break;case"h":G=new Date(H.getFullYear(),H.getMonth(),H.getDate(),H.getHours());break;case"mi":G=new Date(H.getFullYear(),H.getMonth(),H.getDate(),H.getHours(),H.getMinutes());break;case"s":G=new Date(H.getFullYear(),H.getMonth(),H.getDate(),H.getHours(),H.getMinutes(),H.getSeconds());break}return G},daysBetween:function(J,G){var I=this.trunc(J,"d"),H=this.trunc(G,"d");return(parseInt(Math.abs(I.getTime()-H.getTime())/86400000,10))},monthsBetween:function(O,G){var N=this.trunc(O,"m"),M=this.trunc(G,"m"),H=N.getFullYear(),I=N.getMonth(),J=M.getFullYear(),K=M.getMonth();return Math.abs((H-J)*12+I-K)},daysInMonth:function(I){if(!this.isValidDate(I)){return 0}var H=I.getMonth(),J=[31,28,31,30,31,30,31,31,30,31,30,31];if(H!=1){return J[H]}else{var G=I.getFullYear();if(G%400===0){return 29}else{if(G%100===0){return 28}else{if(G%4===0){return 29}else{return 28}}}}},format:function(K,I,G){G==null&&(G=g.GLOBALCONFIG.dateformat);var M,H=this.isValidDate(K)?K:this.toDate(K,G,true),J;M=g.trim(String(I));if(H===null){return""}J=g.StringHelper;M.indexOf("mi")>-1&&(M=M.replace("mi","in"));return M.replace(/yyyy|mm?|dd?|hh?|in?|ss?|x(?:xx)?/ig,function(N,O){N=N.toLowerCase();switch(N){case"yyyy":return H.getFullYear();case"mm":return J.lPad(H.getMonth()+1,2,"0");case"m":return H.getMonth()+1;case"dd":return J.lPad(H.getDate(),2,"0");case"d":return H.getDate();case"hh":return J.lPad(H.getHours(),2,"0");case"h":return H.getHours();case"in":return J.lPad(H.getMinutes(),2,"0");case"i":return H.getMinutes();case"ss":return J.lPad(H.getSeconds(),2,"0");case"s":return H.getSeconds();case"xxx":return J.lPad(H.getMilliseconds(),3,"0");case"x":return H.getMilliseconds()}})},getFullDateString:function(I,G){var H=this.isValidDate(I)?I:this.toDate(I,G,true);if(H===null){return""}return this.format(H,g.GLOBALCONFIG.dateformat||"yyyy-mm-dd hh:mi:ss")}},StringHelper:{isEmpty:function(G){return(G==null||/^\s*$/.test(G))},getLen:function(G){return G.replace(/[^\u0000-\u00ff]/g,"xx").length},val2label:function(I,H){for(var G=0;G<H.length;G+=1){if(H[G].label){if(I===H[G].val){return H[G].label}}}return I},format:function(){var H=g.Lang,K,I,J=arguments[0],G=arguments.length;if(G<=1||!H.isString(J)){return""}K=g.makeArray(arguments).slice(1);J=J.replace(/\{(\d+)\}/g,function(M,N){I=K[parseInt(N,10)];(H.isUndefined(I)||H.isNull(I))&&(I=M);return I});return J},trimLeft:function(I,H){var G=g.Lang;if(G.isString(I)&&G.isString(H)&&/^[\u0000-\u00ff]$/.test(H)){!/^[a-z0-9]$/i.test(H)&&(H="\\"+H);return I.replace(new RegExp("^"+H+"+"),"")}return I},trimRight:function(I,H){var G=g.Lang;if(G.isString(I)&&G.isString(H)&&/^[\u0000-\u00ff]$/.test(H)){!/^[a-z0-9]$/i.test(H)&&(H="\\"+H);return I.replace(new RegExp(H+"+$"),"")}return I},trim:function(H,G){return(H=this.trimLeft(H,G),this.trimRight(H,G))},lPad:function(I,G,H){return this._padHandler(I,G,H,function(J){return J+I})},rPad:function(I,G,H){return this._padHandler(I,G,H,function(J){return I+J})},_padHandler:function(O,M,G,R){var Q=g.Lang,T,K,I,J,P,S,H,N;Q.isUndefined(G)&&(G=" ");if(!Q.isString(O)&&!Q.isNumber(O)||!Q.isNumber(M)||!Q.isString(G)&&!Q.isNumber(G)){throw new Error("传入参数类型错误, 目标字符串只能为字符串或数字类型, 截取长度必须为数字, 填充参数必须为字符串或数字类型！")}O=String(O);G=String(G);if(O===""||G===""||M<=0){return""}K=O;I=M;T=this.getLen(O);if(M<=T){while(this.getLen(K=K.slice(0,I--))>M){}O=K}else{J=M-T;P="";S=0;H=G.length;while((N=this.getLen(P+=G.charAt(S++%H)))<J){}N>J&&(P=P.slice(0,P.length-1));O=R(P)}return O}},NumberHelper:{format:function(J,P,I){var M,K,R,S,N,Q,H,G,O=g.StringHelper;J=g.trim(String(J));if(!E.test(J)){return""}G="";J.charAt(0)==="-"&&(G="-");if(J.indexOf(".")>=0){M=RegExp["$1"]||"0";K=RegExp["$2"]}else{M=RegExp["$2"];K=""}if(!h.test(P)){return""}N=RegExp["$1"];Q=RegExp["$4"];if(P.indexOf(".")>=0){R=RegExp["$2"];S=RegExp["$3"]}else{R=RegExp["$3"];S=""}H=M;/^0+$/.test(R)&&M.length<R.length&&(H=O.lPad(M,R.length,"0"));if(g.isPlainObject(I)){H=H.replace(this._getSeperateReg(I.num),"$1"+I.sep)}if(/^0+$/.test(S)){K===""&&(K="0");H=H+"."+(K.length<S.length?O.rPad(K,S.length,"0"):K.slice(0,S.length))}else{if(K!==""&&/^#+$/.test(S)){H=H+"."+(K.length>S.length?K.slice(0,S.length):K)}}return N+G+H+Q},_getSeperateReg:function(H){var G=g.StringHelper;return new RegExp(G.format(z,G.rPad("\\d",H*2,"\\d")),"g")},ys2nx:function(H){var G=g.validate.chkNumber;if(!G(H,3,0,true)){return""}H=Math.abs(+H);return parseInt(H/12,10)+"."+g.StringHelper.lPad(H%12,2,"0")}},JSONer:{encode:function(G){return JSON.stringify(G)},decode:function(G){return JSON.parse(G)}}})})(window,jQuery);if(String.prototype.compareNoCase){}else{String.prototype.compareNoCase=function(c){var b=this.toLowerCase();var a=c.toLowerCase();if(b==a){return true}return false}}if(String.prototype.toDate){}else{String.prototype.toDate=function(){var g=0,f=0,m=0,e=0,h=0,n=0;var l="";if(this.indexOf(".")>-1){l="."}else{if(this.indexOf("-")>-1){l="-"}else{if(this.indexOf("/")>-1){l="/"}}}if(l.length<1){g=parseInt(this.substring(0,4),10);f=parseInt(this.substring(4,6),10);m=parseInt(this.substring(6,8),10);e=parseInt(this.substring(8,10),10);h=parseInt(this.substring(10,12),10);n=parseInt(this.substring(12,14),10)}else{var b=this.indexOf(l);if(b>0){g=parseInt(this.substring(0,b),10);var a=this.indexOf(l,b+1);if(a>0){f=parseInt(this.substring(b+1,a),10);var c=this.indexOf(" ",a+1);if(c>0){m=parseInt(this.substring(a+1,c,10));var k=this.indexOf(":",c+1);if(k>0){e=parseInt(this.substring(c+1,k),10);var i=this.indexOf(":",k+1);if(i>0){h=parseInt(this.substring(k+1,i),10);n=parseInt(this.substring(i+1,this.length),10)}else{h=parseInt(this.substring(k+1,this.length),10)}}else{e=parseInt(this.substring(c+1,this.length),10)}}else{m=parseInt(this.substring(a+1,this.length,10))}}else{f=parseInt(this.substring(a,this.length),10)}}}var d=new Date(g,f-1,m,e,h,n,0);if(d.getFullYear()!=g||d.getMonth()!=(f-1)||d.getDate()!=m||d.getHours()!=e||d.getMinutes()!=h||d.getSeconds()!=n){throw new TypeError('字符串"'+this+'"转换日期出错:无效的日期')}return d}}if(String.prototype.lengthb){}else{String.prototype.lengthb=function(){return this.replace(/[^\u0000-\u00ff]/g,"xx").length};if(String.prototype.LengthB){String.prototype.LengthB=String.prototype.lengthb}}if(String.prototype.format){}else{String.prototype.format=function(){var b,c,d=[];var a=arguments.length;for(b=0;b<a;b++){d.push(arguments[b])}c=this.replace(/\{(\d+)\}/g,function(e,f){var g=parseInt(f,10);if(g>=a){return""}return d[g]});return c};if(String.prototype.Format){String.prototype.Format=String.prototype.format}}if(String.prototype.fmtSql){}else{String.prototype.fmtSql=function(){var b,c,d=[];var a=arguments.length;for(b=0;b<a;b++){d.push(arguments[b].split("'").join("''"))}c=this.replace(/\{(\d+)\}/g,function(e,f){var g=parseInt(f,10);if(g>=a){return""}return d[g]});return c};if(String.prototype.FmtSql){String.prototype.FmtSql=String.prototype.fmtSql}}if(Date.prototype.format){}else{Date.prototype.format=function(a){var c={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};if(/(y+)/.test(a)){a=a.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))}for(var b in c){if(new RegExp("("+b+")").test(a)){a=a.replace(RegExp.$1,(RegExp.$1.length==1)?(c[b]):(("00"+c[b]).substr((""+c[b]).length)))}}return a}}if(Date.prototype.trunc){}else{Date.prototype.trunc=function(b){var a;b=b.toLowerCase();switch(b){case"yy":a=new Date(this.getFullYear(),0);break;case"mm":a=new Date(this.getFullYear(),this.getMonth());break;case"dd":a=new Date(this.getFullYear(),this.getMonth(),this.getDate());break;case"hh":a=new Date(this.getFullYear(),this.getMonth(),this.getDate(),this.getHours());break;case"mi":a=new Date(this.getFullYear(),this.getMonth(),this.getDate(),this.getHours(),this.getMinutes());break;case"ss":a=new Date(this.getFullYear(),this.getMonth(),this.getDate(),this.getHours(),this.getMinutes(),this.getSeconds());break}return a}}if(Date.prototype.toDefaultString){}else{Date.prototype.toDefaultString=function(){return this.format("yyyy-MM-dd hh:mm:ss")}}(function(f){function g(i){this.map={};e.call(this,i)}function e(k){var i=this;if(!f.isPlainObject(k)){return}f.each(k,function(l,m){i.bind(l,m)})}function h(i,k,l){if(!i||!f.isFunction(k)||f.StringHelper.isEmpty(f.trim(i=String(i)))){return}this.map[a.call(this,i)]={fn:k,data:l}}function c(i){if(!i||f.StringHelper.isEmpty(f.trim(i=String(i)))){return}delete this.map[a.call(this,i)]}function a(i){var k,l,m;i=i.toLowerCase();k=i.split(/\s+|[-+_]/);if(k.length===1){return g.aliases[i]||i}m=false;f.each(k,function(n,o){if(!/alt|ctrl|meta|shift/i.test(o)){m=true;k.splice(n,1);l=g.aliases[o]||o;k.sort();k.push(l);return false}});!m&&k.sort();return k.join("_")}function d(k){var i=f(k),l=this;if(!i.length){return}i.on("keydown",function(m){return b.call(l,m,i)})}function b(o,i){var l="",n,p,m,k;o.altKey&&(l+="alt_");o.ctrlKey&&(l+="ctrl_");o.metaKey&&(l+="meta_");o.shiftKey&&(l+="shift_");if(o.key){n=o.key}else{if(o.keyIdentifier&&o.keyIdentifier.substring(0,2)!=="U+"){n=o.keyIdentifier}else{n=g.keyCodeToKeyName[o.which]}}if(!n){return}if(l&&/alt|control|meta|shift/i.test(n)){p=l.substring(0,l.length-1)}else{p=l+n.toLowerCase()}k=this.map[p];if(!k){return}m=k.fn;m.call(i,k.data,o,p);return false}g.prototype={constructor:g,bind:h,unbind:c,install:d};g.aliases={escape:"esc","delete":"del","return":"enter",space:"spacebar",ins:"insert"};g.keyCodeToKeyName={8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Spacebar",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",45:"Insert",46:"Del",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"A",66:"B",67:"C",68:"D",69:"E",70:"F",71:"G",72:"H",73:"I",74:"J",75:"K",76:"L",77:"M",78:"N",79:"O",80:"P",81:"Q",82:"R",83:"S",84:"T",85:"U",86:"V",87:"W",88:"X",89:"Y",90:"Z",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"Multiply",107:"Add",109:"Subtract",110:"Decimal",111:"Divide",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",124:"F13",125:"F14",126:"F15",127:"F16",128:"F17",129:"F18",130:"F19",131:"F20",132:"F21",133:"F22",134:"F23",135:"F24",59:";",61:"=",186:";",187:"=",188:",",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"};f.KeyMap=g;f.DocumentKeyMap=new g();f.DocumentKeyMap.install(document)})(jQuery);(function(b){var g=b.Lang,t=b.StringHelper,f=b.DocumentKeyMap;DEFAULT_DEFINITIONS={btn_query:{label:"查询",key:"C",iconClass:"icon_find"},btn_reset:{label:"清屏",key:"Q",iconClass:"icon_application_delete"},btn_detail:{label:"查看明细",key:"",iconClass:"icon_application_form_magnify"},btn_save:{label:"确认",key:"S",iconClass:"icon_tick"},btn_quit:{label:"放弃",key:"Q",iconClass:"icon_cancel"},btn_print:{label:"打印",key:"P",iconClass:"icon_printer"},btn_cpu:{label:"计算",key:"C",iconClass:"icon_application_edit"},btn_add:{label:"增加",key:"A",iconClass:"icon_add"},btn_delete:{label:"删除",key:"D",iconClass:"icon_delete"},btn_modify:{label:"修改",key:"M",iconClass:"icon_cog_edit"}},INTERNAL_CONFIG={_prefix:"les_buttons",_uidx:0,_align:/left|center|right/i,_defaultAlign:"right",_wrapDiv:'<div id="{0}" class="{1}" style="text-align:{2}">{3}</div>',_kidx:0},Buttons=function(v,w){this._isButtons=true;this.uid=w.id||c();this.$ele=v;this.buttons=[];this._events={};this.ops=b.extend({align:INTERNAL_CONFIG._defaultAlign,buttons:[]},w)};function l(){var A=b(this),x=this,v=b(".cbtnt",A),w=A.attr("data-delay"),z,y;if(w==null||!w.length||w==="0"){return}this.disabled=true;q(this,false);w=parseInt(w,10);z=v.html();y=/\((\S)\)\s*$/i.test(z)?z.substring(0,z.lastIndexOf("(")):z;v.html(y+"("+w--+")");this.stid=setTimeout(function(){if(x.stid===null){return}if(w>0){b(".cbtnt",x).html(y+"("+w--+")");x.stid=setTimeout(arguments.callee,999)}else{x.disabled=false;q(x,true);b(".cbtnt",x).html(z);x.stid=null}},999)}function o(){var y=this.ops,w=INTERNAL_CONFIG,B=[],v=[],x,C,z=this,A;!w._align.test(C=y.align)&&(C=w._defaultAlign);y.align=C;v=e.call(this);b.each(v,function(D,E){if(/^\S$/i.test(E.key)){E.key=E.key.toLowerCase();A=E.key.toUpperCase();if(/.+\((\S)\)\s*$/i.test(E.label)){E.label=E.label.replace(/\(\S\)\s*$/i,"("+A+")")}else{E.label=E.label+"("+A+")"}E.key="ctrl+"+E.key}E.key&&f.bind(E.key,d,{id:E.id});B.push(k.call(z,E))});this._html=B.join("");if(y._type<1){this.renderTo()}}function r(v){var A=this.ops;this.wrapDiv=b(t.format(INTERNAL_CONFIG._wrapDiv,this.uid,A.btnCls,A.align,""));this.$self=this.wrapDiv;var y=b(this._html);this.buttons=b.makeArray(b("a",y));this.wrapDiv.append(y);if(v){this.$ele=v}this.$ele.append(this.wrapDiv);for(var x=0;x<A.buttons.length;x++){var w=A.buttons[x];if(w.act=="up"){b("#"+w.id+"_myfile").data("$conf",w)}}var z=this;b(window).on("resize",function(){z.wrapDiv.find(".cfi-file-udiv").each(function(B){var D=b(this);var C=D.parent();D.css({width:C.width(),height:C.height()})})});this.wrapDiv.on("click",".cbtna",function(H){var D=z._events.click;var I=b(this).attr("data-pid");var J=b(this).find(".cbtnar").attr("mid");if(J){var F=b("#"+J);var B=F.data("$m");if(b.isFunction(B.show)){F.removeAttr("grow");B.show(H.clientX,H.clientY);return false}}if(D){for(var E=0;E<D.btns.length;E++){var C=D.btns[E];if(C.id==I){if(this.disabled){return false}l.call(this);if(b.isFunction(C.fn)){var G=C.fn.call(this,C.data);if(G!=undefined&&!G){return false}}}}}}).find(".cfi-file-udiv").each(function(B){var D=b(this);var C=D.parent();D.css({width:C.width(),height:C.height()});var E=b("#"+C.attr("id")+"_myfile");if(E.length>0){E.on("change",function(I){var H=b(this);var G=H.data("$conf");var J={};var F=G.fileParams;if(F){if(b.isFunction(F)){J=F()}else{if(b.isPlainObject(F)){J=F}}}if(!J.uploadAction){if(b.GLOBALCONFIG&&b.GLOBALCONFIG.uploadFileAction){J.uploadAction=b.GLOBALCONFIG.uploadFileAction}else{J.uploadAction="fileservice/fileupload"}}b.ajaxFileUpload({url:J.uploadAction,fileElementId:H.attr("id"),data:J,success:function(K){var M=J.uploadSuccess;if(M){if(b.isFunction(M)){M(K)}}},error:function(K){alert(K)}})})}})}function m(x){var v=this.wrapDiv,w=n.call(this,x,this.buttons.length),y=b(k.call(this,w)).get(0);this.buttons.push(y);v.append(y)}function n(w,v){var x=w.id;if(g.isString(x)&&x.length&&DEFAULT_DEFINITIONS[x]){w=b.extend(DEFAULT_DEFINITIONS[x],w)}w=b.extend({id:this.uid+"_"+v,label:"button",iconClass:false,style:"",key:"",delay:0},w);if(g.isString(w.text)&&w.text.length){w.label=w.text}return w}function e(){var x=this.ops.buttons,w=[],v=this;b.each(x,function(z,A){var y=n.call(v,A,z);if(v.ops.btnCls=="tbar"){y.key=false}w.push(y)});return w}function k(w){var x=[];var v=w.style||"d";var y=this.ops;if(w.label=="&split"||w.label=="|"){x.push('<span class="cbtnl cbtnl-'+v+' cbtnsp">')}else{x.push('<span class="cbtnl cbtnl-'+v+'">')}x.push('<span class="cbtnr cbtnr-'+v+'">');x.push('<a href="javascript:void(0);" '+(y._type==2?"":'id="'+w.id+'" ')+'class="cbtna cbtna-'+v+'" ');if(w.tipMsg){x.push(' title="'+w.tipMsg+'"')}if(y._type!=2&&w.act=="up"){x.push(' style="position:relative;"')}x.push('data-style="'+v+'" data-pid="'+w.id+'" data-delay="'+w.delay+'" data-oriBtnText="'+w.label+'" data-icon="'+w.iconClass+'">');if(w.iconClass){if(w.iconClass.substr(0,5)!="icon_"){w.iconClass="icon_"+w.iconClass}x.push('<span class="cbtni cbtni-'+v+" "+w.iconClass+'">&nbsp;</span>')}if(w.label){if(w.label=="&split"){x.push('<span class="cbtnt cbtnsp-'+v+'">&nbsp;</span>')}else{x.push('<span class="cbtnt cbtnt-'+v+'">'+w.label+"</span>")}}if(y._type!=2&&w.act=="up"){x.push('<div class="cfi-file-udiv" style="width:1px;"><input id="'+w.id+'_myfile" type="file" name="myfile" class="cfi-file-uinput"/></div>')}if(w.act&&w.act.mid){x.push('<span class="cbtnar" mid="'+w.act.mid+'">&nbsp;</span>')}x.push("</a></span></span>");return x.join("")}function c(){return INTERNAL_CONFIG._prefix+"_"+INTERNAL_CONFIG._uidx++}function d(w,v,y){var x=b("#"+w.id);if(!x.length||x[0].disabled){return}b("#"+w.id).trigger("click")}function q(A,y){var C=b(A);var x=C.parent();var w=x.parent();var z=b(".cbtni",C);var v=b(".cbtnt",C);var B=C.attr("data-icon");var D=C.attr("data-style");if(y){w.removeClass("cbtn-disable").addClass("cbtnl-"+D).removeClass("cbtn-disable-"+D);x.addClass("cbtnr-"+D);C.removeAttr("disabled").addClass("cbtna-"+D);z.removeClass(B+"_disable");z.addClass(B);v.addClass("cbtnt-"+D)}else{w.removeClass("cbtnl-"+D).addClass("cbtn-disable").addClass("cbtn-disable-"+D);x.removeClass("cbtnr-"+D);C.attr("disabled","disabled").removeClass("cbtna-"+D);z.removeClass(B);z.addClass(B+"_disable");v.removeClass("cbtnt-"+D)}}function i(z){var w,y;if(z==null){for(var x=0,v=this.buttons.length;x<v;x+=1){w=this.buttons[x];y=b(w);if(w){w.disabled=false;q(w,true);if(w.stid){window.clearTimeout(w.stid);w.stid=null;y.find(".cbtnt").html(y.attr("data-oriBtnText"))}}}return}z=b.trim(String(z));!/^#.*/i.test(z)&&(z="#"+z);w=b(z)[0];y=b(w);if(w){w.disabled=false;q(w,true);if(w.stid){window.clearTimeout(w.stid);w.stid=null;y.find(".cbtnt").html(y.attr("data-oriBtnText"))}}}function a(z){var w,y;if(z==null){for(var x=0,v=this.buttons.length;x<v;x+=1){w=this.buttons[x];y=b(w);if(w){w.disabled=true;q(w,false);if(w.stid){window.clearTimeout(w.stid);w.stid=null;y.find(".cbtnt").html(y.attr("data-oriBtnText"))}}}return}z=b.trim(String(z));!/^#.*/i.test(z)&&(z="#"+z);w=b(z)[0];y=b(w);if(w){w.disabled=true;q(w,false);if(w.stid){window.clearTimeout(w.stid);w.stid=null;y.find(".cbtnt").html(y.attr("data-oriBtnText"))}}}function u(){return t.format(INTERNAL_CONFIG._wrapDiv,this.uid,this.ops.btnCls,this.ops.align,this._html)}function s(A,v,z,y){var w,x=this._events;if(!A||!v){return}if(b.isFunction(v)){y=v;v="click";z=undefined}else{if(b.isFunction(z)){y=z;z=undefined}}/^#.*/i.test(A)&&(A=A.substr(1));w={id:A,data:z,fn:y};if(x[v]){x[v].btns.push(w)}else{x[v]={btns:[]};x[v].btns.push(w)}}function p(x){if(x==null||x==undefined||x.length<1){var w=this.ops.buttons;b("#"+this.uid).show();for(var v=0;v<w.length;v++){b("#"+w[v].id).parent().parent().show()}}else{!/^#.*/i.test(x)&&(x="#"+x);b(x).parent().parent().show();b("#"+this.uid).show()}}function h(y){var x=b("#"+this.uid);if(y==null||y==undefined||y.length<1){var w=this.ops.buttons;for(var v=0;v<w.length;v++){b("#"+w[v].id).parent().parent().hide()}x.hide()}else{!/^#.*/i.test(y)&&(y="#"+y);b(y).parent().parent().hide();if(x.find(".cbtnl:visible").length<1){x.hide()}}}Buttons.prototype={constructor:Buttons,init:o,renderTo:r,addButton:m,enable:i,disable:a,getHtml:u,bind:s,delay:l,show:p,hide:h};b.Buttons=function(A,y,x,w){var z=A?b(A):false,v;y.btnCls=x||"buttons";y._type=w||0;if(y._type<1){if(z.length<1){throw new Error("页面上没有对应id的元素存在, 请检查")}}if(arguments.length==1&&g.isString(A)){if(A.charAt(0)=="#"){return b(A).data("$btns")}return b("#"+A).data("$btns")}v=new Buttons(z,y);v.init();if(v.ops._type<1){v.wrapDiv.data("$btns",v)}return v};b.ToolBar=function(w,v){if(g.isString(w)){if(w===""){v.align=v.align||"center";return b.Buttons(false,v,"tbar",2)}}else{if(b.isPlainObject(w)){return b.Buttons(false,v,"tbar",1)}}return b.Buttons(w,v,"tbar",0)}})(jQuery);(function(f){var b=f.Lang,d=f.StringHelper,c=f.DateUtil,e=(f.browser.msie&&f.browser.version>=6&&document.compatMode==="BackCompat");var g=10;var a=function(h,i){this.$elem=f(h);this.ops=f.extend({showMode:"P"},i);this._date=null;this.iid="hc"+g;g+=1;this._year=0;this._month=-1;this._mode="D";this.ie6=false;if(navigator){if(navigator.appName=="Microsoft Internet Explorer"){if(navigator.appVersion.indexOf("MSIE 6.0")!=-1){this.ie6=true}}}};a.prototype._init=function(){var i=[];i.push('<table class="hcal" id="'+this.iid+'"><thead><tr class="ym"><th colspan="7"><span><a class="py" href="#">&lt;</a><select class="syy"></select><a class="tyear" href="#"></a><a class="ny" href="#">&gt;</a></span><input/><span><a class="pm" href="#">&lt;</a><a class="tmon" href="#"></a><select class="smm"><option value="0">01</option><option value="1">02</option><option value="2">03</option><option value="3">04</option><option value="4">05</option><option value="5">06</option><option value="6">07</option><option value="7">08</option><option value="8">09</option><option value="9">10</option><option value="10">11</option><option value="11">12</option></select><a class="nm" href="#">&gt;</a></span></th></tr>');i.push('<tr class="wk"><th>日</th><th>一</th><th>二</th><th>三</th><th>四</th><th>五</th><th>六</th></tr></thead>');i.push('<tbody><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td colspan="2" class="tday">今日</td></tr></tbody>');i.push("<tfoot>");i.push('<tr class="btn"><td colspan="7"><span class="stime">时间:<input class="hh"/>:<input class="mi"/>:<input class="ss"/></span><a class="bok" href="#">确定</a>&nbsp;&nbsp;<a class="bcl" href="#">取消</a></td></tr>');i.push("</tfoot></table>");this.$elem.append(i.join(""));this.$hc=f("#"+this.iid).click(function(k){return false});if(this.ops.showMode=="P"){this.$hc.css("position","absolute").css("z-index","9999");if(this.ie6){if(f("#bgf_"+this.iid).length<1){this.$hc.after('<iframe id="bgf_'+this.iid+'" style="position:absolute;width:1px;height:1px;z-index:9998;border:0 none;filter:alpha(opacity=50)"></iframe>')}}}var h=this;f("tbody td",this.$hc).click(function(){var n=f(this);var k=parseInt(f(this).html());var m=null;var l=n.hasClass("ncm");if(n.hasClass("tday")){h.setDate(new Date());if(h._mode=="D"){h._bok()}return false}if(l){if(k<20){if(h._month==11){m=new Date(h._year+1,0,k)}else{m=new Date(h._year,h._month+1,k)}}else{if(h._month==0){m=new Date(h._year-1,0,k)}else{m=new Date(h._year,h._month-1,k)}}}else{m=new Date(h._year,h._month,k)}h.setDate(m);if(!l&&h._mode=="D"){h._bok()}}).hover(function(){f(this).addClass("hov")},function(){f(this).removeClass("hov")});f(".bok",this.$hc).click(function(){h._bok();return false});f(".bcl",this.$hc).click(function(){h.hide(true);return false});f(".tyear",this.$hc).click(function(){f(this).hide();f(".syy",this.$hc).show().focus();return false});f(".tmon",this.$hc).click(function(){f(this).hide();f(".smm",this.$hc).show().focus();return false});f(".syy",this.$hc).change(function(){var k=new Date(f(this).val(),f(".smm",h.$hc).val(),1);h.setDate(k);f(".ym input",this.$hc).focus()});f(".smm",this.$hc).change(function(){var k=new Date(f(".syy",h.$hc).val(),f(this).val(),1);h.setDate(k);f(".ym input",this.$hc).focus()});f(".py",this.$hc).click(function(){h.setDate(new Date(h._year-1,h._month,1));return false});f(".ny",this.$hc).click(function(){h.setDate(new Date(h._year+1,h._month,1));return false});f(".pm",this.$hc).click(function(){h.setDate(new Date(h._year,h._month-1,1));return false});f(".nm",this.$hc).click(function(){h.setDate(new Date(h._year,h._month+1,1));return false});f(".ym input",this.$hc).bind("keydown",this._kh)};a.prototype._setM=function(p){var h=p||new Date();var k=f(".syy",this.$hc);var n=this.ops.min||new Date(1901,0,1);var o=this.ops.max||new Date(2049,0,1);var m="";for(var l=n.getFullYear();l<=o.getFullYear();l+=1){m+="<option";if(h.getFullYear()==l){m+=" selected"}m+=' value="'+l+'">'+l+"</option>"}k.empty().append(m)};a.prototype._bok=function(){var p=this._date;this.hide();if(this.$input){if(this._mode==="T"){var i=this.$hc,l=f(".hh",i),n=l.val(),h=f(".mi",i),o=h.val(),k=f(".ss",i),m=k.val();/^[0-1]?[0-9]|2[0-3]$/.test(n)&&p.setHours(parseInt(n,10));/^[0-5]?[0-9]$/.test(o)&&p.setMinutes(parseInt(o,10));/^[0-5]?[0-9]$/.test(m)&&p.setSeconds(parseInt(m,10))}this.$input.val(c.format(p,this.format)).change()}if(b.isFunction(this.onOk)){this.onOk(this._date)}this.$input=false};a.prototype._osh=function(i){var h=f.gCalendar();if(h.$input){if(i.target==h.$input.get(0)){return}}h.hide(true)};a.prototype._kh=function(i){var h=f.gCalendar();switch(i.keyCode){case 9:case 27:h.hide(true);break;case 13:h._bok();break;case 38:if(i.shiftKey||h._mode=="M"){h.moveMonth(-1)}else{h.moveDay(-7)}break;case 40:if(i.shiftKey||h._mode=="M"){h.moveMonth(1)}else{h.moveDay(7)}break;case 37:if(i.shiftKey||h._mode=="M"){h.moveMonth(-12)}else{h.moveDay(-1)}break;case 39:if(i.shiftKey||h._mode=="M"){h.moveMonth(12)}else{h.moveDay(1)}break;case 89:if(i.ctrlKey){f(".tyear",h.$hc).hide();f(".syy",h.$hc).show().focus()}break;case 77:if(i.ctrlKey){f(".tmon",h.$hc).hide();f(".smm",h.$hc).show().focus()}break}return false};a.prototype.moveDay=function(h){this.setDate(new Date(this._year,this._month,this._date.getDate()+h))};a.prototype.moveMonth=function(h){this.setDate(new Date(this._year,this._month+h,1))};a.prototype.hide=function(h){f(document.body).unbind("click",this._osh);f(".syy",this.$hc).hide();f(".smm",this.$hc).hide();this.$hc.hide();if(this.ie6){f("#bgf_"+this.iid).hide()}if(h){if(b.isFunction(this.onCancel)){this.onCancel()}this.$input=false}};a.prototype._gm=function(){var h=f.trim(String(this.format).toLowerCase());h.replace("mi","in");if(/[hisx]/i.test(h)){return"T"}else{if(h.indexOf("d")>-1){return"D"}else{if(h.indexOf("m")>-1){return"M"}}}return"D"};a.prototype.show=function(l,k){this.hide();this._mode=k||this._gm();this._setM(l);this.setDate(l);f(".tyear",this.$hc).show();f(".tmon",this.$hc).show();if(this._mode=="D"){f(".btn",this.$hc).hide();f(".wk",this.$hc).show();f("tbody",this.$hc).show()}else{if(this._mode=="M"){f(".btn",this.$hc).show();f(".wk",this.$hc).hide();f("tbody",this.$hc).hide();f(".stime",this.$hc).hide()}else{if(this._mode=="T"){f(".hh",this.$hc).val("");f(".mi",this.$hc).val("");f(".ss",this.$hc).val("");f(".btn",this.$hc).show();f(".wk",this.$hc).show();f("tbody",this.$hc).show();f(".stime",this.$hc).show()}}}if(this.ops.showMode=="P"){if(this.$input){if(!e){var m=this.$input.offset();m.top+=this.$input.outerHeight();this.$hc.css({top:(m.top+"px"),left:(m.left+"px")});if(this.ie6){f("#bgf_"+this.iid).css({top:(m.top+"px"),left:(m.left+"px"),width:this.$hc.width(),height:this.$hc.height()}).show()}}else{var h=this.$input.outerHeight();this.$hc.css({top:(this.$input[0].getBoundingClientRect().top+document.body.scrollTop+h+"px"),left:(this.$input[0].getBoundingClientRect().left+document.body.scrollLeft+"px")});if(this.ie6){f("#bgf_"+this.iid).css({top:(this.$input[0].getBoundingClientRect().top+document.body.scrollTop+h+"px"),left:(this.$input[0].getBoundingClientRect().left+document.body.scrollLeft+"px"),width:this.$hc.width(),height:this.$hc.height()}).show()}}}var i=f(document.body).bind("click",this._osh)}this.$hc.show();this._top();f(".ym input",this.$hc).focus()};a.prototype._top=function(){if(this.ops.showMode=="P"&&this.$input){var n=e?this.$hc[0].getBoundingClientRect().top+document.body.scrollTop:this.$hc.offset().top;var k=this.$hc.outerHeight();if(n+k>(f.getViewportSize(window).h+f.getScrollOffsets(window).y)){var m=e?this.$input[0].getBoundingClientRect().top+document.body.scrollTop:this.$input.offset().top;this.$hc.css("top",(m-k)+"px");if(this.ie6){f("#bgf_"+this.iid).css({top:(m-k)+"px"}).show()}}var h=e?this.$hc[0].getBoundingClientRect().left+document.body.scrollLeft:this.$hc.offset().left;var l=this.$hc.outerWidth();if(h+l>(f.getViewportSize(window).w+f.getScrollOffsets(window).x)){var i=e?this.$input[0].getBoundingClientRect().left+document.body.scrollLeft:this.$input.offset().left;this.$hc.css("left",i-l+((f.getViewportSize(window).w+f.getScrollOffsets(window).x)-i)+"px");if(this.ie6){f("#bgf_"+this.iid).css({top:i-l+((f.getViewportSize(window).w+f.getScrollOffsets(window).x)-i)+"px"}).show()}}}};a.prototype.setDate=function(k){var h=c.isValidDate(k)?k:new Date();var i=(new Date(h.getFullYear(),h.getMonth(),1)).getDay();if(!(this._year==h.getFullYear()&&this._month==h.getMonth())){f("tbody td",this.$hc).each(function(l){var m=f(this);if(m.hasClass("tday")){return}var n=new Date(h.getFullYear(),h.getMonth(),1-i+l);m.html(""+n.getDate()).removeClass("ncm").removeClass("curd");if(n.getMonth()==h.getMonth()){if(h.getDate()==n.getDate()){m.addClass("curd")}}else{m.addClass("ncm")}})}else{if(h!=this._date){f(".curd",this.$hc).removeClass("curd");f("tbody td",this.$hc).eq(i+h.getDate()-1).addClass("curd")}}this._date=h;this._year=h.getFullYear();this._month=h.getMonth();f(".tyear",this.$hc).html(this._year+"年").show();f(".tmon",this.$hc).html((this._month<9?"0":"")+(this._month+1)+"月").show();f(".syy",this.$hc).val(this._year).hide();f(".smm",this.$hc).val(this._month).hide()};f.Calendar=function(k,l){var i=f(k);var h=i.data("$hc$");if(h){return h}h=new a(k,l);h._init();i.data("$hc$",h);return h};f.gCalendar=function(){var h=f("#gcal1028");if(h.length>0){return h.data("$hc")}h=new a(document.body,{});h.iid="gcal1028";h._init();f("#gcal1028").data("$hc",h);return h}})(jQuery);(function(E){var l=E.Lang,t=E.StringHelper,T=E.DateUtil;var a=E.extend({bdColor:"#d9d9d9",bgColor:"#f1f1f3",labelBgColor:"#f1f1f3",itemBgColor:"#fff"},E.GLOBALCONFIG.formCss);var M=/^[-+]?(?:\d*\.|)(\d+)$/,Q=/^[-+]?(\d+)$/,H=/^[_a-zA-Z$]{1}[\w$]*$/i,s="tbody tr:eq({0}) td:eq({1})",f="tbody td:last",c=0,m='<img id="{0}" src="{1}" alt="{4}" data-type="img" data-src="{5}" onerror="imgErrorHandler({self: this})" style="margin:0;padding:0;border:0 none;width:{2}px;height:{3}px;border-top:1px solid #aca899;border-left:1px solid #aca899;border-bottom:1px solid #fff;border-right:1px solid #fff;" />',O=/(?:jpg|jpeg|gif|png|bmp)$/i,B='<div id="{0}" class="expand_shrink_div{1}" title="{2}"></div>',k={on:{"class":" shrink",title:"收缩"},off:{"class":" expand",title:"展开"}},u={text:"readonly",password:"readonly",textarea:"readonly",checkbox:"disabled",radio:"disabled",select:"disabled"},P={text:"readonly",password:"readonly",textarea:"readonly",checkbox:"disabled",radio:"disabled",list:"disabled",date:"readonly",number:"readonly"},A={enable:"auto",disable:"disabled"},S=/^input|textarea|select$/i,G=/^text|password|checkbox|radio|submit|reset|file|hidden|image|button$/i;function w(W){return l.isString(W)&&H.test(W)}function N(W){return O.test(W)}function I(W){if(!N(W)){return E.GLOBALCONFIG.ctxpath+"/"+E.GLOBALCONFIG.outputImgAction+"?fid="+W}return W}function C(){return this.fid+"_slide_switch"}var p=10;var i=function(ad){var af=E(this),ag=af.attr("id"),Y=(ag.split("_"))[0],Z=E("#"+Y),ah=false,W=false,ai=af.attr("name"),aa,X,ae,ac;if(Z.length>0){aa=ad.data.self;if(aa===null){return}X=aa.ops;ac=w(X.name)?(X.name+"."):"";ae=X.items;for(var ab=0;ab<ae.length;ab+=1){ah=ae[ab];if(ah.type==="hidden"||ah.type==="$null"||!w(ah.name)){continue}if(aa._gin(ab)===ai){W=true;break}}if(!W||!ah){return}aa._chki(ah,af)}};var g=function(X,W){this.ops=E.extend({itemCols:3,items:[],slide:{state:"on",disable:false}},W);this.$elem=E(X);this.fid=this.ops.id?this.ops.id:"hfv"+p;this.layoutTable=null;this.$self=null;this._slide_=null;this.buttons=[];p+=1};g.prototype._trStyle=function(W){if(this.ops.rowHeights){if(this.ops.rowHeights["r"+W]){var X=this.ops.rowHeights["r"+W];this.ops.rowHeights["r"+W]=false;return' style="height:'+X+';"'}}return""};g.prototype._init=function(){var az=this,aC=this.ops.items,ag=this.ops.itemCols,aB=this.ops.colWidths,al=0,aD=0,W=0,ae=[],aw=0,at=ag*2,aa=at,ac='<table id="'+this.fid+'" class="hfv" cellspacing="0" cellpadding="0"'+(aB?' style="table-layout:fixed;"':"")+">",au="",ao="",ap=false,aA=false,ai="",ah="",aF=0,Z=0,av,ay,Y,ak,aj,ab,ad,X,af;if(aB){au+='<tr class="hfv-htr-w">';for(var ar=0;ar<at;ar++){au+='<th class="hfv-htd-w"';if(aB["c"+ar]){au+=' style="width:'+aB["c"+ar]+'px;"'}au+=">&nbsp;</th>"}au+="</tr>"}if(this.ops.title){Y="";if(E.isPlainObject(this.ops.slide)&&!this.ops.slide.disable){!/^(on|off)$/i.test(aj=this.ops.slide.state)&&(aj="on");ak=k[aj];Y=t.format(B,C.call(this),ak["class"],ak.title);this._slide_={state:aj}}au+='<tr class="hfv-htr"><th class="hfv-htitle" colspan="'+at+'"'+(aB?' style="border-top:none;"':"")+'><div style="position:relative;"><div class="hfv-hticon" title="'+this.ops.title+'">'+this.ops.title+"</div>"+Y+"</div></th></tr>"}if(au.length>1){ac+='<thead class="hfv-h">'+au+"</thead>"}ab="<tbody>";this._slide_&&this._slide_.state==="off"&&(ab='<tbody style="display:none;">');ac+=ab;for(var aE=0;aE<aC.length;aE+=1){ap=aC[aE];ap.type=ap.type||"text";if(ap.type==="hidden"){ah+=this._ih(aE);continue}aD=1;W=1;aw=0;ao="";ai="";av="";ay="";if(!al){ac+="<tr"+this._trStyle(aF)+">";aF+=1;Z=0}ap.colSpan&&(aD=ap.colSpan);ap.rowSpan&&(W=ap.rowSpan);if(ap.hasOwnProperty("border")){!ap.border&&(av=ay=" hfv-noneborder")}else{ap.hasOwnProperty("labelBorder")&&!ap.labelBorder&&(av=" hfv-noneborder");ap.hasOwnProperty("itemBorder")&&!ap.itemBorder&&(ay=" hfv-noneborder")}if(ap.label){ao+='<td style="background-color:'+a.labelBgColor+';" class="hfv-label'+av+'"';aw=ap.labelSpan||1;if(ap.labelAlign){ai+="text-align:"+ap.labelAlign+";"}if(ai!=""){ao+=' style="'+ai+'"'}ao+=(aw>1?(' colspan="'+aw+'"'):"")+((ap.labelRowSpan||1)>1?((ae.push({rowIdx:aF+ap.labelRowSpan-2,cols:aw}),' rowspan="'+ap.labelRowSpan+'"')):"")+">"+this._lh(aE)+"</td>";ai="";Z++}ao+='<td class="hfv-item'+ay+'"';if(aD>1){ao+=' colspan="'+aD+'"'}if(W>1){ao+=' rowspan="'+W+'"';ae.push({rowIdx:aF+W-2,cols:aD})}if(ap.itemAlign){ai+="text-align:"+ap.itemAlign+";"}if(ai!=""){ao+=' style="'+ai+'"'}ao+=">";ao+=this._ih(aE)+"</td>";af=al;al+=aD+aw;Z++;if(af>aa||al>aa){aa>af&&(ac+="<td"+((aa-af)>1?' colspan="'+(aa-af)+'"':"")+' class="hfv-noneborder"></td>');ac+="</tr><tr"+this._trStyle(aF)+">"+ao;aF+=1;al=aD+aw;Z=0;aa=at-F(aF-1,ae)}else{if(aa==al){ac+=ao+"</tr>";al=0;aa=at-F(aF,ae)}else{ac+=ao}}}if(al){if(aa>al){ac+="<td"+((aa-al)>1?' colspan="'+(aa-al)+'"':"")+' class="hfv-noneborder"></td>'}ac+="</tr>"}ad='<tfoot style="display:none;"><tr><td style="height:6px;" colspan="'+at+'"></td></tr></tfoot>';this._slide_&&this._slide_.state==="off"&&(ad='<tfoot><tr><td style="height:6px;" colspan="'+at+'"></td></tr></tfoot>');ac+="</tbody>"+ad+"</table>"+ah;if(!this._static){E("#"+this.fid,this.$elem).remove();this.$elem.append(ac)}this._lgd();E(".cfindf9",this.$elem).click(function(aK){var aJ=E(this);var aH=aJ.width();var aI=E(this).position().left;if((aK.clientX-aI)>(aH-20)){az._callif(aJ,"findOpen")}});E(".cfindf9",this.$elem).keydown(function(aL){var aJ=aL.which,aK=E(this),aH;if((aJ===120||aJ===40)&&!aL.ctrlKey&&!aL.altKey&&!aL.shiftKey&&!aL.metaKey){az._callif(aK,"findOpen");return false}if(o(aK)){var aI=[13,37,39];aH=String.fromCharCode(aJ);if(/[ac]/i.test(aH)&&aL.ctrlKey){aL.stopPropagation();return}if(aL.altKey){return}if(E.inArray(aJ,aI)===-1){return false}aL.stopPropagation()}});for(var ax=0;ax<this.ops.items.length;ax+=1){ap=this.ops.items[ax];if(ap.type==="file"){continue}aA=this.getItem(ap.name);if(ap.required||ap.minLength||ap.maxLength||ap.type=="date"||ap.type=="number"||ap.maxValue!=undefined||ap.minValue!=undefined){aA.each(function(){E(this).bind("change",{self:az},i)})}if(aA.length==1&&ap.keyEnter){if(l.isFunction(ap.keyEnter)){aA.keypress(function(aI){if(aI.keyCode==13||aI.keyCode==9){var aH=az._callif(E(this),"keyEnter");if(!l.isUndefined(aH)){return aH}}})}}if(aA.length==1&&E.isFunction(ap.onBlur)){aA.on("blur.lesform",function(aH){return !!(az._callif(E(this),"onBlur"))})}if(ap.type=="number"){var aq="[\\d";if(ap.precision>0){aq+="."}if(!ap.plusNumber){aq+="-"}this._lmtin(aA,ap.limitInput||(aq+"]"),ap.maxLength,ap.precision)}else{if(ap.type=="date"){var am=E.GLOBALCONFIG.dateformat;if(ap.mask){am=ap.mask.toLowerCase()}aA.attr("dmask",am);this._lmtin(aA,ap.limitInput||"[\\d./-]",23);if(E.gCalendar){if(am!="yyyy"){var aG=function(aH){if(R.call(this,aH)){return}var aI=E.gCalendar();aI.$input=aH;aI.format=aH.attr("dmask");aI.onOk=function(){aH.focus()};aI.show(T.toDate(aH.val(),aI.format,true))};aA.keydown(function(aH){if(aH.keyCode==40||aH.keyCode==120){aG(E(this));return false}}).click(function(aK){var aJ=E(this);var aH=aJ.width();var aI=E(this).position().left;if((aK.clientX-aI)>(aH-20)){aG(E(this))}})}}}else{if(ap.limitInput){this._lmtin(aA,ap.limitInput,ap.maxLength)}else{if(ap.maxLength){this._lmtin(aA,"$null",ap.maxLength)}}}}}this.layoutTable=E("#"+this.fid);this.$self=this.layoutTable;U.call(this);q.call(this);E(".cfile",this.layoutTable).each(function(aJ){var aN=E(this);var aM=aN.attr("id");var aK=false;for(var aJ=0;aJ<aC.length;aJ++){if(aC[aJ].id==aM){aK=aC[aJ];break}}if(aK){var aL=E.AjaxFileItem(E.extend(aK,{inputid:aM,id:aM+"_fi"}));if(aL){aN.data("$afi",aL);for(var aH=0;aH<aK.buttons.length;aH++){var aI=aK.buttons[aH];if(aI.act=="down"){az.bind(aI.id,function(){var aO=aN.data("$afi");if(aO&&aO.download){aO.download()}})}else{if(aI.act=="delete"){az.bind(aI.id,function(){var aO=aN.data("$afi");if(aO&&aO.remove){aO.remove()}})}}}}}});function an(a0){var aM,aS,aO,aY=this,aL=E(this),aQ,a4,aP,aR,aN,a2,aI,aK,aX,aV,a5,aT,a3,aJ,aZ,aW,aH,aU,a1;aO=z(a0);if(aO===""){return}if(aL.attr("data-readonly")==="1"){return false}aQ=az.ops.items,aX=aQ.length,aV=0,a5=aL.attr("name");aT=az.ops.name;if(aT==null){aT=""}else{aT=E.trim(String(aT));aT!==""&&(aT+=".")}for(;aV<aX;aV+=1){if((aT+aQ[aV].name)===a5){a3=aQ[aV];break}}aJ=parseInt(a3.maxLength,10);aZ=parseInt(a3.precision,10);aW=!!a3.plusNumber;aH=a3.type;a4=aL.val();aM=E.DateUtil;aS=E.StringHelper;aN=r(aL);a2=aN.begin;aI=aN.end;aP=a4.substring(0,a2)+aO+a4.substring(aI);if(aH==="number"){if(E.isNumeric(aJ)&&!E.isNumeric(aZ)&&aJ>0){aK=aW?"[+]?\\d{1,"+aJ+"}":"[-+]?\\d{1,"+aJ+"}"}else{if(E.isNumeric(aZ)&&!E.isNumeric(aJ)&&aZ>0){aK=aW?"(?:[+]?0|)\\.\\d{1,"+aZ+"}":"(?:[-+]?0|)\\.\\d{1,"+aZ+"}"}else{if(E.isNumeric(aJ)&&aJ>0&&E.isNumeric(aZ)&&aZ>0&&aJ>aZ){aK=aW?"[+]?\\d{1,"+(aJ-aZ)+"}\\.\\d{1,"+aZ+"}":"[-+]?\\d{1,"+(aJ-aZ)+"}\\.\\d{1,"+aZ+"}"}else{aK=aW?"[+]?\\d{1,16}":"[-+]?\\d{1,16}"}}}aK=new RegExp("^"+aK+"$");return aK.test(aP)}else{if(aH==="date"){aU=a3.mask||E.GLOBALCONFIG.dateformat;a1=aM.toDate(aP,aU,true);a1===null&&(a1=aM.toDate(aP,E.GLOBALCONFIG.dateformat,true));if(a1!==null){aL.val(aM.format(a1,aU))}return false}else{if(!E.isNumeric(aJ)||aJ<=0){return}aR=aS.getLen(aP);if(aR>aJ){return false}}}}this.$self.find("input,textarea").each(function(){this.onpaste=an});x();K.call(this);E(".hfv-item",this.$self).each(function(aH){var aI=E(this);var aJ=E(":input",aI);if(aJ.hasClass("disp")||aJ.attr("data-readonly")=="1"){aI.addClass("hfv-item-disp")}}).on("click",function(aK){var aJ=aK.target;var aH=["INPUT","SELECT","OPTION","TEXTAREA","BUTTON"];if(aJ){if(E.inArray(aJ.tagName,aH)<0){var aI=E(this).find("input,textarea");aI.focus()}}})};g.prototype._lmtin=function(X,ab,Y,W){var aa=this,Z=E.NumberHelper;if(X.hasClass("cmoney")){X.keydown(function(aj){if(X.attr("data-readonly")==="1"){return false}var ah=aj.which,af,ao,ak,ad,ae,al,ac,ai,am,an;if(ah===8||ah===46){ac=X.val();if(ac===""){return}af=aa.caret(X),ao=ad=af.begin,ak=ae=af.end;ai=ac.indexOf(".");am="";if(ae-ad===0){ad=ah===8?ad-1:ad;ae=ah===8?ae:ae+1}for(var ag=ad;ag<ae;ag+=1){ag>ai&&(am+="0");ag===ai&&(am+=".")}al=ac.substr(0,ad)+am+ac.substr(ae);an=Z.format(al,".00");/^(?:\-\.|\.)/.test(al)&&(an=an.replace(/0\./g,"."));if(an!==".00"){X.val(an);aa.caret(X,(ah===8||ak>ao)?ad:(ae>ai?ad+1:ad))}else{X.val("");aa.caret(X,0)}aj.preventDefault();X.trigger("change")}}).keypress(function(an){if(X.attr("data-readonly")==="1"){return false}var af=[9,13],aj=an.which,ac,ao,al,ae;if(an.ctrlKey){if(!/[acvz]/i.test(String.fromCharCode(aj))){return false}return}if(an.altKey){return}if(E.inArray(an.keyCode,af)>-1){return}if(aj===0){return}if(ab!=="$null"){ac=new RegExp(ab);ao=String.fromCharCode(aj);if(!ac.test(ao)){return false}}if(Q.test(Y)){al=parseInt(Y,10);if(al>0){ae=E(this).val();if(!Q.test(W)||(W=parseInt(W,10))<=0){W=0}var ah=aa.caret(X),ad=ah.begin,ag=ah.end,ar=new RegExp("^[-+]?\\d{0,"+(Y-W)+"}\\.\\d{2}$"),ap,am,aq,ak;if(ae===""){if(ao==="."||ao==="0"){X.val("0.00");aa.caret(X,2);an.preventDefault();X.trigger("change");return}else{if(ao==="-"){X.val("-.00");aa.caret(X,1);an.preventDefault();X.trigger("change");return}}}ak=ae.indexOf(".");if(ao==="."){aa.caret(X,ak+1);an.preventDefault();X.trigger("change");return}aq="";for(var ai=ad;ai<ag;ai+=1){ai>ak&&(aq+="0");ai===ak&&(aq+=".")}aq=ao+(ad>ak?aq.substr(1):aq);ap=ae.substr(0,ad)+aq+ae.substr(ad>ak?(ad===ag?ag+1:ag):ag);am=Z.format(ap,".00");if(!ar.test(am)){return false}/^[-][.]/.test(ap)&&(am=am.replace(/0\./g,"."));X.val(am);aa.caret(X,ad+1);an.preventDefault();X.trigger("change")}}})}else{X.keypress(function(ag){if(ag.ctrlKey){if(!/[acvz]/i.test(String.fromCharCode(ag.which))){return false}return}if(ag.altKey){return}var ae=[8,9,13];if(E.inArray(ag.keyCode,ae)>-1){return}if(ag.which==0){return}if(ab!="$null"){var af=new RegExp(ab);var ai=String.fromCharCode(ag.which);if(!af.test(ai)){return false}}if(Q.test(Y)){var ac=parseInt(Y,10);if(ac>0){var ah=E(this).val();X.hasClass("cnum")&&(ah=ah.replace(/[-.]/g,""));if(t.getLen(ah)>=ac){var ad=false;if(l.isNumber(this.selectionStart)){(this.selectionEnd>this.selectionStart)&&(ad=true)}else{if(document.selection){(document.selection.createRange().text.length>0)&&(ad=true)}}if(!ad){return false}}}}})}};g.prototype._gin=function(W){var X=this.ops.items[W],Y=this.ops.name;if(w(Y)){return Y+"."+X.name}return X.name};g.prototype._callif=function(X,ab){var ad=X.attr("name");if(R.call(this,X)){return}if(this._static){if(ad.indexOf(".")<0){var ac=this.ops.name;if(w(ac)){ad=ac+"."+ad}}}var W=this.ops.items;var aa=false;for(var Y=0;Y<W.length;Y+=1){if(this._gin(Y)==ad){aa=W[Y];if(E.isFunction(aa[ab])){var Z=aa[ab](X,this);return Z}}}};g.prototype._iid=function(W){if(W){return this.fid+"_"+W.replace(/\./g,"_")}else{return this.fid+"_null"+(c++)}};g.prototype._lh=function(X){var Y=this.ops.items[X],W="",Z;if(l.isFunction(Y.renderLabel)){return Y.renderLabel(this.fid)}if(Y.type==="hidden"){return""}if(Y.type=="files"){Y.type="file";Y.mutliFile=true}else{if(Y.type=="fillidea"){Y.type="textarea";Y.fillidea=true}}Z=this._iid(Y.name);W+='<label for="'+Z+'"';Y.required&&(W+=' class="hfv-label-required" ');W+=">";if(Y.required){W+='<span class="hfv-rr" style="color:red">*</span>'}W+=Y.label+"</label>";return W};g.prototype._ih=function(ab){var aj=this.ops.items[ab];var X=[];var ak=[];if(aj.type==="money"){aj.type="number";!E.isNumeric(aj.maxLength)&&(aj.maxLength=16);!E.isNumeric(aj.precision)&&(aj.precision=2);aj.plusNumber=!!aj.plusNumber;X.push("cmoney")}var ad="";var ai=this._iid(aj.name);if(l.isFunction(aj.renderItem)){return aj.renderItem(this.fid)}if(aj.type=="$null"||!aj.name){return""}aj.id=ai;var ag="";if(!(aj.type=="checkbox"||aj.type=="radio")){ag+=' id="'+ai+'"';ag+=' name="'+this._gin(ab)+'"'}if(aj.defaultValue&&aj.type!="textarea"&&!aj.values){if(aj.type==="date"){var aa=(T.isValidDate(aj.defaultValue)?aj.defaultValue:T.toDate(aj.defaultValue,E.GLOBALCONFIG.dateformat,true));aa===null&&(aa=T.toDate(aj.defaultValue,aj.mask,true));ag+=' value="'+(T.format(aa,aj.mask)||aj.defaultValue)+'"'}else{if(aj.type==="number"){ag+=' value="'+(E.NumberHelper.format(aj.defaultValue,aj.mask)||aj.defaultValue)+'"'}else{ag+=' value="'+aj.defaultValue+'"'}}}if(aj.type=="hidden"){return'<input type="hidden"'+ag+"/>"}aj.title&&(ag+=' title="'+aj.title+'"');if(/^(?:text|textarea|number|date)$/i.test(aj.type)){/^(?:number|date)$/i.test(aj.type)&&(aj.ime="disable");/^(?:enable|disable)$/i.test(aj.ime)&&ak.push("ime-mode:"+A[aj.ime]+";")}aj.style&&ak.push(aj.style);aj.type==="number"&&!/^(?:left|center|right)$/i.test(aj.itemAlign)&&(aj.itemAlign="right");aj.itemAlign&&(ak.push("text-align:"+aj.itemAlign+";"));if(aj.type!=="display"&&aj.readOnly){ag+=" "+D(aj.type)+' data-readonly="1"';!/^(?:checkbox|radio)$/i.test(aj.type)&&ak.push("background-color: "+a.labelBgColor+";border:1px solid "+a.labelBgColor+";")}ak.length&&(ag+=' style="'+ak.join("")+'"');if(aj.className){X.push(aj.className)}if(aj.type=="list"){if(l.isString(aj.values)){ad+='<span sid="'+ab+'" class="hfv-itemloading">&nbsp;</span>';return ad}X.push("cinput");ag+=' class="'+X.join(" ")+'"';ad+="<select"+ag+'><option value="">请选择...</option>';if(aj.values){for(var af=0;af<aj.values.length;af+=1){ad+='<option value="'+aj.values[af].val+'"';if(aj.defaultValue==aj.values[af].val){ad+=" selected"}ad+=">"+aj.values[af].label+"</option>"}}ad+="</select>"}else{if(aj.type=="textarea"){X.push("cinput");ag+=' class="'+X.join(" ")+'"';ad+="<textarea"+ag+" "+(aj.fillidea?'fillidea="1"':"")+">"+(aj.defaultValue||"")+"</textarea>"}else{if(aj.type=="display"){X.push("disp");ag+=' class="'+X.join(" ")+'"';ad+='<input type="text"'+ag+" readonly/>"}else{if(aj.type=="date"){X.push("cinput");X.push("cdate");ag+=' class="'+X.join(" ")+'"';ad+='<input type="text"'+ag+"/>"}else{if(aj.type=="number"){X.push("cinput");X.push("cnum");ag+=' class="'+X.join(" ")+'"';ad+='<input type="text"'+ag+"/>"}else{if(aj.type=="checkbox"||aj.type=="radio"){if(X.length>0){ag+=' class="'+X.join(" ")+'"'}ad+='<span class="fvbtnms" id="'+aj.id+'"';if(aj.valSplit){ad+=' data-vsp="'+aj.valSplit+'"'}ad+=">";if(!aj.values||aj.values.length<1){if(aj.type=="radio"){aj.values=[];alert("radio项:"+aj.name+"必须两个以上")}else{if(aj.type=="checkbox"){aj.values=[{val:aj.checkVal||"1"}]}}}for(var ab=0;ab<aj.values.length;ab++){var ae=aj.values[ab];ad+="<input ";if(aj.type=="radio"){ad+=' name="'+aj.name+'"'}else{if(ae.name){ad+=' name="'+ae.name+'"'}}ad+=(E.isArray(aj.defaultValue)?(E.inArray(aj.values[ab].val,aj.defaultValue)>-1?"checked ":""):(aj.values[ab].val===aj.defaultValue?"checked ":""))+'type="'+aj.type+'" id="'+aj.id+"_"+ab+'" value="'+aj.values[ab].val+'"'+ag+"/>"+(ae.label?'<label id="'+aj.id+"_"+ab+'_l" for="'+aj.id+"_"+ab+'">'+aj.values[ab].label+"</label>":"")}ad+="</span>"}else{if(aj.type==="file"){ag+=' class="cfile"';ad+='<input type="hidden" '+ag+" />"}else{if(aj.type==="image"){var Y=aj.width||88,ah=aj.height||107,Z=E.GLOBALCONFIG.ctxpath+"/",W=aj.src||Z+E.GLOBALCONFIG.defaultImg,ac=aj.alt||"";ad+=t.format(m,ai,I(W),Y,ah,ac,aj.src)}else{X.push("cinput");E.isFunction(aj.findOpen)&&X.push("cfindf9");if(E.isFunction(aj.findOpen)&&aj.selectOnly){X.push("selectoy")}if(X.length>0){ag+=' class="'+X.join(" ")+'"'}ad+='<input type="'+aj.type+'"'+ag+"/>"}}}}}}}}return ad};g.prototype._cld=function(aa,ab,ac,W){var Y=aa.parent();var Z=this.ops.items[W];aa.remove();Z.values=ab;var X=this._ih(W);Y.append(X);if(l.isFunction(Z.valuesLoaded)){Z.valuesLoaded(Z.id)}};g.prototype._lgd=function(){var W=this;E(".hfv-itemloading",this.$elem).each(function(){var Y=E(this);var X=Y.attr("sid");E.ajax({type:"POST",dataType:"json",url:W.ops.items[X].values,success:function(Z){W._cld(Y,Z,W,X)},error:function(Z,ab,aa){W._cld(Y,[],W,X);alert("下拉列表["+it.name+"]查询下拉项数据出错!,请检查网络连接状态!")}})})};g.prototype.getItem=function(X){var W=E("#"+this._iid(X));if(W.hasClass("fvbtnms")){return W.find("input")}return W};g.prototype.getVal=function(X){var W=this._gv(X);if(W==null){return""}return W};g.prototype._gv=function(ae){var ad=this.getItem(ae),af;if(ad.length==1){var Y=ad.attr("type");if(Y=="checkbox"||Y=="radio"){return ad.filter(":checked").val()}if(ad.hasClass("cdate")){return T.getFullDateString(ad.val(),ad.attr("dmask"))}if(ad.attr("data-type")==="img"){return ad.attr("data-src")}return ad.val()}else{if(ad.length>1){var W=ad.parent().attr("data-vsp");if(ad.filter(":checkbox").length>0){var ac=[],Z=false,aa={};ad.each(function(){var ai=E(this);var ag=ai.attr("name");if(ag&&ag.length>0){Z=true;aa[ag]=""}if(ai.filter(":checked").length>0){var ah=ai.val();if(ag&&ag.length>0){aa[ag]=ah}else{ac.push(ah)}}});if(W&&W.length){return ac.join(W)}if(Z){return aa}return ac}else{return ad.filter(":checked").val()}}else{ad=E("#"+this.fid).find(".fvbtnms");for(var X=0;X<ad.length;X++){var ab=E(ad.get(X)).find('input[name="'+ae+'"]');if(ab.length>0){if(ab.filter(":checked").length>0){return ab.val()}else{return""}}}}}return null};g.prototype.setData=function(aa,X){var Y=E("#"+this.fid).find(".fvbtnms");for(var Z in aa){var ab=aa[Z];var ae=E.NumberHelper;var af=this.getItem(Z);if(af.length==1){if(af.attr("type")=="checkbox"){if(ab==af.val()){af.attr("checked",true)}else{af.attr("checked",false)}}else{if(af.hasClass("cdate")){var ag=(T.isValidDate(ab)?ab:T.toDate(ab,E.GLOBALCONFIG.dateformat,true));ag===null&&(ag=T.toDate(ab,af.attr("dmask"),true));af.val(T.format(ag,af.attr("dmask"))||ab)}else{if(af.attr("data-type")==="img"){af.attr({src:I(ab),"data-src":ab})}else{if(af.hasClass("cmoney")){af.val(ae.format(ab,".00"))}else{af.val(ab);if(af.hasClass("cfile")){var ad=af.data("$afi");if(ad&&ad.setVal){ad.setVal(ab)}}}}}}}else{if(af.length>1){var W=af.parent().attr("data-vsp");af.each(function(){var ai=E(this);var ah=ai.attr("type");if(ah=="radio"){if(ab==ai.val()){ai.attr("checked",true)}else{ai.attr("checked",false)}}else{if(ah=="checkbox"){if(E.isArray(ab)){if(E.inArray(ai.val(),ab)>-1){ai.attr("checked",true)}}else{if(W&&W.length){if(E.inArray(ai.val(),ab.split(W))>-1){ai.attr("checked",true)}}}}}})}else{Y.each(function(ah){var ai=E(this).find('input[name="'+Z+'"]');if(ai.length>0){if(ab==ai.val()){ai.attr("checked",true)}}})}}}var ac;if(X){ac=this.checkData()}V();return !!ac};g.prototype.getData=function(W){var ad={},Y,ae=false,af=false,aa=E.isPlainObject(W),Z=l.isBoolean(W),ac=w(this.ops.name)?(this.ops.name+"."):"";Z&&!W&&(ac="");for(var ab=0;ab<this.ops.items.length;ab+=1){ae=this.ops.items[ab];af=false;if(ae.name&&ae.name.length>0){if(aa){if(W.include){af=false;if(E.inArray(ae.name,W.include.split(","))>=0){af=true}}if(W.exclude){af=true;if(E.inArray(ae.name,W.exclude.split(","))>=0){af=false}}}else{af=true}}if(af){Y=this.getVal(ae.name);if(ae.type=="checkbox"&&E.isPlainObject(Y)){for(var X in Y){ad[ac+X]=Y[X]}}else{ad[ac+ae.name]=Y}}}return ad};g.prototype.itemOff=function(Y){var W=[],X=this;if(!arguments.length){E.each(this.ops.items,function(Z,aa){aa.type!=="display"&&W.push("#"+X._iid(aa.name))})}else{if(E.isArray(Y)){E.each(Y,function(Z,aa){v.call(X,aa)&&W.push("#"+X._iid(String(aa)))})}else{v.call(this,String(Y))&&(W[0]="#"+this._iid(String(Y)))}}if(!W.length){return}E(W.join(","),this.$self).each(function(Z,aa){E(this).hasClass("fvbtnms")&&(aa=E("input",this));d.call(X,aa);document.activeElement&&document.activeElement===aa&&aa.blur()})};g.prototype.itemOn=function(Y){var W=[],X=this;if(!arguments.length){E.each(this.ops.items,function(Z,aa){aa.type!=="display"&&W.push("#"+X._iid(aa.name))})}else{if(E.isArray(Y)){E.each(Y,function(Z,aa){v.call(X,aa)&&W.push("#"+X._iid(String(aa)))})}else{v.call(this,String(Y))&&(W[0]="#"+this._iid(String(Y)))}}if(!W.length){return}E(W.join(","),this.$self).each(function(Z,aa){E(this).hasClass("fvbtnms")&&(aa=E("input",this));d.call(X,aa,true)})};g.prototype._chkit=function(ak,ag){var af=0;var Y="";var ah="";var ad=0;var Z=n.call(this,ak);ak.errorText=false;if(ak.type=="checkbox"){if(ak.required||ak.minLength||ak.maxLength){this._chkCb(ak)}return}if(ak.required){if(this._chkReq(ag)){ak.errorText=Z?(((ak.type=="radio"||ak.type=="checkbox"||ak.type=="list")?"请选择":"请输入")+Z):"必输项，请输入";return}}if(ak.type!="number"&&ak.type!="checkbox"&&ak.type!="radio"&&(ak.minLength||ak.maxLength)){if(ag.length==1){Y=ag.val();af=t.getLen(Y);if(ak.minLength&&af<ak.minLength){ak.errorText=(Z||"")+"输入长度应大于等于"+ak.minLength+"个字符(汉字算2个字符)";return}if(ak.maxLength&&af>ak.maxLength){ak.errorText=(Z||"")+"输入长度不能超过"+ak.maxLength+"个字符(汉字算2个字符)";return}}}if(ak.type=="number"&&ag.length==1){Y=""+ag.val();if(t.isEmpty(Y)){return}if(!(M.test(Y))){ak.errorText=Z+"输入的不是有效数值";return}if(ak.plusNumber&&/^[-]+/.test(Y)){ak.errorText=Z+"不能为负数";return}var X=(l.isNumber(ak.precision)&&ak.precision>0),aj=(l.isNumber(ak.minLength)&&ak.minLength>0),W=(l.isNumber(ak.maxLength)&&ak.maxLength>0),ai=Q.test(Y);X&&(ad=ak.precision);if(ad===0){if(!ai){ak.errorText=Z+"只能输入整数";return}}W&&aj&&ak.minLength>ak.maxLength&&(ak.minLength=ak.maxLength);aj&&ad>ak.minLength&&(ad=0);W&&ad>ak.maxLength&&(ad=0);var ae=RegExp["$1"],ac=0,aa;(!ai)&&(ac=ae.length);if(ad<ac){ak.errorText=Z+"输入的小数位数不能超过"+ad+"位";return}Y=t.trimLeft(Y,"-");aa=ai?Y.length:Y.length-ac-1;if(aj){if(aa<ak.minLength-ad){ak.errorText=Z+"输入的整数位长度至少需要"+(ak.minLength-ad)+"位";return}}if(W){if(aa>ak.maxLength-ad){ak.errorText=Z+"输入的整数位长度不能超过"+(ak.maxLength-ad)+"位";return}}}if(ak.type=="date"&&ag.length==1){Y=ag.val();if(t.isEmpty(Y)){return}!ak.hasOwnProperty("mask")&&(ak.mask=E.GLOBALCONFIG.dateformat);var ab=T.toDate(Y,ak.mask,true);if(ab===null){ak.errorText=Z+"无效"+(ak.mask?("，格式为"+ak.mask.toLowerCase()):"");return}}if(ak.minValue!=undefined||ak.maxValue!=undefined){Y=""+ag.val();if(ak.minValue!=undefined&&Y<ak.minValue){ak.errorText=Z+"输入的值不能小于"+ak.minValue}if(ak.maxValue!=undefined&&Y>ak.maxValue){ak.errorText=Z+"输入的值不能大于"+ak.maxValue}}if(l.isFunction(ak.validateMethod)&&ag.length==1){Y=ag.val();ah=ak.validateMethod(ag,Y);if(!t.isEmpty(ah)){ak.errorText=ah}}};g.prototype._chki=function(X,W){if(X.name===""||/^(?:display|hidden|\$null)$/i.test(X.type)||R.call(this,W)){X.errorText=false;return}this._chkit(X,W);if(X.errorText){if(X.type==="checkbox"||X.type==="radio"){W.parent().css({"border-color":"#f00",color:"#f00"}).attr("title",X.errorText)}else{W.css({"border-color":"#f00",color:"#f00"}).attr("title",X.errorText)}}else{if(X.type==="checkbox"||X.type==="radio"){if(this._static&&this._sfds){W.parent().removeAttr("title")}else{W.parent().css({"border-color":a.bdColor,color:"#000"}).removeAttr("title")}}else{if(this._static&&this._sfds){W.removeAttr("title")}else{W.css({"border-color":a.itemBgColor,color:"#000"}).removeAttr("title")}}}};g.prototype.checkData=function(aa){var X=this.ops.items;var Z=false;var W=false;var ab=false;for(var Y=0;Y<X.length;Y+=1){Z=X[Y];W=this.getItem(Z.name);this._chki(Z,W);if(Z.errorText){if(!ab){E(W.get(0)).focus();ab=true}}}return !ab};g.prototype.getErrors=function(aa){var X=[];var W=this.ops.items;var Z=0;for(var Y=0;Y<W.length;Y+=1){if(W[Y].errorText){X.push(W[Y].errorText);Z+=1;if(aa>0&&Z>=aa){break}}}return X.join("\n")};g.prototype._chkCb=function(W){var X=this.getVal(W.name);if(X&&W.valSplit){X=X.split(W.valSplit)}if(E.isArray(X)){if(W.required){W.minLength=1}if(W.minLength&&X.length<W.minLength){W.errorText=(W.label?W.label:"")+"至少选择"+W.minLength+"项"}if(W.maxLength&&X.length>W.maxLength){W.errorText=(W.label?W.label:"")+"最多只能选择"+W.maxLength+"项"}}};g.prototype._chkReq=function(W){var X=null;W.each(function(){var Y=E(this);if(Y.attr("type")=="radio"){if(Y.filter(":checked").length>0){X=Y.val()}}else{X=Y.val()}});return t.isEmpty(X)};g.prototype.reset=function(){var X=this.ops.items,ac=false,W=false,ab;for(var aa=0;aa<X.length;aa+=1){ac=X[aa];if("display"!=ac.type){if(ac.readOnly){this.itemOff(ac.name);ab=a.labelBgColor}else{this.itemOn(ac.name);ab=a.itemBgColor}}else{ab=a.labelBgColor}if(ac.type=="checkbox"||ac.type=="radio"){if(ac.values){for(var Y=0;Y<ac.values.length;Y++){W=E("#"+ac.id+"_"+Y);W.attr("checked",false);if(ac.defaultValue){if(ac.type=="checkbox"){if(E.isArray(ac.defaultValue)){if(E.inArray(ac.values[Y].val,ac.defaultValue)>-1){W.attr("checked",true)}}else{if(ac.valSplit){if(E.inArray(ac.values[Y].val,ac.defaultValue.split(ac.valSplit))>-1){W.attr("checked",true)}}else{if(ac.defaultValue==ac.values[Y].val){W.attr("checked",true)}}}}else{if(ac.defaultValue==ac.values[Y].val){W.attr("checked",true)}}}}W.parent().css({color:"#000"})}}else{W=E("#"+this._iid(ac.name));if(!(this._static&&this._sfds)){W.css({"border-color":ab,color:"#000"})}if(ac.type==="date"){var ad=(T.isValidDate(ac.defaultValue)?ac.defaultValue:T.toDate(ac.defaultValue,E.GLOBALCONFIG.dateformat,true));ad===null&&(ad=T.toDate(ac.defaultValue,ac.mask,true));W.val(T.format(ad,ac.mask)||ac.defaultValue)}else{if(W.hasClass("cfile")){var Z=W.data("$afi");if(Z&&Z.setVal){Z.setVal("")}}else{W.val(ac.defaultValue||"")}}}}};g.prototype.setVal=function(Y,W){var X={};X[Y]=W;this.setData(X)};g.prototype.setListData=function(ad,Z,ae){var ab=this.getItem(ad),W=ab[0],aa,ac,X,Y;if(!W||W.tagName.toLowerCase()!=="select"||!E.isArray(Z)){return}W.options.length=0;W.add(new Option("请选择...",""),undefined);ac=Z.length;for(aa=0;aa<ac;aa+=1){Y=Z[aa];X=new Option(Y.label,Y.val);ae!=null&&ae===Y.val&&(X.selected=true);W.add(X,undefined)}};g.prototype.caret=r;g.prototype.show=function(){E("#"+this.fid).show()};g.prototype.hide=function(){E("#"+this.fid).hide()};function J(W){var aa=this.ops.buttons;var ad=this.ops.items;var ae,ac=0,ab,Z,X;if(aa){for(ac=0;ac<aa.length;ac++){var Y=aa[ac];if(Y.buttons){ae=Y.buttons;for(ab=0;ab<ae.length;ab++){if(ae[ab].id==W){return this.buttons[ac]}}}}}if(ad){for(Z=0;Z<ad.length;Z++){if(ad[Z].buttons){ae=ad[Z].buttons;for(X=0;X<ae.length;X++){if(ae[X].id==W){return this.buttons[ac]}}ac++}}}return false}g.prototype.btnOff=function(Y){if(!Y){for(var W=0;W<this.buttons.length;W++){this.buttons[W].disable()}return}var X=J.call(this,Y);if(X){X.disable(Y)}};g.prototype.btnOn=function(Y){if(!Y){for(var W=0;W<this.buttons.length;W++){this.buttons[W].enable()}return}var X=J.call(this,Y);if(X){X.enable(Y)}};g.prototype.btnShow=function(Y){if(!Y){for(var W=0;W<this.buttons.length;W++){this.buttons[W].show()}return}var X=J.call(this,Y);if(X){X.show(Y)}};g.prototype.btnHide=function(Y){if(!Y){for(var W=0;W<this.buttons.length;W++){this.buttons[W].hide()}return}var X=J.call(this,Y);if(X){X.hide(Y)}};g.prototype.bind=function(W,X,aa){var ac=E("#"+W);if(this.buttons.length>0&&ac.length>0){var ab=J.call(this,W);if(ab){ab.bind(W,X,aa);return true}}ac=this.getItem(W);if(ac.length>0){if(this._static){var ae=["findOpen"];if(E.inArray(X,ae)>-1){var Z=this.ops.items;for(var Y=0;Y<Z.length;Y++){var ad=Z[Y];if(ad.name==W){ad[X]=aa;return true}}}}if(E.isFunction(X)){aa=X;X="click"}ac.on(X,aa);return true}return false};g.prototype.getFileObj=function(X){var W=this.getItem(X);if(W&&W.length>0){return W.data("$afi")}};g.prototype.setRequired=function(aa,ab){var X=this.ops.items,Z,W;for(var Y=0;Y<X.length;Y++){Z=X[Y];if(Z.name==aa){Z.required=(ab?true:(ab==undefined?true:false));W=E("#"+this.fid).find('label[for="'+this._iid(aa)+'"]');if(W.length>0){if(Z.required){W.addClass("hfv-label-required");$rr=W.find(".hfv-rr");if($rr.length<1){W.prepend('<span class="hfv-rr" style="color:red">*</span>')}else{$rr.show()}}else{W.removeClass("hfv-label-required");W.find(".hfv-rr").hide()}}break}}};function U(){var ac=this.ops.buttons,ab=[],W=this.ops.items,Z=this;if(!E.Buttons){return}if(E.isPlainObject(ac)){ab.push(ac)}else{if(E.isArray(ac)){ab=ac}}E.each(ab,function(ad,ae){Z.buttons.push(y.call(Z,ae))});for(var X=0;X<W.length;X++){var Y=W[X];if(Y.type=="file"){if(!Y.buttons){Y.buttons=[{id:Y.id+"_btn_u",label:"选择文件...&nbsp;",iconClass:"icon_add",act:"up",fileParams:Y.fileParams},{id:Y.id+"_btn_d",label:"下载&nbsp;",iconClass:"icon_disk",act:"down",fileParams:Y.fileParams},{id:Y.id+"_btn_r",label:"删除&nbsp;",iconClass:"icon_delete",act:"delete",fileParams:Y.fileParams}]}}if(Y.name&&Y.buttons){var aa={buttons:Y.buttons};aa.align=Y.btnAlign||"right";aa.forItem=Y.name;this.buttons.push(y.call(this,aa))}}}function y(W){if(!E.isPlainObject(W)){return}var Z=false;if(W.row&&W.col){Z=h.call(this,W.row,W.col)}else{if(W.forItem){Z=E("#"+this.fid+"_"+W.forItem).parent()}else{if(W.forDom){Z=E(W.forDom);W.forDom=null}else{Z=e.call(this)}}}if(W.buttons){var Y=W.buttons;for(var X=0;X<Y.length;X++){if(!Y[X].style){Y[X].style="fb"}}}return E.Buttons(Z,W,"tbar",0)}function h(X,W){return this.layoutTable.find(t.format(s,X,W))}function e(){return this.layoutTable.find(f)}function d(Z,X){var ab=E(Z),Y,W,aa;if(!ab.length){return}W=ab[0].tagName.toLowerCase();if(!S.test(W)){return}Y=W;W==="input"&&!G.test((Y=(ab.attr("type")||"text").toLowerCase()))&&(Y="text");if(!u.hasOwnProperty(Y)){return}aa=u[Y];if(/^(?:checkbox|radio)$/i.test(Y)){if(X){ab.removeAttr(aa).attr("data-readonly","0").each(function(){var ae=E(this);var ad=ae.attr("id");var ac=E("#"+ad+"_l");ac.attr("for",ad)});ab.parent().parent().removeClass("hfv-item-disp")}else{ab.attr(aa,aa).attr("data-readonly","1").each(function(){var ae=E(this);var ad=ae.attr("id");var ac=E("#"+ad+"_l");ac.removeAttr("for")});ab.parent().parent().addClass("hfv-item-disp")}}else{if(X){if(this._static&&this._sfds){ab.removeAttr(aa).attr("data-readonly","0").css({"background-color":"#ffd"})}else{ab.removeAttr(aa).css({"background-color":"#FFF","border-color":"#fff"}).attr("data-readonly","0").parent().removeClass("hfv-item-disp")}}else{if(this._static&&this._sfds){ab.attr(aa,aa).attr("data-readonly","1")}else{ab.attr(aa,aa).css({"background-color":a.labelBgColor,"border-color":a.labelBgColor}).attr("data-readonly","1").parent().addClass("hfv-item-disp")}}}}function D(W){!P.hasOwnProperty(W)&&(W="text");return P[W]}function q(){var ab,W,Y,aa,Z=this,X;if(this._slide_===null){return}ab=this.$self;W=ab.children("tbody");Y=ab.children("tfoot");aa=E("#"+C.call(this),ab);X=this._slide_;aa.on("click",function(){if(X.state==="on"){W.hide();Y.show();aa.removeClass("shrink").addClass("expand").attr("title","展开");X.state="off"}else{W.show();Y.hide();aa.removeClass("expand").addClass("shrink").attr("title","收缩");X.state="on"}E(window).resize()})}function F(X,Y){var W=0;E.each(Y,function(aa,Z){X<=Z.rowIdx&&(W+=(parseInt(Z.cols,10)||1))});return W}function v(Z){var W=this.ops.items,X=W.length-1,Y;for(;X>=0;X--){if((Y=W[X]).name===Z&&Y.type!=="display"){return true}}return false}function R(W){var X;if(typeof W==="string"){X=this.getItem(W)}else{X=E(W)}return X.attr("data-readonly")==="1"}function o(W){var X;if(typeof W==="string"){X=this.getItem(W)}else{X=E(W)}return X.hasClass("selectoy")}function r(aa,Y,W){var X,Z,Y,W;if(aa.length===0||aa.is(":hidden")){return}Z=aa[0];if(E.isNumeric(Y)){W=(E.isNumeric(W))?W:Y;if(Z.setSelectionRange){Z.setSelectionRange(Y,W)}else{if(Z.createTextRange){X=Z.createTextRange();X.collapse(true);X.moveEnd("character",W);X.moveStart("character",Y);X.select()}}}else{if(Z.setSelectionRange){Y=Z.selectionStart;W=Z.selectionEnd}else{if(document.selection&&document.selection.createRange){X=document.selection.createRange();Y=0-X.duplicate().moveStart("character",-100000);W=Y+X.text.length}}return{begin:Y,end:W}}}function z(W){if(W&&("clipboardData" in W)){return W.clipboardData.getData("text")}else{if("clipboardData" in window){return window.clipboardData.getData("text")}}return""}function n(Y){var Y,X,W="";if(!E.isPlainObject(Y)||Y.name==null||Y.name===""){return W}Y=b.call(this,Y.name);if(Y===null){return W}W=Y.label==null?"":String(Y.label);if(Y.relateItem!=null&&String(Y.relateItem)!==""){X=b.call(this,Y.relateItem);X!==null&&(W=X.label==null?"":String(X.label))}return W}function b(Y){if(Y==null||(Y=String(Y))===""){return null}var X=this.ops.items,W=X.length,Z=0;for(;Z<W;Z+=1){if(X[Z].name===Y){return X[Z]}}return null}function V(){return;var Y=E.browser,X=Y.msie,ab,aa,ac,ad,Z,W;if(X){ab=document.styleSheets;for(Z=ab.length-1;Z>=0;Z--){ac=(aa=ab[Z]).rules;for(W=0,ad=ac.length;W<ad;W+=1){if((E.trim(ac[W].selectorText).toLowerCase())===".hfv-item"){V=function(){aa.removeRule(W);aa.addRule(".hfv-item","border:1px solid "+a.bdColor+";background-color:"+a.itemBgColor+";width:200px;padding:2px;border-left:0 none;border-bottom:0 none;",W)};return}}}}else{V=function(){}}}V();function x(){var Z=E.browser,ab=Z.msie,ac,aa,ae,ag,W,af,ad,Y,X;if(ab&&parseInt(Z.version,10)>8){ac=document.styleSheets;for(Y=ac.length-1;Y>=0;Y--){ae=(aa=ac[Y]).rules;for(X=0,ag=ae.length;X<ag;X+=1){if((W=E.trim(ae[X].selectorText).toLowerCase())===".hfv-label"){af=X}else{if(W===".hfv-item"){ad=X}}if(E.isNumeric(af)&&E.isNumeric(ad)){x=function(){aa.removeRule(ad);aa.removeRule(af);x=function(){};setTimeout(function(){aa.addRule(".hfv-label","border:1px solid "+a.bdColor+";background-color:"+a.labelBgColor+";text-align:right;width:100px;padding:2px 8px;border-left:0 none;border-bottom:0 none;",af);aa.addRule(".hfv-item","border:1px solid "+a.bdColor+";background-color:"+a.itemBgColor+";;width:200px;padding:2px;border-left:0 none;border-bottom:0 none;",ad)},0)};return}}}}}x();function K(){var W=this;if(E.browser.msie){this.$self.on("focus",'input[type="text"],textarea',function(Y){var X=this.currentStyle;!(R.call(W,this)||o.call(W,this)||this.readOnly)&&X.borderColor.toLowerCase()!=="#f00"&&(this.style.borderColor="#edc87c")}).on("blur",'input[type="text"],textarea',function(Y){var X=this.currentStyle;!(R.call(W,this)||o.call(W,this)||this.readOnly)&&X.borderColor.toLowerCase()!=="#f00"&&(this.style.borderColor=a.itemBgColor)})}}E.FormView=function(Z,Y){var X;if(arguments.length==1&&typeof Z=="string"){var aa=Z;!/^#.*/i.test(aa)&&(aa="#"+aa);var W=E(aa);if(W.length>0){X=W.data("$hfv");return X}return false}X=new g(Z,Y);X._init();X.$self.data("$hfv",X);return X};E.StaticFormView=function(ar,ad){if(!ar){return false}var ap=E("form[name='"+ar+"']");if(ap.length<1||ap.get(0).tagName!="FORM"){alert("页面上无静态表单:"+ar);return false}var aq=ar;p++;var W="hfv"+p;ap.attr("id",W);var Y=[];var ae=[];var ai=ap.get(0).elements;var ah=[];var ao=function(au){for(var at=0;at<ae.length;at++){if(au.forDom==ae[at].forDom){if(!ae[at].buttons){ae[at].buttons=[]}ae[at].buttons.push(au.buttons[0]);return}}ae.push(au)};var ac=function(au){for(var at=0;at<Y.length;at++){if(Y[at].type=="file"||Y[at].type=="files"){if((aq+"."+Y[at].name)==au){return Y[at]}}}return false};var af=function(at,aw){var au,ay,aA;var aB=["up","down","edit","delete","view"];var aC=["icon_add","icon_disk","icon_cog_edit","icon_delete","icon_find"];var aD=at.attr("onclick");if(aD&&aD.length>10){var az=aD.substr(0,8);var ax=["__FileUp","__FileDo","__FileEd","__FileDe","__FileVi"];var av=E.inArray(az,ax);if(av>-1){ay=aB[av];aA=aC[av];var aE=aD.split("'");if(aE.length==3){au=ac(aE[1])}}}if(au){if(!au.buttons){au.buttons=[]}aw.act=ay;aw.style="fb";aw.iconClass=aA;au.buttons.push(aw);return true}return false};for(var ak=0;ak<ai.length;ak++){var am=ai[ak];var Z=E(am);if(am.type=="button"||am.type=="submit"){var ag={};ag.align=Z.parent().css("text-align")||"right";ag.forDom=Z.parent().get(0);var X={id:Z.attr("name"),label:Z.html()||Z.attr("title")};if(!af(Z,X)){var al=Z.attr("ops-icon");if(al){X.iconClass="icon_"+al}ag.buttons=[];ag.buttons.push(X);ao(ag)}Z.attr("disabled","disabled").hide()}else{var an={};an.name=Z.attr("name");an.id=W+"_"+an.name;an.type=Z.attr("ops-type")||am.type;an.mask=Z.attr("ops-mask");an.precision=Z.attr("ops-precision");an.label=Z.attr("title");an.required=Z.attr("ops-required")?true:false;an.minLength=Z.attr("ops-minLength");an.maxLength=Z.attr("ops-maxLength");an.maxValue=Z.attr("ops-maxValue");an.minValue=Z.attr("ops-minValue");an.findOpen=Z.attr("ops-findOpen")?true:false;an.selectOnly=Z.attr("ops-selectOnly")?true:false;if(an.findOpen){Z.addClass("cfindf9");if(an.selectOnly){Z.addClass("selectoy")}}Y.push(an);Z.attr("id",an.id);if(an.type=="file"||an.type=="files"){if(Z.get(0).tagName!="INPUT"){Z.attr("id",an.id+"_s").removeAttr("name").hide();ah.push({e:Z,h:'<input type="hidden" id="'+an.id+'" class="cfile" '+(an.type=="files"?'mutlifiles="1"':"")+"/>"})}else{Z.hide().addClass("cfile");if(an.type=="files"){Z.attr("mutlifiles","1")}}}if(an.type=="date"){Z.addClass("cdate")}else{if(an.type=="number"){Z.addClass("cnum")}}if(ad){Z.addClass("cinput");Z.parent().addClass("hfv-item")}}}for(var ak=0;ak<ah.length;ak++){var ab=ah[ak];ab.e.after(ab.h)}ap.addClass("csform");var aj=ap.parent();if(aj.length>0&&aj[0].tagName=="DIV"){aj.addClass("csformdiv")}if(ad){ap.find("table").css({"border-color":a.bdColor,"background-color":a.bgColor});ap.find("td").css({"border-color":a.bdColor,color:"#000"})}var aa=new g(ap,{id:W,name:aq,items:Y,buttons:ae});aa._static=true;aa._sfds=true;if(ad){aa._sfds=false}aa._init();return aa};E._gvef=function(W,X){var Y=new g(W,X);Y._static=true;Y._sfds=true;Y._init();return Y}})(jQuery);(function(e){var m=e.Lang,n=e.StringHelper;var k=1,g='<div id="{0}" class="les-tree-root"></div>',q="lesui_tree",b=0,i=0;function d(){return q+"_"+b++}function p(r){!e.isNumeric(r)&&(r=i++);return q+"_"+r}var o=function(r,s){this.$elem=e(r);this.gid=d();this.$root=e(n.format(g,this.gid));this.$self=this.$root;this.ops=e.extend({rtid:"0",url:function(t){return[]},checkbox:false,folderOpen:true,target:"",allowCheckType:false,onClick:function(t){return false},data:{},autoParam:[],height:"auto"},s);this.minHeight=150};o.prototype._init=function(){this.$root.append('<span class="tvrloading">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp</span>');this._crt(this.$root,"");this.$elem.append(this.$root);f.call(this)};o.prototype._crt=function(t,u){var F=this;var y=[];var w=this.ops.rtid;var C;if(m.isString(t)){w="";C=e("#"+t)}else{C=e(t)}var A;if(F.ops.checkbox){(A=C.children("span.chk"))&&A.length&&(w=A.attr("data-val"))}else{(A=C.children("input"))&&A.length&&(w=A.val())}if(m.isFunction(this.ops.url)){y=this.ops.url(w);setTimeout(function(){F._crth(C,y,u)},200);return}var x={tid:w,href:"",text:"",hasChild:""},z={},r=/^tid|href|text|hasChild$/,B=F.ops.autoParam;for(var s=0,v=B.length;s<v;s+=1){var E=B[s].split("=");if(E.length===2&&r.test(E[0])){z[E[1]]=x[E[0]]}}var D=e.extend(z,F.ops.data);if(this.ops.url.indexOf("jspaction/")>=0){D={jspactionreqjson:JSON.stringify(D)}}e.ajax({type:"POST",dataType:"json",url:this.ops.url,data:D,success:function(G){if(e.isFunction(e._chkLogon)&&e._chkLogon(G)){return}F._crth(C,G,u)},error:function(G,I,H){F._crthe(C,u,0);alert("Tree取后台数据出错!,请检查网络状态!")}})};o.prototype._crthe=function(r,t,u){var s;if(m.isString(r)){s=e("#"+r)}else{s=e(r)}var v=s.children(".htis");if(v&&v.length>0){v.removeClass("loading");if(u>0){if(t=="plus"){v.addClass("minus").removeClass("plus")}else{if(t=="plusb"){v.addClass("minusb").removeClass("plusb")}}}else{if(t==="plus"){v.addClass("join").removeClass("plus")}else{if(t==="plusb"){v.addClass("joinb").removeClass("plusb")}}}v.removeClass("htinit")}if(u>0){v=s.children(".folder");if(v&&v.length>0){v.addClass("foldero").removeClass("folder")}}this.$root.children("span.tvrloading").remove()};o.prototype._crth=function(u,A,v){if(v===""&&!e.isArray(A)){this.$root.empty().append('<span style="color:red;font-size:12px;">无节点数据</span>');return}if(!e.isArray(A)||A.length<=0){this._crthe(u,v,0);return}var E=this;var x;if(m.isString(u)){x=e("#"+u)}else{x=e(u)}var z=[];var s,B,t;var y="";var D="";var F=x;var w=false;while(F.hasClass("htitem")){if((w?(w.hasClass("minusb")||w.hasClass("plusb")):(v=="minusb"||v=="plusb"))){y='<span class="empty"></span>'+y}else{y='<span class="line"></span>'+y}F=F.parent();w=F.children(".htis")}for(t=0;t<A.length;t++){s=A[t];B="hti"+(k++);D='<div class="htitem" id="'+B+'">'+y;D+='<span class="htis ';if(t==(A.length-1)){if(s.hasChild){D+="plusb"}else{D+="joinb"}}else{if(s.hasChild){D+="plus"}else{D+="join"}}if(s.hasChild){D+=" htinit"}D+='"></span>';if(this.ops.checkbox){var r=s.checkType||"0";D+='<span class="chk chkstat'+r+'" data-stat="'+r+'" data-val="'+s.tid+'" data-allowchktype="'+(s.allowCheckType||"0")+'"></span>'}else{D+='<input type="hidden" name="htitem" value="'+s.tid+'">'}s.img=s.img||(s.hasChild?"folder":"file");D+='<span class="'+s.img+'"></span>';D+='<a class="htia" href="'+s.href+'" target="'+this.ops.target+'" title="'+s.text+'">'+s.text+"</a></div>";z.push(D)}x.append(z.join(""));e("div>.htinit",x).click(function(J){var I=e(this);var K=I.parent();if(I.hasClass("htinit")){if(!I.hasClass("loading")){I.addClass("loading");E._crt(K,(I.hasClass("plus")?"plus":"plusb"))}}else{if(I.hasClass("plus")){K.children(".htitem").show();I.addClass("minus").removeClass("plus")}else{if(I.hasClass("plusb")){K.children(".htitem").show();I.addClass("minusb").removeClass("plusb")}else{if(I.hasClass("minus")){K.children(".htitem").hide();I.addClass("plus").removeClass("minus")}else{if(I.hasClass("minusb")){K.children(".htitem").hide();I.addClass("plusb").removeClass("minusb")}}}}var G=K.children(".folder");var H=K.children(".foldero");if(G){G.addClass("foldero").removeClass("folder")}if(H){H.addClass("folder").removeClass("foldero")}}return false});e("div>.htia",x).click(function(H){var G=e(this);if(E.$curSel){E.$curSel.removeClass("htias").addClass("htia")}E.$curSel=G;G.removeClass("htia").addClass("htias");if(E.ops.folderOpen){if(G.parent().children(".file").length<=0){G.parent().children(".htis").click();return false}}if(E.ops.onClick){return E.ops.onClick(E.getSelectedItem())}});if(this.ops.checkbox){var C=e("div>span.chk",x);if(this.ops.allowCheckType){C.click(function(){var H=e(this),M=H.attr("data-stat")==="2"?"0":"2",K=H.attr("data-allowchktype"),G=H.parent(),N,J,I=0;if((+M)<=(+K)){N=e("div>span.chk",G);H.removeClass().addClass("chk chkstat"+M).attr("data-stat",M);N.removeClass().addClass("chk chkstat"+M).attr("data-stat",M)}else{alert("当前节点选择后的状态不能大于最大权限状态");return false}G=G.parent();while(G.hasClass("htitem")){I=e("div>span.chkstat2",G).length;I?G.children("span.chk").removeClass().addClass("chk chkstat1").attr("data-stat","1"):G.children("span.chk").removeClass().addClass("chk chkstat0").attr("data-stat","0");G=G.parent()}})}else{C.click(a)}}this._crthe(x,v,z.length)};o.prototype.reLoad=function(v){if(v==this.ops.rtid){if(this.$root.children("span.loading").length>0){return}this.$root.empty();this._init()}else{var s=e("input[value='"+v+"']",this.$root);var t=s.parent();var u=t.children(".htis");if(u.hasClass("loading")){return}t.children(".htitem").remove();if(u.hasClass("minus")){u.removeClass("minus").addClass("plus")}else{if(u.hasClass("minusb")){u.removeClass("minusb").addClass("plusb")}}var r=t.children("span.foldero");if(r.length>0){r.removeClass("foldero").addClass("folder")}u.addClass("htinit").click()}};o.prototype.getSelectedItem=function(){if(this.$curSel){var t=this.$curSel.parent();var s=true;var r=t.children(".htis");if(r.hasClass("joinb")||r.hasClass("join")){s=false}return{id:t.attr("id"),text:this.$curSel.text(),tid:t.children("input").val(),hasChild:s,href:this.$curSel.attr("href")}}return{}};o.prototype.getCheckList=function(){var r=[];e("span.chkstat1,span.chkstat2",this.$root).each(function(){var s=e(this);r.push({id:s.attr("data-val"),checktype:s.attr("data-stat")})});return r};o.prototype.getCheckParamStr=function(r){var s=[];e("input:checked",this.$elem).each(function(t){s.push(r+"["+t+"].id="+e(this).val());s.push(r+"["+t+"].checktype="+(this.indeterminate?"1":"2"))});return s.join("&")};function a(){var u=e(this),x=u.attr("data-stat")==="2"?(u.removeClass().addClass("chk chkstat0").attr("data-stat","0"),"0"):(u.removeClass().addClass("chk chkstat2").attr("data-stat","2"),"2"),s=u.parent(),y=e("div>span.chk",s).removeClass().addClass("chk chkstat"+x).attr("data-stat",x),s=s.parent(),t,w,r,v;while(s.hasClass("htitem")){r=e("div>span.chk",s).length;t=e("div>span.chkstat1",s).length;w=e("div>span.chkstat2",s).length;v=s.children("span.chk");if(t||(w&&w<r)){v.removeClass().addClass("chk chkstat1").attr("data-stat","1")}else{w?v.removeClass().addClass("chk chkstat2").attr("data-stat","2"):v.removeClass().addClass("chk chkstat0").attr("data-stat","0")}s=s.parent()}}function f(){var t=this.ops.height,s=this.minHeight,v=this.$root,r=v.parent(),u=this;if(e.trim(String(t)).toLowerCase()==="auto"){this.resize=h(v,r);this.resize();e(window).resize(function(){u.resize()})}else{if(/^\d+px$/i.test(t)){(t=parseInt(t,10))<s&&(t=s);v.height(t)}}}function h(s,r){return function(){s.height(r.height())}}function c(r){return e(n.format('input[value="{0}"]',r),this.$root).parent().parent()}function l(u){var r=c.call(this,u),t,v,s;if(!r.length||r[0]===this.$root[0]){return null}t=r.children(".htis");v=r.children("input");s=r.children("a");return{id:r.attr("id"),text:s.text(),tid:v.val(),href:s.attr("href"),hasChild:!(t.hasClass("join")||t.hasClass("joinb"))}}o.prototype.getParentItem=l;e.TreeView=function(r,u){var t=e(r),v=t[0],s;if(!v){throw new Error("页面上没有对应id的元素存在, 请检查")}if(e.isNumeric(u)){if(u>=0&&u<i){return e.data(v,p(u))}return null}s=new o(t,u);s._init();e.data(v,p(),s);return s}})(jQuery);(function(f){var D=0;var n=["tr_odd","tr_evn"];L=f.Lang,SH=f.StringHelper,NH=f.NumberHelper,DU=f.DateUtil,COL_TYPE_CONF={checkbox:x,date:w,number:c,money:p,ptz:t,bar:a,toolbar:h,string:B};function g(G,E){for(var F=0;F<G.length;F++){if(G[F]==E){G.splice(F,1);return true}}return false}function u(G,E){for(var F=0;F<G.length;F++){if(G[F]==E){return F}}return G.push(E)}function i(G,E){for(var F=0;F<G.length;F++){if(G[F]==E){return true}}return false}function d(G,F){var E=(F=="p"?"m":"p");G.attr("tfld",F=="p"?"1":"2");G.find(".hgv-ti-"+E).removeClass("hgv-ti-"+E).addClass("hgv-ti-"+F)}function A(F,E){return f.isArray(E)?(F._di<0?"":(F._di<E.length?E[F._di]:"")):(F.name?E[F.name]:"")}function l(G,F,H,E,I){if(f.isFunction(G)){return G(F,H,A(H,E),E,I)}return G}function e(M,K,F,H,G){var J=M.render,I,E="";if(M.type){if(M.type=="VARCHAR2"){J="string"}else{if(M.type=="DATE"){J="date"}else{if(M.type=="NUMBER"){J="number"}else{J=M.type}}}}if(M.icon){E='<span class="hgv-cd-icon-span';if(f.isFunction(M.icon)){E+=" icon_"+M.icon(F,H,A(M,K),K,M)}else{E+=" icon_"+M.icon}E+='">&nbsp;</span>'}if(L.isString(J)){I=J}else{if(f.isFunction(J)){return E+J(F,H,A(M,K),K,M)}f.isPlainObject(J)?(I=L.isString(J.type)?J.type:"string"):(I="string")}return E+COL_TYPE_CONF[I].call(null,M,K,F,H,G)}function b(F,E){if(F.sumRender&&f.isFunction(F.sumRender)){return F.sumRender.call(F,E)}if(E){return E}return"&nbsp;"}function B(I,H){var G=A(I,H),F=I.render,E;if(f.isArray(I.values)){E=I.values}else{if(F){if(f.isArray(F.values)){E=F.values}if(f.isArray(F)){E=F}}}if(G!=null){if(E){G=SH.val2label(G,E)}else{G=G.toString()}}G==null&&(G="");return G}function c(M,K){var J=B(M,K),H=M.render||{},E=H.mask||M.mask,G=H.split||M.split;if(!E){var I=M.precision||M.scale;if(f.isNumeric(I)){E="#.";for(var F=0;F<I;F++){E+="0"}}}ret=NH.format(J,E,G);return ret===""?J:ret}function p(H,G){var F=B(H,G),E=NH.format(F,".00");return E===""?F:E}function w(M,K){var J=B(M,K),I=(f.GLOBALCONFIG?f.GLOBALCONFIG.dateformat:"yyyy-MM-dd HH:mi:ss"),H=M.render||{},E=(H.mask||M.mask)||I,G=DU.toDate(J,I,true),F=DU.format(G,E);return F||J}function x(K,I){var H=B(K,I),F=K.render||{},J=K.on||F.on,G=K.off||F.off,E="0";if(H==J){E="2"}else{if(H==G){E="0"}}return SH.format('<span class="hgv-cell-chk hgv-cell-chk{0}"></span>',E)}function t(P,N,Q,R){var H=f.isFunction(P.render.customValFn)?P.render.customValFn(Q,R,A(P,N),N,P):B(P,N),I="<div>{0}</div>",E='<div class="sepcial">{0}</div>',G,F,M=[],O,J,K;if(!/^[-+]?(?:(\d*)\.|)(\d+)$/.test(H=f.trim(String(H)))){return""}if(H.indexOf(".")>=0){G=RegExp["$1"];F=SH.rPad(RegExp["$2"].substr(0,2),2,"0")}else{G=RegExp["$2"];F="00"}M.push(SH.format(E,F.charAt(1)));M.push(SH.format(E,F.charAt(0)));O=G.split("");K=O.length;for(J=K-1;J>=0;J--){M.push(SH.format(I,O[J]))}H.charAt(0)==="-"&&M.push(SH.format(I,"-"));return M.join("")}function a(O,N,Q,S){var E=O.render||{};var H=O.customValFn||E.customValFn;var F=f.isFunction(H)?H(Q,S,A(O,N),N,O):B(O,N);var M=parseFloat(F)*100;var K=(E.precision||O.precision)||2;var R=""+M.toPrecision(K+((""+parseInt(M)).length-2));var P=(E.barbgcolor||O.barbgcolor)||"#ff9";var I=(E.barcolor||O.barcolor)||"#0f0";var G=(E.txtcolor||O.txtcolor)||"#000";var J=R>100?100:R;return SH.format('<div class="hgv-cell-bar" style="background-color:{0}"><div class="hgv-cell-bardiv" style="width:{1}%;background-color:{2};"></div><div class="hgv-cell-bar-txt" style="color:{3};">{4}%</div></div>',P,J,I,G,R)}function h(K,I,E,H,F){if(!f.ToolBar){throw new Error("按钮列需要toolbar.js支持")}if(!K.toolbar){throw new Error("按钮列需要定义toolbar对象")}var J=K.toolbar;if(J.ops._type!=2){throw new Error("定义grid行上的ToolBar必须是:$.ToolBar('',ops)类型")}J.uid=F.gid+"_tb_"+E+"_"+H;var G=J.getHtml();return J.getHtml()}function y(E){if(E.nodata||E.type=="toolbar"||E.type=="buttons"||E.type=="button"){return false}return true}function k(K,J){var G;var I=0;var E=false;for(var H=0;H<K.length;H++){G=K[H];G._di=-1;if(J&&G.name){for(var F=0;F<J.length;F++){if(J[F].name){if(G.name.compareNoCase(J[F].name)){G._di=F;break}}}}else{if(y(G)){G._di=I;I++}}if(G._di!=-1){E=true}}if(!E){I=0;for(var H=0;H<K.length;H++){G=K[H];if(y(G)){G._di=I;I++}}}}function C(H,G,F){if(H.length>0&&(G.length<1||F)){if(F&&G.length>1){G=[]}F=true;for(var I=0;I<H.length;I++){var E=H[I];if(!E.name||E.name.charAt(E.name.length-1)=="_"){E.hide=true}if(E.length>0){E.width=E.length>50?400:(E.length*8)}if(E.type=="DATE"){E.align="center"}else{if(E.type=="NUMBER"){E.align="right"}}G.push(E)}}}function z(E){if(E.width){if(typeof E.width=="number"){return E.width}return parseInt(E.width)}return 100}function q(M,G){var J={};var E=G.meta;var F,I=G.ops.columns;if(M){if(!E){E=[];for(var H=0;H<I.length;H++){F=I[H];if(F._di>=0){E[F._di]=F}}}if(E.length&&f.isArray(M)){for(var K=0;K<M.length;K++){J[E[K].name]=M[K]}return J}}return M}function o(E){if(typeof E.ops.editor=="string"){if("dbclick"==E.ops.editor){return"d"}return"c"}else{if(f.isPlainObject(E.ops.editor)){if("dbclick"==E.ops.editor.event){return"d"}return"c"}else{if(E.ops.editor){return"c"}}}return false}function v(R){var K=[];var S=false;var Q=[];var N=R.ops.columns;var E,T,M,P=R.gid+"_edit";K.push('<div id="'+P+'" class="hgv-editor-wrap">');for(var J=0;J<N.length;J++){E=N[J];M=E.type||"text";if(E.name&&E.editor&&!E.hide&&M!="toolbar"&&M!="hidden"){T={id:P+"_"+E.name,name:E.name,type:M};if(T.type=="bar"){T.type="number"}if(E.render&&f.isArray(E.render)){T.type="list";T.values=E.render}if(f.isPlainObject(E.editor)){T=f.extend(T,E.editor)}if(E.align&&!T.itemAlign){T.itemAlign=E.align}if(E.mask&&!T.mask){T.mask=E.mask}Q.push(T);S="";if(T.type=="checkbox"){S='<input type="checkbox" name="'+T.name+'" id="'+T.id+'" class="hgv-edit-checkbox" value="'+(T.on||"1")+'" data-readonly="0"/>'}else{if(T.type=="list"){S='<select name="'+T.name+'" id="'+T.id+'" class="hgv-edit-select"></select>'}else{if(T.type=="textarea"){S='<textarea name="'+T.name+'" id="'+T.id+'" class="hgv-edit-textarea"></textarea>'}else{S='<input name="'+T.name+'" id="'+T.id+'" type="text" class="hgv-edit-input';if(T.type=="number"){S+=" cnum"}else{if(T.type=="date"){S+=" cdate"}}if(T.itemAlign){S+='" style="text-align:'+T.itemAlign+";"}S+='"/>'}}}if(S.length){K.push(S)}}}if(S){K.push("</div>");var O=f("#"+P);if(O.length>0){O.remove()}R.$elem.append(K.join(""));var H=f("#"+P);var G=f._gvef(H,{id:P,items:Q});for(var U=0;U<Q.length;U++){var I=Q[U];if(I.type=="list"){if(f.isArray(I.values)){G.setListData(I.name,I.values)}}var F=G.getItem(I.name);if(F.length){F.on("click",function(W){var V=f(this);if(V.attr("type")=="checkbox"){V.change()}W.stopPropagation()}).on("change",function(ac){var ag=f(this);var Z=ag.attr("name");var Y=G.getVal(Z);var W=ag.parent();var aa=W.parent();var ah=R._getridxfrom$tr(aa);var ae=R.rows[ah];var ad=parseInt(W.attr("cidx"));var X=N[ad];var ab=A(X,ae);if(ab!=Y){if(R.ops.OnCellChange){var V=R.ops.OnCellChange(ad,ah,ab,Y);if(V!=undefined&&!V){G.setVal(Z,ab);return false}}if(f.isArray(ae)){if(X._di>-1){ae[X._di]=Y}}else{ae[X.name]=Y}var af=W.find(".hgv-cd");if(W.hasClass("hgv-tc")){af=af.find(".hgv-ti-t")}af.empty().append(e(X,ae,ah,ad,R));W.addClass("hgv-tchanged")}})}}H.data("$fv",G);if(!R.ops.editor){R.ops.editor=true}}}function r(H,G){var E=typeof H;var F=typeof G;if(E=="string"&&F=="string"){if(H.localeCompare){return H.localeCompare(G)}}return H>G?1:(H==G?0:-1)}var s=function(H,J){this.$elem=f(H);this.ops=f.extend({action:false,actionType:"server",viewMode:false,pageSize:20,noDataTip:"无数据",singleSelect:true,showRownum:true,fixedColumn:1,mutliRowHead:false,addBlankRow:true,sortType:"client",columns:[]},J);if(this.ops.multiSelect){this.ops.singleSelect=false}this._treeChk=false;if(f.isFunction(this.ops.onSelectedRow)){this.ops.OnSelectedRow=this.ops.onSelectedRow}if(f.isFunction(this.ops.onHeadChkClick)){this.ops.OnHeadChkClick=this.ops.onHeadChkClick}if(f.isFunction(this.ops.onQueryComplete)){this.ops.OnQueryComplete=this.ops.onQueryComplete}if(f.isFunction(this.ops.onQueryEnd)){this.ops.OnQueryEnd=this.ops.onQueryEnd}if(this.ops.id){this.gid=this.ops.id}else{D+=1;this.gid="hgv"+D}this.rows=[];this.page=1;this.total=0;this.sums=false;this.meta=false;this.selected=[];this._cri=-1;this._chkcol="_check";this._sortCols=[];this._params={};this._parseSortCols();this._colsfrommeta=false;var G=[];G.push('<div class="hgv" id="'+this.gid+'">');if(this.ops.singleSelect){G.push('<input type="text" id="'+this.gid+'_focus" class="hgv-input-focus"/>')}G.push('<div id="'+this.gid+'loading" class="hgv-loading"></div><div id="'+this.gid+'loading_img" class="hgv-loadimg"></div>');if(this.ops.title){G.push('<div class="hgv-t" id="'+this.gid+'_t"><span class="hgv-ti">&nbsp;</span><span class="hgv-tt">');G.push(this.ops.title);G.push("</span></div>")}if(this.ops.toolbar){if(this.ops.toolbar._isButtons){this.ops.toolbar={head:this.ops.toolbar}}if(this.ops.toolbar.head){G.push('<div class="hgv-tb" id="'+this.gid+'_tb"></div>')}}if(this.ops.pageSize>0){G.push('<div class="hgv-page-div" id="'+this.gid+'_pdiv">');G.push('<div class="hgv-page-ndiv"  id="'+this.gid+'_pndiv"><a class="hgv-page-prev">&lt;上一页</a><a class="hgv-page-first" title="第一页">1</a>');G.push('<span class="hgv-page-s1">...</span><a class="hgv-page-num"></a><a class="hgv-page-num"></a><a class="hgv-page-num"></a>');G.push('<a class="hgv-page-num"></a><a class="hgv-page-num"></a><span class="hgv-page-s2">...</span>');G.push('<a class="hgv-page-last" title="最后一页"></a><a class="hgv-page-next">下一页&gt;</a>');G.push('<span class="hgv-page-s3"></span><span class="hgv-page-s4">&nbsp;&nbsp&nbsp;到第</span><input class="hgv-page-goinput"/><span class="hgv-page-s5">页</span>');G.push('<span class="hgv-page-s6"></span><span class="hgv-page-s7"></span></div></div>')}G.push("</div>");this.$elem.append(G.join(""));var E=f("#hgv_dragsplit");if(E.length<1){f("body").append('<div id="hgv_dragsplit" ></div>')}if(this.ops.toolbar){if(this.ops.toolbar.title){if(this.ops.toolbar.title.renderTo){this.ops.toolbar.title.renderTo(f("#"+this.gid+"_t"))}}if(this.ops.toolbar.head){if(this.ops.toolbar.head.renderTo){this.ops.toolbar.head.renderTo(f("#"+this.gid+"_tb"))}}if(this.ops.toolbar.foot){if(this.ops.toolbar.foot.renderTo){this.ops.toolbar.foot.renderTo(f("#"+this.gid+"_pdiv"))}}}var F=this;var I=f("#"+this.gid+"_pndiv");I.on("click","a",function(N){var M=f(this);var K=0;if(M.hasClass("hgv-page-prev")){K=F.page-1;if(K<1){return false}}else{if(M.hasClass("hgv-page-next")){K=F.page+1;if(K>F.pageCount){return false}}else{K=parseInt(M.html());if(K<1||K>F.pageCount){return false}}}F._gotopage(K)});f(".hgv-page-goinput",I).on("keydown",function(M){if(M.keyCode==13){var K=f(this);var N=parseInt(K.val());if(N>0&&N<=F.pageCount){F._gotopage(N)}K.val("");return false}});f("#"+this.gid).on("mousedown",".hgv-col-mspan",function(S){var K=this;var P=S.clientX;var T=f(this);var U=T.parent();var V=U.width();var R=parseInt(T.attr("mcol-idx"));var M=T.attr("data-div");var O=T.attr("data-cidx");if(this.setCapture){this.setCapture()}function N(W){var X=W.clientX;f("#hgv_dragsplit").css({left:X+"px"}).show();return false}function Q(X){var W=X.clientX-P+V;f("#hgv_dragsplit").hide();F._loading(true);window.setTimeout(function(){f(document).unbind("mousemove",N);f(document).unbind("mouseup",Q);if(K.setCapture){K.releaseCapture()}if(W<16){W=16}F.ops.columns[O].width=W;F.ops.columns[O].widthx=W;var aa=M=="m"?f("#"+F.gid+"_mth"+O):[];if(W<V){U.width(W);U.parent().width(W);if(aa.length>0){aa.width(W);aa.parent().width(W)}}else{if(aa.length>0){aa.parent().width(W);aa.width(W)}U.parent().width(W);U.width(W)}var ab=f("tbody>tr",f("#"+F.gid+"_"+M+"div_tab"));var Z=M=="f"?false:f("#"+F.gid+"_foot_tdiv_tab");var Y=M=="m"?false:f("#"+F.gid+"_fth_"+O);if(W<V){ab.each(function(ac){f(this).find(".hgv-cd:eq("+R+")").width(W-8);f(this).find((M=="f"?".hgv-fcol-td":".hgv-mcol-td")+":eq("+R+")").width(W)});if(Y.length>0){f("div",Y).width(W-8);Y.width(W)}if(Z.length>0){f(".hgv-cd:eq("+R+")",Z).width(W-8);f("th:eq("+R+")",Z).width(W)}}else{ab.each(function(ac){f(this).find((M=="f"?".hgv-fcol-td":".hgv-mcol-td")+":eq("+R+")").width(W);f(this).find(".hgv-cd:eq("+R+")").width(W-8)});if(Y.length>0){Y.width(W);f("div",Y).width(W-8)}if(Z.length>0){f("th:eq("+R+")",Z).width(W);f(".hgv-cd:eq("+R+")",Z).width(W-8)}}if(M=="f"){f("#"+F.gid+"_fdiv").width(f("#"+F.gid+"_fdiv_tab").width())}f("#"+F.gid).css("-moz-user-select","-moz-all").css("-webkit-user-select","text");F._resize();F._loading(false);f("#hgv_dragsplit").hide()},100)}f("#"+F.gid).css("-moz-user-select","none").css("-webkit-user-select","none");f(document).bind("mousemove",N);f(document).bind("mouseup",Q)});f("#"+this.gid+"_focus").on("keydown",function(M){if(F._tmap){return false}if(M.which==13||M.which==9){if(f.isFunction(F.ops.OnKeyEnter)){F.ops.OnKeyEnter(F)}return false}if(M.which!=40&&M.which!=38){return false}var N=F.getSelectedRow();var K=N+(M.which==40?1:-1);if(K>=0&&K<F.rows.length){F.selectRow(N,false);F.selectRow(K,true)}});this._init();this.reset()};var m={_init:function(){this._tmap=false;this._treeChk=false;this._chkcol="_check";if(this.ops.viewMode&&!this.ops.singleSelect){this._treeChk=true}var F=f("#"+this.gid);var I="";var H=[];var E=[];var K=this.ops.columns;if(this.meta&&f.isArray(this.meta)&&this.page==1){C(this.meta,K,this._colsfrommeta)}if(this.rows.length&&f.isArray(this.rows[0])&&K[K.length-1].name=="_check"){this._chkcol=this.rows[0].length-1}if(f.isFunction(this.ops.OnIniting)){this.ops.OnIniting(this.rows,this.ops)}k(K,this.meta);H.push('<table class="hgv-wt" id="'+this.gid+'_wt" cellspacing="0" cellpadding="0"><thead class="hgv-wt-thd">');H.push(this._crthead());H.push('</thead><tbody class="hgv-wt-tbd"><tr class="hgv-wt-thd-tr2">');if(this._tv_fixedcc>0){H.push('<td class="hgv-wt-tbd-ftd" colspan="'+this._tv_fixedcc+'"><div class="hgv-fdiv" id="'+this.gid+'_fdiv">');H.push('<table class="hgv-fcol-dtab" id="'+this.gid+'_fdiv_tab" cellspacing="0" cellpadding="0"><tbody></tbody></table></div></td>')}H.push('<td class="hgv-wt-tbd-mtd"><div class="hgv-mdiv" id="'+this.gid+'_mdiv">');H.push('<table class="hgv-mcol-dtab" id="'+this.gid+'_mdiv_tab" cellspacing="0" cellpadding="0" ><tbody></tbody></table></div></td>');H.push("</tr></tbody>");if(this.sums){H.push(this._crtfooter())}H.push("</table>");f("#"+this.gid+"_wt").remove();F.append(H.join(""));v(this);this._resize();var J=f("#"+this.gid+"_fdiv");var M=f("#"+this.gid+"_mdiv");var G=this;f(window).bind("resize",function(){G._resize()});M.bind("scroll",function(){f("#"+G.gid+"_fdiv_tab").css("top","-"+this.scrollTop+"px");f("#"+G.gid+"_tdiv_tab").css("left","-"+this.scrollLeft+"px");f("#"+G.gid+"_foot_tdiv_tab").css("left","-"+this.scrollLeft+"px")});J.on("click",".hgv-chk-td",function(P){var O=f(this);var N=O.parent();if(N.hasClass("tr_dr")){return false}G._clkselrow(N,true,true);return false});J.on("click",".hgv-ti-c",function(P){var O=f(this);var N=O.parent().parent().parent();if(N.hasClass("tr_dr")){return false}G._clkselrow(N,true,true);return false});J.on("click","tr",function(O){var N=f(this);if(N.hasClass("tr_dr")){return false}if(G._isBlkTr(N)){G.focus();return false}G._clkselrow(N,true);if(!G.ops.editor){G.focus()}});M.on("click","tr",function(O){var N=f(this);if(N.hasClass("tr_dr")){return false}if(G._isBlkTr(N)){G.focus();return false}G._clkselrow(N,false);if(!G.ops.editor){G.focus()}return false});J.on("click",".cbtna",function(N){G._clktoolbar(this,N);return false});M.on("click",".cbtna",function(N){G._clktoolbar(this,N);return false});J.on("click",".hgv-fcol-td",function(Q){var P=f(this);if(P.parent().hasClass("tr_dr")){return false}if(G._isBlkTr(P.parent())){return false}var N=G._getcellfrom$td(P);if(f.isFunction(G.ops.OnClickCell)){var O=G.ops.OnClickCell(N._col,N._row,Q);if(O!=undefined&&!O){return false}}if(o(G)=="c"){G.editRow(N._row,N._col)}});M.on("click",".hgv-mcol-td",function(Q){var P=f(this);if(P.parent().hasClass("tr_dr")){return false}if(G._isBlkTr(P.parent())){return false}var N=G._getcellfrom$td(P);if(f.isFunction(G.ops.OnClickCell)){var O=G.ops.OnClickCell(N._col,N._row,Q);if(O!=undefined&&!O){return false}}if(o(G)=="c"){G.editRow(N._row,N._col)}});J.on("contextmenu",".hgv-fcol-td",function(P){var O=f(this);if(O.parent().hasClass("tr_dr")){return false}var N=G._getcellfrom$td(O);if(f.isFunction(G.ops.OnContextMenu)){G.ops.OnContextMenu(N._col,N._row,P);return false}});M.on("contextmenu",".hgv-mcol-td",function(P){var O=f(this);if(O.parent().hasClass("tr_dr")){return false}var N=G._getcellfrom$td(O);if(f.isFunction(G.ops.OnContextMenu)){G.ops.OnContextMenu(N._col,N._row,P);return false}});J.on("dblclick",".hgv-fcol-td",function(P){var O=f(this);if(O.parent().hasClass("tr_dr")){return false}if(G._isBlkTr(O.parent())){return false}var N=G._getcellfrom$td(O);if(f.isFunction(G.ops.OnDoubleClickCell)){G.ops.OnDoubleClickCell(N._col,N._row);return false}else{if(f.isFunction(G.ops.onRowDblClick)){G.ops.onRowDblClick(N._row)}}if(o(G)=="d"){G.editRow(N._row,N._col)}});M.on("dblclick",".hgv-mcol-td",function(P){var O=f(this);if(O.parent().hasClass("tr_dr")){return false}if(G._isBlkTr(O.parent())){return false}var N=G._getcellfrom$td(O);if(f.isFunction(G.ops.OnDoubleClickCell)){G.ops.OnDoubleClickCell(N._col,N._row);return false}else{if(f.isFunction(G.ops.onRowDblClick)){G.ops.onRowDblClick(N._row)}}if(o(G)=="d"){G.editRow(N._row,N._col)}});J.on("click",".hgv-ti-p",function(P){var Q=f(this).parent().parent();var O=Q.parent();var N=G._getcellfrom$td(Q);if(f.isFunction(G.ops.OnClickButton)){if(!G.ops.OnClickButton(N._col,N._row,"+")){return false}}G._showchilds(O,true,false);d(O,"m");G._resize();return false});J.on("click",".hgv-ti-m",function(P){var Q=f(this).parent().parent();var O=Q.parent();var N=G._getcellfrom$td(Q);if(f.isFunction(G.ops.OnClickButton)){if(!G.ops.OnClickButton(N._col,N._row,"-")){return false}}G._hidechilds(O,false);d(O,"p");G._resize();return false});J.mousewheel(function(N,P){var O=f("#"+G.gid+"_mdiv");O.scrollTop(O.scrollTop()-P*40)});f("#"+this.gid+"_chk").on("click",function(){var O=f(this);var N="all";if(O.hasClass("chk-all")){N="none"}else{if(O.hasClass("chk-half")){N="half"}}G._selrow(N);if(f.isFunction(G.ops.OnHeadChkClick)){G.ops.OnHeadChkClick(N)}return false}).on("dblclick",function(){var N=f(this);if(N.hasClass("chk-half")){G._selrow("all")}return false}).on("selectstart",function(){return false});f(".hgv-col-mspan",F).on("click",function(N){return false});f(".hgv-sort-col",F).hover(function(){f(".hgv-col-sortspan",f(this)).addClass("hgv-col-sortspan-hover")},function(){f(".hgv-col-sortspan",f(this)).removeClass("hgv-col-sortspan-hover")}).on("click",function(T){var Q=G.ops.sortType=="client"?true:false;var P=f(".hgv-col-sortspan",f(this));var O=parseInt(P.attr("data-sortc"));var S=G.ops.columns[O];var N="n";var R=G._getSortCol(O,S);if(R<0){return false}if(Q||!T.ctrlKey){G._clearOthersSortCols(R)}var U=G._sortCols[R];if(U.n==-1){U.n=1}else{if(U.n==1){if(U.s=="desc"){U.s="asc"}else{U.s="desc"}U.n=2}else{if(U.n==2){U.n=-1}}}U.x=G._getSortColMaxX(R)+1;if(Q){if(U.n==-1){U.n=1;if(U.s=="desc"){U.s="asc"}else{U.s="desc"}}G._loading(true);setTimeout(function(){G.refesh();G._loading(false)},100)}else{G.query(G._lqp||{})}})},_parseSortCols:function(){var F=false,K;var E=this.ops.sortType=="client"?true:false;this._sortCols=[];if(f.isPlainObject(this.ops.queryParams)){if(this.ops.queryParams.orderby){F=this.ops.queryParams.orderby.toLowerCase()}}if(L.isString(F)){K=F.split(",");for(var H=0;H<K.length;H++){var M=f.trim(K[H]);var I=M.split(" ");var G={s:"asc",n:1,x:1};G.c=I[0];if(I.length>1){if(I[1]=="desc"){G.s="desc"}}this._sortCols.push(G)}}for(var H=0;H<this.ops.columns.length;H++){var J=this.ops.columns[H];if(E&&J.sort==undefined){J.sort=true}if(J.sort){if(this._getSortCol(H,J)<0){this._sortCols.push({c:(J.name||J.i),s:"asc",n:-1,x:1})}}}},_getSortCol:function(G,E){var H=this._sortCols;for(var F=0;F<H.length;F++){var I=H[F];if(E.name){if(E.name==I.c){return F}}else{if(I.c==G){return F}}}return -1},_getSortColMaxX:function(F){var H=this._sortCols;var E=0;for(var G=0;G<H.length;G++){var I=H[G];if(G!=F&&I.n!=-1&&E<I.x){E=I.x}}return E},_clearOthersSortCols:function(E){var G=this._sortCols;for(var F=0;F<G.length;F++){var H=G[F];if(F!=E){H.n=-1;H.x=0}}},_getOrderBy:function(){var G=[];var F=this._sortCols;F.sort(function(I,H){return I.x-H.x});for(var E=0;E<F.length;E++){if(F[E].n!=-1){G.push(F[E].c+" "+F[E].s)}}if(G.length<1){if(f.isPlainObject(this.ops.queryParams)){if(this.ops.queryParams.orderby){this._parseSortCols();return this.ops.queryParams.orderby}}}return G.join(",")},_crthead:function(){var W=[];var R=[];var M;var aa=this.ops.fixedColumn<0?0:this.ops.fixedColumn;var Q=this.ops.columns;var T=Q.length;var N=0;var J=0;var V=0;var K=1;var Y=false;function I(ad,ah){for(var ae=0;ae<K;ae++){var ag=Y[ae];for(var af=0;af<ag.length;af++){if(ag[af].col){if(ad==ag[af].col){ag[af].thstr=ah;return true}}}}return false}function X(ad){for(var ae=0;ae<K;ae++){var ag=Y[ae];for(var af=0;af<ag.length;af++){if(ag[af].col){if(ad==ag[af].col){return K-ae}}}}return 1}if(this.ops.headRows){Y=this.ops.headRows;if(Y.length<2){Y=false}}K=Y?Y.length:1;this._tv_fixedcc=0;this._tv_fixedci=0;W.push("<tr>");if(this.ops.showRownum){W.push('<th class="hgv-num-th"><div>&nbsp;</div></th>');this._tv_fixedcc++}if(!this.ops.singleSelect&&!this._treeChk){W.push('<th class="hgv-chk-th"><div id="'+this.gid+'_chk">&nbsp;</div></th>');this._tv_fixedcc++}while(N<T&&V<aa){M=Q[N];if(M.hide){N++;continue}M.widthx=z(M);W.push('<th class="hgv-fcol-th" style="width:'+M.widthx+"px;height:"+(K*28+2)+'px;"><div class="hgv-cd');if(M.sort){W.push(" hgv-sort-col")}W.push('"  style="width:'+M.widthx+'px;margin:0;">');W.push(M.title);if(M.sort){W.push('<span class="hgv-col-sortspan');var ac=this._getSortCol(N,M);if(ac>-1){var O=this._sortCols[ac];if(O.n!=-1){W.push(" hgv-col-sort-"+this._sortCols[ac].s)}}W.push('" data-sortc="'+N+'"></span>')}W.push('<span class="hgv-col-mspan" mcol-idx="'+V+'" data-div="f" data-cidx="'+N+'"></span>');W.push("</div></th>");this._tv_fixedcc++;V++;N++}this._tv_fixedci=N;var S=[];for(var U=N;U<T;U++){var ab=[];M=Q[U];if(M.hide){continue}M.widthx=z(M);var H=1;if(Y){H=X(M.name);S.push('<th class="hgv-mcol-th-h" style="width:'+M.widthx+'px;"><div class="hgv-mcol-th-h-div" style="width:'+M.widthx+'" id="'+this.gid+"_mth"+U+'">&nbsp;</div></th>')}ab.push('<th class="hgv-mcol-th" style="width:'+M.widthx+'px;" '+(H>1?('rowspan="'+H+'"'):"")+">");ab.push('<div class="hgv-cd');if(M.sort){ab.push(" hgv-sort-col")}ab.push('" style="width:'+M.widthx+'px;margin:0;">');if(M.sort){ab.push('<span class="hgv-col-sortspan');var ac=this._getSortCol(N,M);if(ac>-1){var O=this._sortCols[ac];if(O.n!=-1){ab.push(" hgv-col-sort-"+this._sortCols[ac].s)}}ab.push('" data-sortc="'+U+'"></span>')}ab.push(M.title+'<span class="hgv-col-mspan" mcol-idx="'+J+'" data-div="m" data-cidx="'+U+'"></span></div></th>');if(Y){if(!I(M.name,ab.join(""))){alert("表格多行表头定义有错")}}else{R.push(ab.join(""))}J++}if(Y){R.push('<tr class="hgv-mcol-tr-h">'+S.join("")+'<th><div class="hgv-mcol-th-h-div">&nbsp;</div></th></tr>');for(var P=0;P<K;P++){var F=Y[P];var G=0;R.push('<tr class="hgv-wt-thd-tr1">');for(var Z=0;Z<F.length;Z++){var E=F[Z];if(E.title){if(!E.colspan){E.colspan=1}R.push('<th class="hgv-mcol-th-t"'+(E.colspan>1?(' colspan="'+E.colspan+'"'):"")+(E.rowspan?(' rowspan="'+E.rowspan+'"'):"")+'><div class="hgv-cd">'+E.title+"</div></th>");G+=E.colspan}else{if(E.thstr){R.push(E.thstr);G+=1}}}if(P==0){R.push('<th class="hgv-mcol-th-l" '+(K>1?('rowspan="'+K+'"'):"")+">&nbsp;</th>")}R.push("</tr>")}}else{R.push('<th class="hgv-mcol-th-l" '+(K>1?('rowspan="'+K+'"'):"")+">&nbsp;</th>")}W.push('<th class="hgv-mcol-tth" '+(K>1?('rowspan="'+K+'"'):"")+">");W.push('<div class="hgv-mcol-tdiv" id="'+this.gid+'_tdiv">');W.push('<table class="hgv-mcol-ttab" id="'+this.gid+'_tdiv_tab" cellspacing="0" cellpadding="0" ><thead>');W.push(R.join(""));W.push("</thead></table></div></th>");W.push("</tr>");return W.join("")},_crtfooter:function(){var G=[];var H;var N=this.ops.fixedColumn<0?0:this.ops.fixedColumn;var K=this.ops.columns;var M=K.length;var F=0;var E=0;var J=0;var O=0;this._tv_fixedcc=0;this._tv_fixedci=0;if(this.ops.showRownum){E++}if(!this.ops.singleSelect&&!this._treeChk){E++}G.push("<tfoot><tr>");if(E>0){G.push('<th title="合计栏" class="hgv-foot-hj-th');if(E>1){G.push('" colspan="'+E+'"><div class="hgv-cd">合&nbsp;计</div>')}else{G.push(' hgv-foot-hj-icon">&nbsp;')}G.push("</th>")}while(F<M&&J<N){H=K[F++];if(H.hide){continue}H.widthx=z(H);G.push('<th class="hgv-foot-fcol-th" style="width:'+H.widthx+'px;" id="'+this.gid+"_fth_"+O+'">');G.push('<div class="hgv-cd"  style="width:'+(H.widthx-8)+"px;");if(H.align){G.push("text-align:"+H.align+";")}G.push('">'+b(H,this.sums[H.name])+"</div></th>");this._tv_fixedcc++;J++;O++}this._tv_fixedci=F;G.push('<th class="hgv-foot-mcol-tth"><div class="hgv-foot-mcol-tdiv" id="'+this.gid+'_foot_tdiv"><table class="hgv-foot-mcol-ttab" id="'+this.gid+'_foot_tdiv_tab" cellspacing="0" cellpadding="0" ><thead><tr>');for(var I=F;I<M;I++){H=K[I];if(H.hide){continue}H.widthx=z(H);G.push('<th class="hgv-foot-mcol-th" style="width:'+H.widthx+'px;">');G.push('<div class="hgv-cd"  style="width:'+(H.widthx-8)+"px;");if(H.align){G.push("text-align:"+H.align+";")}G.push('">'+b(H,this.sums[H.name])+"</div></th>")}G.push('<th class="hgv-foot-mcol-th-l">&nbsp;</th></tr></thead></table></div></th></tr></tfoot>');return G.join("")},_crtTrMap:function(){var J=this.rows.length;var V=this.ops.viewMode;var N=V.tree[0];var I=V.tree[1];var K,S,G,W,U,H;var M=[];this._tmap=[];var E=function(aa,X){var Y,Z;for(var ab=0;ab<X.length;ab++){Y=X[ab];if(Y.id==aa){return Y}if(Y.c.length>0){Z=E(aa,Y.c);if(Z){return Z}}}return false};var R=function(Y,aa){var X,Z;for(var ab=0;ab<Y.length;ab++){X=Y[ab];if(X.id==aa){return X}if(X.c.length>0){Z=E(aa,X.c);if(Z){return Z}}}Z={id:aa,r:-1,c:[],p:false,v:0};Y.push(Z);return Z};var P=function(X,Y){for(var Z=0;Z<X.length;Z++){X[Z].v=Y;P(X[Z].c,Y+1)}};var F=function(Y,ab,ad,Z,ac){var X;for(var aa=Y.length-1;aa>-1;aa--){X=Y[aa];if(X.r==-1&&X.id==ad){X.r=ab;X.p=ac;X.v=ac.v+1;Y.splice(aa,1);P(X.c,X.v+1);return X}}return false};for(var T=0;T<J;T++){S=this.rows[T];G=S[I];W=S[N];H=R(M,G);U=F(M,T,W,G,H);if(!U){U={id:W,p:H,r:T,c:[],v:H.v+1}}H.c.push(U)}for(var Q=0;Q<M.length;Q++){U=M[Q];if(U.r==-1){S=U.c;for(var O=0;O<S.length;O++){H=S[O];H.p=false;this._tmap.push(H)}}}M=null},_crtGpMap:function(){var S,G,E,aa,Q="_";var R,K,U;var O,N;var V=this.ops.viewMode;var I=V.group;if(f.isNumeric(I)){I=[];I.push(V.group)}else{if(typeof I=="string"){I=[];I.push(V.group)}}var W=I.length;var F=this.rows;var J=F.length;var Y=J>0?f.isArray(F[0]):false;var H=0;var Z="x";var M=this.ops.columns;for(var X=0;X<M.length;X++){if(M[X].hide){H++}else{Z=M[X].name;break}}this._tmap=[];for(S=J-1;S>=0;S--){R=F[S];if(R._g){F.splice(S,1)}else{break}}J=F.length;var P=function(ae,ad){var ac;for(var ab=0;ab<ae.length;ab++){ac=ae[ab];if(ad==ac.tid){return ac}else{if(ad.indexOf(ac.tid+Q)==0){return P(ac.c,ad)}}}};var T=function(ae,ag,ab,ac){var ad=ae;var af="0";var ai;if(ag){af=ag[I[ac]];if(Y){ai=[];for(var ae=0;ae<=(H-1);ae++){ai.push("")}ai.push(af)}else{ai={};ai[Z]=af}ai._g=1;ad=F.push(ai)-1}var ah={r:ad,v:(ac+1),p:ab,pid:ab.tid,tid:ab.tid+Q+af,c:[]};ab.c.push(ah);return ah};for(S=0;S<J;S++){R=F[S];U="";N={c:this._tmap,tid:""};for(j=0;j<W;j++){U+=Q+R[I[j]];O=P(N.c,U);if(O){N=O}else{N=T(S,R,N,j)}}T(S,false,N,W)}},_sumTrLeafs:function(I,J){var G=0;var F;var E=J>-1?true:false;if(I._cnt){return I._cnt}for(var H=0;H<I.length;H++){F=I[H];if(F.c.length>0){G+=this._sumTrLeafs(F.c,J)}else{if(E){G+=parseFloat(this.rows[F.r][J])}else{G++}}}I._cnt=G;return G},_tpsel:function(F){var K,I=0;var G=0;var J=F.c.length;var E=this.rows[F.r];var M=0;if(J>0){for(var H=0;H<J;H++){K=this._tpsel(F.c[H]);if(K>0){I++;if(K==2){G=1}}}if(I==0&&G==0){M=0}else{if(I<J){M=2}else{M=1}}}else{if(E[this._chkcol]){M=1}}E._s=M;if(M){u(this.selected,F.r)}return M},_crtTr:function(M,E,F,N,J,G){var I=this,H=J?true:false;var K=M==-1?[]:this.rows[M];E.push("<tr "+(M==-1?"":('id="'+this.gid+"fr"+M+'"'))+N+">");F.push("<tr "+(M==-1?"":('id="'+this.gid+"mr"+M+'"'))+N+">");if(this.ops.showRownum){E.push('<td class="hgv-num-td"><div>');if(M==-1){E.push("&nbsp;")}else{E.push((this.page-1)*this.ops.pageSize+M+1)}E.push("</div></td>")}if(!this.ops.singleSelect&&!this._treeChk){E.push('<td class="hgv-chk-'+(M==-1?"blk":"td")+'"><div>&nbsp;</div></td>')}f.each(this.ops.columns,function(O,Q){if(Q.hide){return}var P=M==-1?"&nbsp;":e(Q,K,M,O,I);if(!Q.align){if(Q.type=="icon"){Q.align="center"}}if(O<I._tv_fixedci){E.push('<td class="hgv-fcol-td'+(H?" hgv-tc":"")+'" cidx="'+O+'" style="width:'+Q.widthx+"px;");if(M>-1&&Q.bgcolor){E.push("background-color:"+l(Q.bgcolor,M,O,K,Q)+";")}E.push('">');E.push('<div class="hgv-cd" style="width:'+(Q.widthx-8)+"px;");if(M>-1){if(Q.align){E.push("text-align:"+Q.align)}if(Q.txtcolor){E.push("color:"+l(Q.txtcolor,M,O,K,Q)+";")}}E.push('">');if(H){E.push(J);if(I._treeChk){E.push('<span class="hgv-ti-c">&nbsp;</span>')}}if(P==null){P=""}if(H){E.push('<span class="hgv-ti-t">'+P.toString()+"</span>")}else{E.push(P.toString())}if(H&&G){E.push('<span class="hgv-ti-n">'+G+"</span>")}E.push("</div></td>");H=false}else{F.push('<td class="hgv-mcol-td" cidx="'+O+'" style="width:'+Q.widthx+"px;");if(M>-1&&Q.bgcolor){F.push("background-color:"+l(Q.bgcolor,M,O,K,Q)+";")}F.push('">');F.push('<div class="hgv-cd"'+(M>-1?(' title="'+A(Q,K)+'"'):"")+' style="width:'+(Q.widthx-8)+"px;");if(M>-1){if(Q.align){F.push("text-align:"+Q.align+";")}if(Q.txtcolor){F.push("color:"+l(Q.txtcolor,M,O,K,Q)+";")}}F.push('">');if(P!=null){F.push(P.toString())}F.push("</div></td>")}});E.push("</tr>");F.push('<td class="hgv-mcol-td-l">&nbsp;</td></tr>')},_crtTreeRows:function(P,F,I){var G;var N;var Q;var E=false;var O;var M;var H=this.ops.viewMode;for(var K=0;K<P.length;K++){G=P[K];N=this.rows[G.r];if(!E){E="";for(var J=1;J<G.v;J++){E+='<span class="hgv-ti-b">&nbsp;</span>'}}Q=[];if(G.tid){Q.push(' tid="'+G.tid+'" pid="'+G.pid+'" ')}else{Q.push(' tid="'+N[H.tree[0]]+'" pid="'+N[H.tree[1]]+'" ')}Q.push(' class="');if(G.c.length>0){Q.push(n[1])}else{Q.push(n[0])}if(N._s>0){Q.push(" tr_sr");if(N._s==2){Q.push(" tr_sr_h")}if(this.ops.rowSelect){Q.push(" tr_cr")}}Q.push('"');O='<span class="hgv-ti-f">&nbsp</span>';if(H.expand=="*"){Q.push(' tfld="2"');if(G.c.length>0){O='<span class="hgv-ti-m">&nbsp</span>'}}else{Q.push(' tfld="1"');if(G.c.length>0){O='<span class="hgv-ti-p">&nbsp</span>'}if(G.v>1){Q.push(' style="display:none"')}}M="";if(G.c.length>0){if(H.counter){M=" ("+this._sumTrLeafs(G.c)+")"}else{if(H.sum){M=" ("+this._sumTrLeafs(G.c,H.sum)+")"}}}this._crtTr(G.r,F,I,Q.join(""),E+O,M);if(G.c.length>0){this._crtTreeRows(G.c,F,I)}}},_crtRows:function(H){var G=f("#"+this.gid+"_fdiv_tab tbody");var K=f("#"+this.gid+"_mdiv_tab tbody");var O=this;var E=[];var F=[];var R,Q;var N=this.ops.sortType=="client"?true:false;var P=false,S=false;if(this.ops.viewMode){if(this.ops.viewMode.tree){this._crtTrMap()}else{if(this.ops.viewMode.group){this._crtGpMap()}}}if(N){for(var J=0;J<this._sortCols.length;J++){if(this._sortCols[J].n!=-1){P=this._sortCols[J];break}}if(P){for(var I=0;I<this.ops.columns.length;I++){if(P.c==this.ops.columns[I].name){S=this.ops.columns[I];break}}}}if(this._tmap){if(this.rows.length>(f.GLOBALCONFIG&&f.GLOBALCONFIG.treeMaxRows?f.GLOBALCONFIG.treeMaxRows:2000)){alert("本程序的表格树/分组数据量大，可能会造成浏览器运行异常，建议使用异步TreeView组件方式优化程序")}for(var J=0;J<this._tmap.length;J++){this._tpsel(this._tmap[J])}if(S){var M=function(T){T.sort(function(W,V){var X=O.rows[W.r];var Y=O.rows[V.r];var ab=A(S,X);var aa=A(S,Y);var Z=r(ab,aa);return P.s=="asc"?Z:-Z});for(var U=0;U<T.length;U++){M(T[U].c)}};M(this._tmap)}this._crtTreeRows(this._tmap,E,F)}else{if(S){this.rows.sort(function(U,T){var X=A(S,U);var W=A(S,T);var V=r(X,W);return P.s=="asc"?V:-V})}for(var J=0;J<this.rows.length;J++){R=n[J%2];if(this._cri==J){R+=" tr_cr"}if(this.rows[J][this._chkcol]){R+=" tr_sr";if(this.ops.rowSelect){R+=" tr_cr"}u(this.selected,J)}this._crtTr(J,E,F,'class="'+R+'"',false,"")}}G.empty().append(E.join(""));K.empty().append(F.join(""));this._addBlktr(G,K,true);this._setpagebuts();if(H){if(f.isFunction(this.ops.OnQueryEnd)){this.ops.OnQueryEnd(this.rows.length,this)}}},_addBlktr:function(H,M,J){var I=H.parent().parent(),N=M.parent().parent(),P,E,O,F=[],G=[];if(J){f("tr.tr_blk",H).remove();f("tr.tr_blk",M).remove()}this._hasBlk=false;if(!this.ops.addBlankRow){return}P=I.height()-H.height();if(M.width()>N.width()){P-=18}if(P>0){O=f("tr",H);E=O.length>0?O.height():27;if(P>E){for(var K=1;K<(P/E);K++){this._crtTr(-1,F,G,'class="tr_blk"',false,"")}H.append(F.join(""));M.append(G.join(""));this._hasBlk=true}}},_resize:function(){var S=f("#"+this.gid+"_fdiv_tab");var T=f("#"+this.gid+"_mdiv_tab");var Z=f("tbody",S);var W=f("tbody",T);f("tr.tr_blk",Z).remove();f("tr.tr_blk",W).remove();var ac=f("#"+this.gid+"_tdiv");ac.css({width:"1px",height:"1px",overflow:"hidden"});var F=f("#"+this.gid+"_foot_tdiv");F.css({width:"1px",overflow:"hidden"});var ae=f("#"+this.gid+"_fdiv");ae.css({width:"1px",height:"1px",overflow:"hidden"});var af=f("#"+this.gid+"_mdiv");af.css({width:"1px",height:"1px",overflow:"hidden"});var H=f("#"+this.gid);var R=f("#"+this.gid+"_pdiv");var ab=H.width();var G=H.find(".hgv-t").height();var N=H.find(".hgv-tb");if(N.length>0){G+=N.height()}var O=H.height()-G-2;if(R.length>0){O-=R.height();R.css({width:"100%"})}var ad=f("#"+this.gid+"_wt");ad.css({width:"100%",height:O+"px"});var aa=ac.parent();var J=aa.width();var Y=f("#"+this.gid+"_tdiv_tab");var Q=Y.height();aa.css({height:Q+"px"});ac.css({width:(J)+"px",height:Q+"px",overflow:"hidden"});if(F.length>0){F.css({width:J+"px",overflow:"hidden"})}var I=ae.parent();var P=I.width();var X=I.height();ae.css({width:(P)+"px",height:X+"px",overflow:"hidden"});var E=af.parent();var M=E.width();var V=E.height();af.css({width:(M)+"px",height:V+"px",overflow:"auto"});var U=af.scrollTop();S.css("top",-U);Y.css("left","0");f("#"+this.gid+"_foot_tdiv_tab").css("left","0");af.scrollLeft(0);f("#"+this.gid+"loading").css({width:"100%",height:H.height()});var K=f("#"+this.gid+"loading_img");K.css({left:(H.width()-K.width())/2,top:(H.height()-K.height())/2});f("#hgv_dragsplit").css({height:ad.height(),top:ad.offset().top});this._addBlktr(Z,W,false)},_selTrees:function(M){var S=this._getridxfrom$tr(M);var T=this.ops.rowSelect?" tr_cr":"";var O=M.hasClass("tr_sr");var F=this._getTreeRows(S,"parent");var I=this._getTreeRows(S,"child*");var N=this;var Q=function(Y,V,X){var aa=f("#"+N.gid+"fr"+Y);var W=f("#"+N.gid+"mr"+Y);var U=aa.hasClass("tr_sr");var Z=aa.hasClass("tr_sr_h")?"half":"all";if(U&&!V){aa.removeClass("tr_sr tr_sr_h"+T);W.removeClass("tr_sr"+T);g(N.selected,Y)}else{if(X!=Z||(!U&&V)){aa.addClass("tr_sr"+T);W.addClass("tr_sr"+T);if(X=="half"){aa.addClass("tr_sr_h")}else{aa.removeClass("tr_sr_h")}u(N.selected,Y)}}};for(var K=0;K<I.length;K++){Q(I[K],O,"all")}while(F>-1){var R=this._getTreeRows(S,"sibling*");var P=0;var E=false;for(var J=0;J<R.length;J++){var H=f("#"+N.gid+"fr"+R[J]);if(H.hasClass("tr_sr")){P++;if(H.hasClass("tr_sr_h")){E=true}}}var G=P<1?"none":((P<R.length||E)?"half":"all");if(G=="none"){Q(F,false,"none")}else{Q(F,true,G)}S=F;F=this._getTreeRows(F,"parent")}},_showchilds:function(I,F,M){var O=I.attr("tfld");var N,K;if(O=="1"||O=="2"){var G=I.attr("tid");var E=I.next();var J=E.attr("pid");while(J==G){if(F){E.show();N=E.attr("id");K=parseInt(N.substr(this.gid.length+2));f("#"+this.gid+"mr"+K).show()}var H=E.attr("tfld");if(H=="1"||H=="2"){if(M&&H=="1"){d(E,"m");H="2"}E=this._showchilds(E,H=="2"?true:false,M)}else{E=E.next()}J=E.attr("pid")}return E}return I.next()},_hidechilds:function(I,F){var N=I.attr("tfld");var M,K;if(N=="1"||N=="2"){var G=I.attr("tid");var E=I.next();var J=E.attr("pid");while(J==G){E.hide();M=E.attr("id");K=parseInt(M.substr(this.gid.length+2));f("#"+this.gid+"mr"+K).hide();var H=E.attr("tfld");if(H=="1"||H=="2"){if(F){d(I,"p")}E=this._hidechilds(E,F)}else{E=E.next()}J=E.attr("pid")}return E}return I.next()},_getridxfrom$tr:function(F){var E=F.attr("id");if(!E){return -1}return parseInt(E.substr(this.gid.length+2))},_getcellfrom$td:function(H){var F=H.parent();var G=parseInt(H.attr("cidx"));var E=this._getridxfrom$tr(F);return{_col:G,_row:E}},_restchktitle:function(){var E=f("#"+this.gid+"_chk");var G=this.rows.length;var F=this.selected.length;if(F>=G){E.removeClass("chk-half").addClass("chk-all")}else{if(F>0){E.removeClass("chk-all").addClass("chk-half")}else{E.removeClass()}}if(E.hasClass("chk-all")){E.attr("title","单击清除选择")}else{if(E.hasClass("chk-half")){E.attr("title","单击反向选择,双击全部选择")}else{E.attr("title","单击全部选择")}}},_selrow_fun:function(G,E,H){var F=this.ops.rowSelect?" tr_cr":"";if(E=="all"){if(!G.hasClass("tr_sr")){G.addClass("tr_sr"+F).removeClass("tr_sr_h");if(H){u(this.selected,this._getridxfrom$tr(G))}}else{G.removeClass("tr_sr_h")}}else{if(E=="none"){G.removeClass("tr_sr tr_sr_h"+F)}else{if(E=="half"){if(G.hasClass("tr_sr")){G.removeClass("tr_sr tr_sr_h"+F)}else{G.addClass("tr_sr"+F).removeClass("tr_sr_h");if(H){u(this.selected,this._getridxfrom$tr(G))}}}}}},_selrow:function(E){var G=f("#"+this.gid+"_fdiv");var H=f("#"+this.gid+"_mdiv");var F=this;if(E=="none"||E=="half"){this.selected=[]}f("tr",G).each(function(){var I=f(this);if(F._isBlkTr(I)){return true}if(I.hasClass("tr_dr")){if(I.hasClass("tr_sr")){u(F.selected,F._getridxfrom$tr(I))}return true}F._selrow_fun(I,E,true)});f("tr",H).each(function(){var I=f(this);if(F._isBlkTr(I)){return true}if(I.hasClass("tr_dr")){if(I.hasClass("tr_sr")){u(F.selected,F._getridxfrom$tr(I))}return true}F._selrow_fun(I,E,false)});this._restchktitle()},_isBlkTr:function(E){if(this._hasBlk){return E.hasClass("tr_blk")}return false},_clktoolbar:function(G,P){var N=f(G);var S=N.parent().parent().parent();var K=S.attr("id");var Q=K.substr(this.gid.length+4);var F=Q.split("_");var I=this.ops.columns[F[1]].toolbar;if(I){if(I._events){if(I._events.click){var J=I._events.click.btns;var H=N.attr("data-pid");var R=N.find(".cbtnar").attr("mid");if(R){var O=f("#"+R);var E=O.data("$m");if(E&&f.isFunction(E.show)){O.attr("grow",F[0]);E.show(P.clientX,P.clientY);return false}}for(var M=0;M<J.length;M++){if(H==J[M].id){P.data=J[M].data;if(f.isFunction(J[M].fn)){J[M].fn.call(G,P,F[0])}return false}}}}}},_clkselrow:function(M,G,P){var K=f.isFunction(this.ops.OnSelectedRow)?this.ops.OnSelectedRow:false;var E=f.isFunction(this.ops.OnCurrentRow)?this.ops.OnCurrentRow:false;var H=this.ops.rowSelect;var O=this._getridxfrom$tr(M);var J=false;var Q=false;var F=false;if(G){J=M;Q=f("#"+this.gid+"mr"+O)}else{Q=M;J=f("#"+this.gid+"fr"+O)}if(!this.ops.singleSelect&&(P||H)){if(g(this.selected,O)){J.removeClass("tr_sr tr_sr_h tr_cr");Q.removeClass("tr_sr tr_cr");this._restchktitle();if(this._treeChk){this._selTrees(M)}if(K){K({row:O,selected:false,"$tr":M})}return}u(this.selected,O);J.addClass("tr_sr tr_cr");Q.addClass("tr_sr tr_cr");this._restchktitle();if(this._treeChk){this._selTrees(M)}if(K){K({row:O,selected:true,"$tr":M})}}else{if(this._cri==O){return}if(this._cri>-1){var N=f("#"+this.gid+"fr"+this._cri);var I=f("#"+this.gid+"mr"+this._cri);N.removeClass("tr_cr");I.removeClass("tr_cr");if(this.ops.singleSelect){N.removeClass("tr_sr");I.removeClass("tr_sr");if(K){K({row:this._cri,selected:false,"$tr":M})}}}J.addClass("tr_cr");Q.addClass("tr_cr");this._cri=O;if(this.ops.singleSelect){this.selected=[];this.selected.push(O);J.addClass("tr_sr");Q.addClass("tr_cr");if(K){K({row:O,selected:true,"$tr":M})}}else{if(E){E({row:O,selected:true,"$tr":M})}}}},_loading:function(F){var G=f("#"+this.gid+"loading");var E=f("#"+this.gid+"loading_img");if(F){G.show();E.show()}else{G.hide();E.hide()}},_setpagebuts:function(){var N=this;var P=f("#"+this.gid+"_pndiv");if(P.length<1){return}var Q=0;var E=this.ops.pageSize;if(E<1){this.total=this.rows.length}if(this.total<=0){this.total=0}if(E>0){Q=parseInt(""+(this.total/E));if((Q*E)<this.total){Q+=1}}var S=(this.page-1)*E+1;if(S<0){S=0}var U=this.page*E;if(U>this.total){U=this.total}if(this.total>0&&(this.total<=E||E==0)){Q=1;S=1;U=this.total}if(this.total<=0){Q=0;S=0;U=0}this.pageCount=Q;var T=f(".hgv-page-s1",P),R=f(".hgv-page-s2",P),O=f(".hgv-page-s3",P),M=f(".hgv-page-s4",P),K=f(".hgv-page-s5",P),J=f(".hgv-page-s6",P),H=f(".hgv-page-s7",P),G=f(".hgv-page-goinput",P);if(Q<=1){f("a",P).hide();T.hide();R.hide();M.hide();G.hide();K.hide()}else{f("a",P).show();T.show();R.show();M.show();G.show();K.show()}O.html("&nbsp;共"+Q+"页&nbsp;");J.show().html("&nbsp;总共"+this.total+"条记录&nbsp;");H.show().html("&nbsp;当前页显示["+S+"-"+U+"]行&nbsp;");f(".hgv-page-cur",P).removeClass("hgv-page-cur");if(this.total<1){O.html("&nbsp;"+this.ops.noDataTip+"&nbsp;");J.hide();H.hide();return}if(Q<=1){H.hide();return}f(".hgv-page-last",P).html(""+Q);var I=this.page-2;var F=0;if(I<2){I=2}f(".hgv-page-num",P).each(function(W){var X=f(this);var V=I+W;X.html(""+V);if(V==N.page){X.addClass("hgv-page-cur")}if(W==4){F=V}if(V>=Q){X.hide()}});if(I==2){T.hide()}if(F>=(Q-1)){R.hide();if((F-5)>2){f(".hgv-page-cur",P).removeClass("hgv-page-cur");f(".hgv-page-num",P).each(function(W){var X=f(this);var V=Q-5+W;X.show().html(""+V);if(V==N.page){X.addClass("hgv-page-cur")}})}}if(this.page==1){f(".hgv-page-first",P).addClass("hgv-page-cur");f(".hgv-page-prev",P).addClass("hgv-page-disb")}else{if(this.page==Q){f(".hgv-page-last",P).addClass("hgv-page-cur");f(".hgv-page-next",P).addClass("hgv-page-disb")}else{f(".hgv-page-prev",P).removeClass("hgv-page-disb");f(".hgv-page-next",P).removeClass("hgv-page-disb")}}},_gotopage:function(E){this.page=E>this.pageCount?this.pageCount:E;if(this.page<1){this.page=1}this._params.pageSize=this.ops.pageSize;this._params.page=this.page;this._query()},_query:function(){var G=this,E;var H=this.ops.action;var F=this.ops.actionType;if(F=="opensql"){throw new Error("gridview不支持的action类型:"+F)}this.selected=[];this._cri=-1;this.rows=[];if(f.isFunction(H)){this._loading(true);window.setTimeout(function(){var I=H(G._params);if(f.isArray(I)){G.rows=I}else{if(I.rows){G.rows=I.rows}if(I.total){G.total=I.total}}G.total=G.rows.length;if(I.sums){G.sums=I.sums}if(f.isFunction(G.ops.OnQueryComplete)){G.ops.OnQueryComplete(G.rows.length,G)}G._init();G._crtRows(true);G._loading(false)},100)}else{if(typeof H=="string"){E=this._params;this._loading(true);if(H.indexOf("jspaction/")>=0){E={jspactionreqjson:JSON.stringify(this._params)}}f.ajax({type:"POST",dataType:"json",url:H,data:E,success:function(I){if(I&&I.errorMsg){G._loading(false);alert(I.errorMsg);return}if(f.isArray(I)){G.rows=I;if(G.page==1){G.total=I.length}}else{if(f.isPlainObject(I)){if(I.rows&&f.isArray(I.rows)){G.rows=I.rows}else{if(I.data&&f.isArray(I.data)){G.rows=I.data}}if(G.page==1){if(I.total!=undefined){G.total=I.total}if(I.sums){G.sums=I.sums}if(I.meta){G.meta=I.meta}}}}if(f.isFunction(G.ops.OnQueryComplete)){G.ops.OnQueryComplete(G.rows.length,G)}G._init();G._crtRows(true);G._loading(false)},error:function(I,K,J){G._loading(false);alert("GridView出错!,服务器返回查询数据异常:")}})}}},_findTreeObj:function(I,G){var F,E;for(var H=0;H<G.length;H++){F=G[H];if(F.r==I){return F}if(F.c.length>0){E=this._findTreeObj(I,F.c);if(E){return E}}}return false},_getTreeRows:function(H,I){var E,K,J,F;if(this._tmap){E=this._findTreeObj(H,this._tmap);if(I=="parent"){if(E.p){return E.p.r}return -1}else{if(I=="parent*"){K=[];while(E.p){K.push(E.p.r);E=E.p}return K}else{if(I=="child"){K=[];for(var G=0;G<E.c.length;G++){J=E.c[G];K.push(J.r)}return K}else{if(I=="child*"){K=[];for(var G=0;G<E.c.length;G++){J=E.c[G];K.push(J.r);if(J.c.length>0){K=K.concat(this._getTreeRows(J.r,"child*"))}}return K}else{if(I=="sibling*"){K=[];F=E.p;if(!F){F={r:-1,c:this._tmap}}for(var G=0;G<F.c.length;G++){J=F.c[G];K.push(J.r)}return K}else{if(I=="siblingup"){K=-1;F=E.p;if(!F){F={r:-1,c:this._tmap}}for(var G=0;G<F.c.length;G++){J=F.c[G];if(J.r==H){return K}K=G}return K}else{if(I=="siblingup*"){K=[];F=E.p;if(!F){F={r:-1,c:this._tmap}}for(var G=0;G<F.c.length;G++){J=F.c[G];if(J.r==H){return K}K.push(J.r)}return K}else{if(I=="siblingdn*"){K=false;F=E.p;if(!F){F={r:-1,c:this._tmap}}for(var G=0;G<F.c.length;G++){J=F.c[G];if(J.r==H){K=[]}if(K){K.push(J.r)}}return K}else{if(I=="siblingdn"){K=false;F=E.p;if(!F){F={r:-1,c:this._tmap}}for(var G=0;G<F.c.length;G++){J=F.c[G];if(J.r==H){K=true}else{if(K){K=G;break}}}return f.isNumeric(K)?K:-1}}}}}}}}}}return false},_delrowflag:function(G){var H=this.rows;var I=H.length;var F=this._getTreeRows(G,"child*");if(!F){F=[]}F.push(G);F.sort(function(K,J){return K-J});for(var E=0;E<F.length;E++){if(F[E]>=0&&F[E]<I){H[F[E]]._d=1}}},query:function(E){this._params={};if(typeof E=="string"){this.ops.action=E;if(arguments.length>1){if(f.isPlainObject(arguments[1])){this._params=arguments[1]}}}else{if(f.isPlainObject(E)){this._params=E}}if(f.isPlainObject(this.ops.queryParams)){this._params=f.extend(this._params,this.ops.queryParams)}this._params.orderby=this._getOrderBy();this._lqp=this._params;this._gotopage(1)},getSelectedRows:function(){return this.selected},getSelectedRow:function(){return this._cri},getRowData:function(F,E){if(F<0||F>=this.rows.length){return null}if(E){return q(this.rows[F],this)}return this.rows[F]},getRowdata:function(E,F){return this.getRowData(E,F)},getRows:function(E){return this.getRowsData(E)},getRowsData:function(G){if(G){if(this.rows){if(this.rows.length>0&&f.isArray(this.rows[0])){var E=[];for(var F=0;F<this.rows.length;F++){E.push(this.getRowData(F,true))}return E}}}return this.rows},getSelectedDatas:function(G){var H=[],J=this.selected,I=this.rows,F=0,E=J.length;for(;F<E;F+=1){if(G){H.push(q(I[J[F]],this))}else{H.push(I[J[F]])}}return H},reset:function(){this.rows=[];this.page=1;this.total=0;this.sums=false;this.selected=[];this._cri=-1;this._crtRows(false)},refesh:function(E){if(E){this.selected=[];this._cri=-1}this._init();this._crtRows(false)},firstPage:function(){_gotopage(1)},nextPage:function(){_gotopage(this.page+1)},prevPage:function(){_gotopage(this.page-1)},lastPage:function(){_gotopage(this.pageCount)},toPage:function(E){_gotopage(E)},selectRow:function(I,F,H){var M=f("#"+this.gid+"fr"+I);var Q=f("#"+this.gid+"mr"+I);var P=this.ops.singleSelect;var G=P?"":(this.ops.rowSelect?" tr_cr":"");var E=P?"tr_cr":"tr_sr";if(M.length<1){return false}var N=arguments.length<2?true:F;var K=M.hasClass(E);if(N&&K){return false}else{if(!N&&!K){return false}}if(N){M.addClass(E+G);Q.addClass(E+G);if(P){if(this._cri>-1){var O=f("#"+this.gid+"fr"+this._cri);var J=f("#"+this.gid+"mr"+this._cri);O.removeClass("tr_cr").removeClass("tr_sr");J.removeClass("tr_cr").removeClass("tr_sr")}M.addClass("tr_sr");Q.addClass("tr_sr");this.selected=[];this._cri=I}u(this.selected,I);if(H&&this._treeChk){this._selTrees(M)}}else{M.removeClass(E+G);Q.removeClass(E+G);g(this.selected,I);if(P){M.removeClass("tr_sr");Q.removeClass("tr_sr");this.selected=[];this._cri=-1}if(H&&this._treeChk){this._selTrees(M)}}},addrow:function(E){return this.xRowsAdd(E)},addRow:function(E){return this.addrow(E)},setQueryData:function(F,E){if(f.isArray(F)){this.ops.action=function(J){var G={};G.total=F.length;G.rows=F;G.sums=E;if(G.total>0){if(J.orderby){var H=J.orderby.toLowerCase();var I=H.split(",");G.rows.sort(function(M,K){var O=0;for(var P=0;P<I.length;P+=1){var R=I[P].split(" ");var N=R[0];var Q="a";if(R.length>1){Q=R[1].substr(0,1)}if(M[N]<K[N]){return(Q=="d"?1:-1)}if(M[N]>K[N]){return(Q=="a"?1:-1)}}return O})}}return G};this.query()}},remove:function(){var E=this.gid;f("#"+E).removeData("$hgv$");f("#"+E).remove()},reload:function(E){this.query(E)},checkAll:function(E){if(E){this._selrow("all")}else{this._selrow("none")}},xRowsCollapse:function(F){var H,E;if(F=="*"){for(var G=0;G<this._tmap.length;G++){E=this._tmap[G];if(E.c.length>0){H=f("#"+this.gid+"fr"+E.r);this._hidechilds(H,true);d(H,"p")}}}else{if(f.isNumeric(F)){H=f("#"+this.gid+"fr"+F);this._hidechilds(H,true);d(H,"p")}}},xRowsExpand:function(F){var H,E;if(F=="*"){for(var G=0;G<this._tmap.length;G++){E=this._tmap[G];if(E.c.length>0){H=f("#"+this.gid+"fr"+E.r);this._showchilds(H,true,true);d(H,"m")}}}else{if(f.isNumeric(F)){H=f("#"+this.gid+"fr"+F);this._showchilds(H,true,true);d(H,"m")}}},xRowsAdd:function(K){var J=this;var G=[];var F=0;var E=f.isArray(K);var H=f.isPlainObject(K);if(E){if(K.length<1){return false}if(!(f.isArray(K[0])||f.isPlainObject(K[0]))){E=false;H=true}}if(!E&&!H){return false}if(H){F=this.rows.push(K);G.push(F)}else{for(var I=0;I<K.length;I++){F=this.rows.push(K[I]);G.push(F)}}this._loading(true);setTimeout(function(){J.refesh();J._loading(false)},100);return G.length==1?G[0]:G},updateRow:function(G,H){if(!f.isNumeric(G)){return false}var E=parseInt(G);if(E<0||E>=this.rows.length){return false}this.rows[E]=H;this._loading(true);var F=this;setTimeout(function(){F.refesh();F._loading(false)},100);return true},deleteRow:function(E){return this.xRowsDel(E)},xRowsDel:function(G){var I=this;if(f.isArray(G)){for(var H=0;H<G.length;H++){this._delrowflag(parseInt(G[H]))}}else{if(f.isNumeric(G)){this._delrowflag(parseInt(G))}else{this.reset()}}var K=f("#"+this.gid+"_fdiv_tab");if(K.length<1){K=f("#"+this.gid+"_mdiv_tab")}if(K.length>0){var E=K.children("tbody");var J=E.children("tr");this.selected=[];J.each(function(O){var P=f(this);if(P.hasClass("tr_blk")){return true}var Q=O;if(I.rows[O]){if(I.rows[O]._d){return true}}for(var N=O-1;N>=0;N--){if(I.rows[N]._d){Q--}}if(P.hasClass("tr_sr")){u(I.selected,Q)}})}var M=this.rows.length;for(var F=M-1;F>=0;F--){if(this.rows[F]._d==1){this.rows.splice(F,1)}}if(this.rows.length<M){this._loading(true);setTimeout(function(){I.refesh();I._loading(false)},100)}return M-this.rows.length},xRowGet:function(E,F){return this._getTreeRows(E,F)},xRowHasChild:function(F){var G=f("#"+this.gid+"fr"+F);var E=G.next();if(E.length<1){return false}var H=G.attr("tid");if(E.attr("pid")==H){return true}return false},xRowSetVal:function(K,J,F){if(K<0||K>=this.rows.length){return false}var I=this.rows[K];var O=-1;var E=0;var M=this.ops.columns;var G=false;if(f.isNumeric(J)){E=parseInt(J);if(E>-1&&E<M.length){O=E}}else{for(var H=0;H<M.length;H++){G=M[H];if(J==G.name){if(f.isArray(I)){if(G._di>-1&&G._di<I.length){O=G._di}}else{O=J}break}}}if(O!=-1){var N=I[O];if(N!=F){I[O]=F;return this.updateRow(K,I)}}return false},xRowGetVal:function(I,K){var F=(I<0||I>=this.rows.length)?false:this.rows[I];var E=-1;var J=this.ops.columns;var G=false;if(f.isNumeric(K)){E=parseInt(K);if(E>-1&&E<J.length){G=J[E]}}else{for(var H=0;H<J.length;H++){G=J[H];if(K==G.name){break}}}if(G&&F){return A(G,F)}return undefined},getRowCount:function(){return this.total>0?this.total:this.rows.length},getPageCount:function(){return this.pageCount},bind:function(G,H){var F={contextmenu:"OnContextMenu",initing:"OnIniting",clickcell:"OnClickCell",headchkclick:"OnHeadChkClick",querycomplete:"OnQueryComplete",selectedrow:"OnSelectedRow",doubleclickcell:"OnDoubleClickCell",queryend:"OnQueryEnd",clickbutton:"OnClickButton",keyenter:"OnKeyEnter",currentrow:"OnCurrentRow",cellchange:"OnCellChange"};var E=G.toLowerCase();if(E.substring(0,2)=="on"){E=E.substring(2)}if(F[E]&&f.isFunction(H)){this.ops[F[E]]=H}},savePageDataToFile:function(I){var G=this;var H={rows:this.rows,columns:this.ops.columns};var F=f.isPlainObject(I)?I:(typeof I=="string"?{filename:I}:{});var E="fileservice/clttofile";var J=[];if(F.filename){J.push("_resultFilename="+F.filename)}if(F.splitchar){J.push("_resultTxtSplit="+F.splitchar)}if(J.length>0){E+="?"+J.join("&")}this._loading(true);setTimeout(function(){f.callFile(E,{clttofilereqjson:JSON.stringify(H)});G._loading(false)},100)},queryDataToFile:function(H,I){var F=this;var G=this.ops;if(G.pageSize<1||this.getPageCount()<1){this.savePageDataToFile(H);return}var E=f.isPlainObject(H)?H:(typeof H=="string"?{filename:H}:{});var J={};if(f.isPlainObject(I)){J=I}J._columns=JSON.stringify(G.columns);J._headRows=JSON.stringify(G.headRows);if(E.filename){J._resultFilename=E.filename}if(E.splitchar){J._resultTxtSplit=E.splitchar}if(f.isPlainObject(G.queryParams)){J=f.extend(J,G.queryParams)}J.orderby=this._getOrderBy();this._loading(true);setTimeout(function(){f.callFile(G.action,J);F._loading(false)},100)},resize:function(){this._resize()},focus:function(){f("#"+this.gid+"_focus").focus()},enableRow:function(G,F){if(G<0||G>=this.rows.length){return false}var H=f("#"+this.gid+"fr"+G);var E=f("#"+this.gid+"mr"+G);if(F==undefined||F){H.removeClass("tr_dr").find(".tbar").show();E.removeClass("tr_dr").find(".tbar").show()}else{H.addClass("tr_dr").find(".tbar").hide();E.addClass("tr_dr").find(".tbar").hide()}},editRow:function(S,K){var O=this.ops.columns;var J=this.gid;if(S<0||S>=this.rows.length){return false}var P=f("#"+J+"_edit");if(P.attr("data-rid")==S){return false}P.attr("data-rid",S);var H=f("#"+J+"fr"+S);var T=f("#"+J+"mr"+S);var M=H.find("td");var R=T.find("td");var F=false;var E=true;var Q=function(){var aa=f(this);var U=parseInt(aa.attr("cidx"));if(U>0){if(O[U]){var ab=O[U].name;var W=f("#"+J+"_edit_"+ab);if(W.length){if(W.parent().get(0)!=aa.get(0)){aa.append(W);if(aa.hasClass("hgv-tc")){var V=aa.find(".hgv-ti-t").prev();var X=V.position().left+V.width();W.css({left:X+"px",width:(aa.width()-4-X)+"px"})}else{if("checkbox"==W.attr("type")){var Z=aa.find(".hgv-cell-chk");if(Z.length){var Y=Z.position();W.css({left:Y.left+4,top:Y.top})}}}}if(!F){F=W}if(U==K){W.focus();E=false}}}}};M.each(Q);R.each(Q);var G=P.data("$fv");G.reset();G.setData(this.getRowData(S,true));if(E&&F){F.focus()}var I=f("#gcal1028");if(I.length>0){var N=I.data("$hc");if(N.hide){N.hide()}}},getver:function(){return 2000}};s.prototype=m;f.GridView=function(H,F){var G;if(arguments.length==1&&typeof arguments[0]=="string"){var E=arguments[0];if(E.charAt(0)!="#"){E="#"+arguments[0]}G=f(E).data("$hgv$");return G}G=new s(H,F);f("#"+G.gid).data("$hgv$",G);return G}})(jQuery);(function(k,d){var e=[];function g(){if(d.browser.msie&&parseInt(d.browser.version)<=6){return true}return false}function i(l,o){var n=[];var q="filter:alpha(Opacity="+(o.opacity*100)+");opacity:"+o.opacity+";";if(g()){n.push('<iframe id="cmd'+l+'_ie6f" class="cmd-mdiv-ie6frame" frameborder="0" tabindex="0" style="z-index:'+(o.zindex-1)+";"+q+'"/>')}n.push('<div id="cmd'+l+'" class="cmd-mdiv" style="z-index:'+o.zindex+";"+q+'"></div>');n.push('<div id="cmddiv'+l+'" class="cmd-wrap-div"  style="z-index:'+(o.zindex+1)+'" data-sw="'+o.width+'" data-sh="'+o.height+'" data-sa="'+o.autoSize+'">');n.push('<div class="cmd-wrap-title" style="cursor:default;');if(o.hideTitle){n.push("height:1px;overflow:hidden;")}n.push('">');if(o.titleIcon){n.push('<span class="cmd-wrap-title-icon" style="background:url('+o.titleIcon+') no-repeat center center;" >&nbsp;</span>')}if(o.title){n.push('<span class="cmd-wrap-title-text">'+o.title+"</span>")}if(o.closeButton){n.push('<span class="cmd-wrap-close-btn cmd-cancel-btn"  id="cmd'+l+'_csbtn" title="关闭对话框">&nbsp;</span>')}n.push("</div>");n.push('<div id="cmddiv_c'+l+'" class="cmd-wrap-content-div"></div>');if(o.okButton){n.push('<div class="cmd-wrap-footer"><span class="cmd-wrap-okbtn cmd-btn-disable" id="cmd'+l+'_okbtn">确认</span>');if(o.cancelButton){n.push('<span class="cmd-wrap-clbtn cmd-cancel-btn" id="cmd'+l+'_clbtn">取消</span>')}n.push("</div></div>")}d("body").append(n.join(""));var m=d("#cmddiv_c"+l);if(o.src instanceof jQuery){m.append(o.src);d("#cmd"+l+"_okbtn").removeClass("cmd-btn-disable")}else{if(typeof o.src=="string"){var p=d('<iframe cmd-idx="'+l+'" frameborder="no" style="display:none" class="cmd-wrap-content-frame" src="'+o.src+'"></iframe>');p.on("load",function(){d("#cmd"+l+"_okbtn").removeClass("cmd-btn-disable");d(this).show().parent().removeClass("cmd-loading");if(this.contentWindow){this.contentWindow.focus()}});m.css({overflow:"hidden"}).addClass("cmd-loading").append(p)}}d("#cmddiv"+l+"").on("click",".cmd-cancel-btn",function(){k.CloseMaskDialog(false)}).on("mousedown",".cmd-wrap-title",function(v){var w=this;var u=d(this);var r={x:v.clientX,y:v.clientY};function t(C){var B=C.clientX-r.x;var A=C.clientY-r.y;r={x:C.clientX,y:C.clientY};var y=d("#cmddiv"+l);var x=parseInt(y.css("left"));var z=parseInt(y.css("top"));x+=B;z+=A;y.css({left:x+"px",top:z+"px"});return false}function s(x){u.unbind("mousemove",t);u.unbind("mouseup",s);return false}u.bind("mousemove",t);u.bind("mouseup",s);u.bind("mouseleave",s)});d("#cmd"+l+"_okbtn").on("click",function(){var r=d(this);if(r.hasClass("cmd-btn-disable")){return}k.CloseMaskDialog(true)})}function b(){var m,l,n;if(k.document.compatMode==="CSS1Compat"){m=k.document.documentElement}else{m=k.document.body}if("pageYOffset" in k){l=k.pageYOffset;n=k.pageXOffset}else{l=m.scrollTop;n=m.scrollLeft}return{st:l,sl:n,ch:m.clientHeight,cw:m.clientWidth,ah:d(document).outerHeight(),aw:d(document).outerWidth()}}function h(){var x,q,o;o=b();for(var p=0;p<e.length;p++){d("#cmd"+p).css("height",o.ah+"px");if(g()){d("#cmd"+p+"_ie6f").css("height",o.ah+"px")}var r=d("#cmddiv"+p);var l=r.attr("data-sw");var t=r.attr("data-sh");var z=r.attr("data-sa");if(d.isNumeric(l)){x=l}else{if(typeof l=="string"){x=parseInt(l);if(l.charAt(l.length-1)=="%"){x=o.cw*x/100}}}if(d.isNumeric(t)){q=t}else{if(typeof t=="string"){q=parseInt(t);if(t.charAt(t.length-1)=="%"){q=o.ch*q/100}}}if(z=="true"){if(q>o.ch){q=o.ch}if(x>o.cw){x=o.cw}}d(".cmd-wrap-title-text",r).css({width:(x-70)+"px"});var m=d(".cmd-wrap-title",r).height();var s=d("#cmd"+p+"_okbtn");var v=0;if(s.length>0){var y=s.parent();var n=d("#cmd"+p+"_clbtn");v=y.height();var u=0;if(n.length>0){u=n.width();n.css({top:(v-n.height())/2,left:(x-s.width()-16-u)/2+s.width()+16})}s.css({top:(v-s.height())/2,left:(x-s.width()-16-u)/2})}r.css({top:((o.ch-q)/2+o.st)+"px",left:((o.cw-x)/2)+"px",width:x+"px",height:q+"px"});d("#cmddiv_c"+p).css({height:(q-m-v)+"px"})}}function f(m){var p=d("#cmd"+e.length);var q=d("#cmddiv"+e.length);var r=0;var o=0;var l=0;d(".cmd-mdiv").each(function(s){o=parseInt(d(this).css("z-index"));if(r<o){r=o}});if(r>0){m.zindex=r+10}if(p.length<1){l=i(e.length,m);p=d("#cmd"+e.length);q=d("#cmddiv"+e.length)}d(k).unbind("resize",h);var n=d("body");if(e.length==0){e.push({src:m.src,boofs:n.css("overflow")});n.css("overflow","hidden")}else{e.push({src:m.src})}p.data("param",m);h();p.show();q.show();if(m.src instanceof jQuery){m.src.show()}if(g()){d("#cmd"+(e.length-1)+"_ie6f").show()}d(k).bind("resize",h)}k.ShowMaskDialog=function(n,o){var l={OnClose:false};if(k.parent&&!(k.parent===self)){if(typeof k.parent.ShowMaskDialog=="function"){k.parent.ShowMaskDialog(n,o);return}}var m={src:n,title:"无标题",closeButton:true,cancelButton:true,okButton:true,opacity:0.5,zindex:9999,autoSize:true,width:800,height:480};if(d.isFunction(o)){m.OnOk=o}else{m=d.extend(m,o)}f(m)};k.CloseMaskDialog=function(m){if(k.parent&&!(k.parent===self)){if(d.isFunction(k.parent.CloseMaskDialog)){return k.parent.CloseMaskDialog(m)}}if(e.length<1){k.close();return false}var l=e.length-1;var p=d("body");var q=d("#cmd"+l);var r=d("#cmddiv"+l);while(l>-1&&q.length<1){l--;q=d("#cmd"+l);r=d("#cmddiv"+l)}if(q.length<1){return false}var s=false;var o=q.data("param");if(m){if(o.OnCloseQuery){if(d.isFunction(o.OnCloseQuery)){if(o.OnCloseQuery()){}else{return false}}}if(o.OnOk){if(d.isFunction(o.OnOk)){o.OnOk()}}}else{if(o.OnCancel){if(d.isFunction(o.OnCancel)){o.OnCancel()}}}d(k).unbind("resize",h());q.hide();r.hide();var n=e[l];if(n.src){if(n.src instanceof jQuery){p.append(n.src.hide())}}if(e.length<1){if(n.boofs){p.css({overflow:n.boofs})}}r.remove();q.remove();if(g()){d("#cmd"+l+"_ie6f").hide().remove()}if(m&&o.closeParent){k.CloseMaskDialog(m)}return true};k._$GetMDParam=function(){if(k.parent&&!(k.parent===self)){if(typeof k.parent["_$GetMDParam"]=="function"){return k.parent._$GetMDParam()}}var l=e.length-1;if(l<0){return false}var m=d("#cmd"+l);if(m.length<1){return false}return m.data("param")};k.isMaskDialog=function(){var l=k._$GetMDParam();return l?true:false};d.ShowDlg=function(l,m){if(arguments.length<1){throw new Error("$.ShowDlg参数个数不对，调用形式为: $.ShowDlg(url, {ops})")}k.ShowMaskDialog(l,m)};d.CloseDlg=function(l){k.CloseMaskDialog(l)};d.GetDlgParams=function(){return k._$GetMDParam()};function c(q,n){var o=q||"正在运行请稍候......";var l=d("#cmdshowwaiting");if(l.length<1){d("body").append('<div id="cmdshowwaiting"></div>');l=d("#cmdshowwaiting")}var m=d("#"+n);if(m.length<1){d("body").append('<div id="'+n+'">'+o+"</div>");m=d("#"+n)}var p=b();l.css({width:p.aw,height:p.ah}).show();m.empty().html(o).css({top:p.st+(p.ch-m.height())/2,left:p.sl+(p.cw-m.width())/2}).show()}function a(l){d("#"+l).hide();d("#cmdshowwaiting").hide()}d.ShowWaiting=function(l){c(l,"cmdshowwaitingdiv")};d.HideWaiting=function(){a("cmdshowwaitingdiv")};d.ShowTipMsg=function(n,m){var l=m||5000;c(n,"cmdtipmsg");setTimeout(function(){a("cmdtipmsg")},l)}})(window,jQuery);(function(b){var a=10;var c=function(d,e){this.$elem=b(d);this.ops=b.extend({defaultPage:0,closable:false,pageBody:true,pages:[]},e);this.tid="htps"+a;if(this.ops.id){this.tid=this.ops.id}this.curPageid=0;a+=1;if(this.ops.onPageChanging){this.onPageChanging=this.ops.onPageChanging}if(this.ops.onPageChanged){this.onPageChanged=this.ops.onPageChanged}if(this.ops.onPageClosing){this.onPageClosing=this.ops.onPageClosing}if(this.ops.onPageClosed){this.onPageClosed=this.ops.onPageClosed}if(this.ops.onShowContextMenu){this.onShowContextMenu=this.ops.onShowContextMenu}};c.prototype._init=function(){var f=[];var g=[];var d=[];var e=this;if(this.ops.pages.length<1){this.$elem.children("div.cpage").each(function(k){var h={};var l=b(this);h.id=l.attr("id");h.title=l.attr("title");h.iconClass=l.attr("iconClass");h.src=l;h.hideClose=(l.attr("hideClose")=="true")?true:false;e.ops.pages.push(h)})}b.each(this.ops.pages,function(h,k){g.push(e._git(h,k));d.push(e._giv(h,k))});f.push('<table id="'+this.tid+'" class="htps" cellspacing="0" cellpadding="0"><thead><tr class="htps-htr"><th class="htps-th" id="'+this.tid+'_th">');f.push('<div class="htps-th-div-w"><div class="htps-th-div">'+g.join("")+"</div></div>");f.push('<span class="htps-left-a">&lt;&nbsp;</span><span class="htps-right-a">&nbsp;&gt;</span></th></tr></thead><tbody>');if(this.ops.pageBody){f.push('<tr><td class="htps-ptd" id="'+this.tid+'_tp">');f.push(d.join(""));f.push("</td></tr>")}f.push("</tbody></table>");this.$elem.append(f.join(""));if(!this.ops.pageBody){b("#"+this.tid).css({"border-bottom":"0 none"})}this.$th=b("#"+this.tid+"_th");b.each(this.ops.pages,function(h){if(this.src instanceof jQuery){b("#"+e.tid+"_p"+this.idx).append(this.src)}});this.$th.on("click",".htps-t",function(){var h=parseInt(b(this).attr("idx"));e._selectPage(h)});this.$th.on("click",".htps-tclose",function(){var h=parseInt(b(this).attr("idx"));e._closePage(h)});b(".htps-tclose",this.$th).hover(function(){b(this).addClass("htps-tclose-hover")},function(){b(this).removeClass("htps-tclose-hover")});this._resize();b(window).on("resize",function(){e._resize()});this.$th.on("contextmenu",".htps-t",function(){var h=parseInt(b(this).attr("idx"));if(b(this).hasClass("htps-tdisp")){return false}e.showContextMenu(h);return false});this._selectPage(this.ops.defaultPage);this.$th.on("click",".htps-right-a",function(){var h=b(".htps-th-div",this.$th);var i=b(".htps-t:last",h);var k=h.position().left;var n=i.position().left+i.outerWidth()+k;var m=h.parent().outerWidth();if(n>m){var o=50;b(".htps-t",h).each(function(p){if(b(this).position().left>=-k){o=b(this).outerWidth();return false}});if(o>n-m){o=n-m}var l=k-o;h.animate({left:l+"px"},"slow",function(){e._resize()})}});this.$th.on("click",".htps-left-a",function(){var h=b(".htps-th-div",this.$th);var i=b(".htps-t:last",h);var k=h.position().left;if(k<0){var m=50;b(".htps-t",h).each(function(n){if(b(this).position().left<-k){m=b(this).outerWidth();return false}});var l=k+m;if(l>0){l=0}h.animate({left:l+"px"},"slow",function(){e._resize()})}})};c.prototype._resize=function(){b(".htps-left-a",this.$th).hide();b(".htps-right-a",this.$th).hide();var n=b(".htps-t:last",this.$th);if(n.length<1){return}b(".htps-pwrap-"+this.tid).css({width:"1px",height:"1px"});var m=b(".htps-th-div",this.$th);if(m.length<1){return}var l=m.find(".htps-t");var n=l.last();var k=m.position().left;var d=n.position().left+n.outerWidth()+k;var e=m.parent();e.css({width:"1px"});var g=this.$th.width();var h=0;for(var f=0;f<l.length;f++){h+=b(l.get(f)).outerWidth()}if(h<g){m.css({left:0});k=0}else{if(d>g){b(".htps-right-a",this.$th).show()}else{b(".htps-right-a",this.$th).hide()}}if(k<0){b(".htps-left-a",this.$th).show()}else{b(".htps-left-a",this.$th).hide()}b(".htps-pwrap-"+this.tid).css({width:"100%",height:b("#"+this.tid+"_tp").outerHeight()+"px"});e.css({width:(g-1)+"px"}).parent().css({width:(g-1)+"px"})};c.prototype._git=function(f,d){if(!d.title){d.title="无标题"}var e='<span class="htps-t" id="'+this.tid+"_t"+f+'" idx="'+f+'"';if(d.id){e+=' pid="'+d.id+'"'}e+='><a class="htps-ta"><span class="htps-tr">';if(d.iconClass){if(d.iconClass.substr(0,5)!="icon_"){d.iconClass="icon_"+d.iconClass}e+='<span class="htps-ti '+d.iconClass+'"></span>'}e+='<span class="htps-tt">'+d.title+"</span>";if(this.ops.closable){if(d.hideClose){}else{e+='<span class="htps-tclose"  idx="'+f+'" >&nbsp;</span>'}}e+="</span></a></span>";return e};c.prototype._giv=function(e,f){var d=[];f.idx=-1;d.push('<div class="htps-pwrap htps-pwrap-'+this.tid+'" id="'+this.tid+"_p"+e+'">');if(f.src){if(typeof f.src=="string"){d.push('<iframe frameborder="no" class="htps-wrap-content-frame" id="'+this.tid+"_pf"+e+'" src="'+f.src+'"></iframe>')}else{if(b.isFunction(f.src)){d.push(f.src(this))}else{if(f.src instanceof jQuery){f.idx=e}else{d.push(f.src)}}}}d.push("</div>");return d.join("")};c.prototype._getIdx=function(g){var f=b("#"+this.tid);if(typeof g=="string"){var e=b(".htps-t[pid='"+g+"']",f);return e.attr("idx")}var d=b(".htps-t:eq("+g+")",f);return d.attr("idx")};c.prototype._selectPage=function(m){if(b.isFunction(this.onPageChanging)){if(!this.onPageChanging(m)){return}}var f=b("#"+this.tid+"_t"+m,this.$th);if(f.length<1){return}if(f.hasClass("htps-tdisp")){return}var g=b(".htps-ts",this.$th);b(".htps-pwrap-"+this.tid).hide();g.removeClass("htps-ts");f.addClass("htps-ts");var e=b("#"+this.tid+"_p"+m);e.css({height:b("#"+this.tid+"_tp").height()+"px",display:"block"}).show();e.find(".hgv").each(function(){var p=b(this).data("$hgv$");if(p&&b.isFunction(p.resize)){p.resize()}});this.curPageid=m;if(b.isFunction(this.onPageChanged)){this.onPageChanged(m)}if(b.gCalendar){b.gCalendar().hide()}var d=f.position().left;var h=f.outerWidth();var i=b(".htps-th-div",this.$th);var l=i.position().left;var o=this.$th.width();var k=999;if(d<(-l)){k=-d}else{if((d+h)>(o-l)){k=l-((d+h)-(o-l))}}var n=this;if(k<=0){i.animate({left:k+"px"},"slow",function(){n._resize()})}};c.prototype._showPage=function(d,e){var g=b("#"+this.tid+"_t"+d,this.$th);var f=b("#"+this.tid+"_p"+d).hide();if(e){g.show();f.show()}else{g.hide();f.hide()}this._resize()};c.prototype._closePage=function(d){var h=b("#"+this.tid+"_t"+d,this.$th);if(b.isFunction(this.onPageClosing)){if(!this.onPageClosing(d)){return false}}var g=-1;var e=-1;var f=false;b(".htps-t",this.$th).each(function(l){var k=parseInt(b(this).attr("idx"));if(k==d){f=true}else{if(f){g=k;return false}}if(!f){e=k}});h.remove();b("#"+this.tid+"_p"+d).remove();this._resize();if(b.isFunction(this.onPageClosed)){this.onPageClosed(d)}if(b.gCalendar){b.gCalendar().hide()}if(g>-1){this._selectPage(g)}else{if(e>-1){this._selectPage(e)}}return false};c.prototype._enablePage=function(e,f){var d=this._getIdx(e);var g=b("#"+this.tid+"_t"+d,this.$th);if(g.hasClass("htps-ts")){return}if(f){g.removeClass("htps-tdisp").removeAttr("disabled").attr("title","")}else{g.addClass("htps-tdisp").attr("disabled","disabled").attr("title","该选项已禁用")}};c.prototype.addPage=function(e){var d=this.ops.pages.push(e)-1;b(".htps-th-div",this.$th).append(this._git(d,e));b("#"+this.tid+"_tp").append(this._giv(d,e));this._resize();this._selectPage(d);return d};c.prototype.selectPage=function(e){var d=this._getIdx(e);this._selectPage(d)};c.prototype.enablePage=function(d){this._enablePage(d,true)};c.prototype.disablePage=function(d){this._enablePage(d,false)};c.prototype.getPage=function(e){var d=this._getIdx(e);return b("#"+this.tid+"_p"+d)};c.prototype.getSelectedIndex=function(){var f=b("#"+this.tid);var e=b(".htps-t",f);var d=0;e.each(function(g){if(b(this).attr("idx")==this.curPageid){d=g}return false});return d};c.prototype.getSelectedPage=function(){return b("#"+this.tid+"_p"+this.curPageid)};c.prototype.resize=function(){alert("1");this._resize()};c.prototype.showPage=function(e){var d=this._getIdx(e);return this._showPage(d,true)};c.prototype.hidePage=function(e){var d=this._getIdx(e);return this._showPage(d,false)};c.prototype.closePage=function(e){var d=this._getIdx(e);return this._closePage(d)};c.prototype.showContextMenu=function(d){if(b.isFunction(this.onShowContextMenu)){this.onShowContextMenu(d)}};c.prototype.getPageCount=function(){return b(".htps-t",b("#"+this.tid)).length};c.prototype.getPageObject=function(d){var e=b(".htps-t:eq("+d+")",b("#"+this.tid));return this.ops.pages[parseInt(e.attr("idx"))]};c.prototype.closeAll=function(){var e=this.getPageCount();for(var d=0;d<e;d++){this.closePage(d)}};b.TabPages=function(h,g){if(arguments.length==1){if(typeof arguments[0]=="string"){var d=b("#"+arguments[0]);var i=d.data("$obj$");if(i){return i}}return{}}var f=b(h);tv=new c(h,g);tv._init();b("#"+tv.tid).data("$obj$",tv);return tv}})(jQuery);(function(e){var k=0;function g(o,q,n){for(var m=0;m<o.length;m++){var p=o[m];if(p.id&&p.checkType){if(p.id==q){if(p.check){p.check=n}else{p.check=n}return true}}else{if(p.items&&p.items.length>0){if(g(p.items,q,n)){return true}}}}return false}function d(p,m,r){var o=[];var q;for(var n=0;n<m.length;n++){q=m[n];if(q.text=="-"){o.push('<div class="chpm-item-split"></div>')}else{o.push('<a href="javascript:void(0);" class="chpm-item');if(q.items){o.push(" chpm-item-hassub")}if(q.disable){o.push(" chpm-item-disp")}if(q.checkType){o.push(" checkitem")}o.push('" data-lv="'+r+'" data-idx="'+n+'"');if(q.id){o.push(' data-id="'+q.id+'"')}o.push('><span class="chpm-item-icon');if(q.checkType){if(q.check){o.push(" icon_tick")}}else{if(q.icon){o.push(" icon_"+q.icon)}}o.push('">&nbsp;</span><span class="chpm-item-text">'+q.text+"</span>");o.push("</a>")}}return o.join("")}function i(o){var m=96;for(var r=0;r<o.length;r++){var q=o[r].text;var n=28;if(q.length>0){for(var p=0;p<q.length;p++){n+=q.charCodeAt(p)>255?16:8}}if(n>m){m=n}}return m}function c(p,n){var m=e("#"+p.mid);var o=m.css("z-index");if(!o){o=999900}else{o=parseInt(o)+1}e("body").append('<div class="chpm" id="'+this.mid+'_" style="z-index:999900;"></div>')}function b(q,p,m){if(p.length<1){return q.items[m].items}var r=p.split("|");var n=q.items;for(var o=0;o<r.length;o++){n=n[parseInt(r[o])].items}return n[m].items}function f(q,n,p){var o=q.parent().attr("grow");var r=q.attr("data-id");if(q.hasClass("checkitem")){var m=e(".chpm-item-icon",q);if(!m.hasClass("icon_tick")){m.addClass("icon_tick")}g(n.items,r,true)}if(r){if(e.isFunction(n.OnClick)){n.OnClick(r,o)}}n._hide()}function h(o,x,t){var n=parseInt(x.attr("data-lv"));var y=parseInt(x.attr("data-idx"));var r=x.parent();var v=r.attr("data-pidx")||"";var m=v.length>0?(v+"|"+y):y;if(x.hasClass("chpm-item-hassub")){var q=x.offset();var u=b(o,v,y);var w=e("#"+o.id+"_"+n);var p={x:q.left+x.width()-6,y:q.top+6,w:i(u)};if(w.attr("data-pidx")==m){l(w,p.x,p.y,p.w,q.left);w.show();return false}e(".chpm-curitem",r).removeClass("chpm-curitem");x.addClass("chpm-curitem");if(w.length<1){e("body").append('<div class="chpm" data-pidx="'+m+'" id="'+o.id+"_"+n+'" style="z-index:'+(o.zindex+n+1)+'"></div>');w=e("#"+o.id+"_"+n);w.on("click",".chpm-item",function(A){var z=e(this);f(z,o,A);return false})}w.attr("data-pidx",m).empty();l(w,p.x,p.y,p.w,q.left);w.append(d(o,u,n+1)).show("slow");e(".chpm-item",w).bind("mouseenter",function(z){h(o,e(this),z)});for(var s=n+1;s<10;s++){e("#"+o.id+"_"+s).hide()}}else{e(".chpm-curitem",x.parent()).removeClass("chpm-curitem");for(var s=n;s<10;s++){e("#"+o.id+"_"+s).hide()}}}function l(o,s,r,u,m){var n=e.getViewportSize(window);var q=e.getScrollOffsets(window);s+=q.x;r+=m?0:q.y;var t=r;var p=o.outerHeight();var v=s;if((t+p)>(n.h+q.y)){t=n.h+q.y-p}if((v+u)>(n.w+q.x)){v=n.w+q.x-u}if(m){if(v!=s){v=m-u+6}}o.css({top:t,left:v,width:u+"px"}).show()}var a=function(n){this.ops=e.extend({items:[],zindex:999900,_hide:function(){for(var o=0;o<10;o++){e("#"+this.id+"_"+o).hide()}e("#"+this.id).hide()}},n);if(this.ops.id){this.mid=this.ops.id}else{this.mid="hpm"+(k++)}this.ops.id=this.mid;e("body").append('<div class="chpm" data-pidx="" id="'+this.mid+'" style="z-index:'+this.ops.zindex+'"></div>');var m=this;this.$self=e("#"+this.mid);this.$self.on("click",".chpm-item",function(p){var o=e(this);f(o,m.ops,p);return false});e(document).bind("click",function(o){m.ops._hide()})};a.prototype.show=function(m,p){e(".chpm").hide();var n=e("#"+this.mid);var o=this;n.empty();n.append(d(this.ops,this.ops.items,0));e(".chpm-item",n).bind("mouseenter",function(q){h(o.ops,e(this),q)});l(n,m||0,p||0,i(this.ops.items));n.show("fast")};a.prototype.checkItem=function(p,o){var n=e('a[data-id="'+p+'"]');if(n.length>0){var m=e(".chpm-item-icon",n);if(o){m.addClass("icon_tick")}else{m.removeClass("icon_tick")}g(this.ops.items,p,o)}};a.prototype.isChecked=function(o){var n=e('a[data-id="'+o+'"]');if(n.length>0){var m=e(".chpm-item-icon",n);if(m.hasClass("icon_tick")){return true}}return false};e.PopMenu=function(o){var n=new a(o);e("#"+n.mid).data("$m",n);return n}})(jQuery);(function(){var e=19;var d="lib/ocx/";var b=10;function c(n,g,m,f,h){this.$ocx=false;var k=g.indexOf(".");if(!m){if(k>0){m=g.substr(0,k)}else{m=g}}var l=$("#"+m);if(l.length<1){var i=n+","+d;if($.browser.msie){f.append('<object id="'+m+'" style="'+h+'" classid="clsid:B32500F9-66AB-4C93-A352-92847096A0CD"><param name="bean" value="'+g+'"/><param name="path" value="'+i+'"/></object>')}else{f.append('<embed id="'+m+'" style="'+h+'" type="application/x-leswdl-plugin" path="'+i+'" bean="'+g+'" />')}l=$("#"+m)}this.$ocx=l.get(0);this.basePath=n;if(this.basePath.substr(this.basePath.length-1,1)!="/"){this.basePath+="/"}}c.prototype.init=function(){try{var f=this.$ocx.getv();if(f<e){this.$ocx=false;a("本网页部分功能需要使用到的浏览器安全插件版本需要升级,请重新安装",this.basePath+"lib/ocx/install.html")}}catch(g){this.$ocx=false;a("本网页部分功能需要使用到浏览器安全插件,请安装",this.basePath+"lib/ocx/install.html")}};function a(f,k){if($.ShowDlg){$.ShowDlg(k,{title:f,width:"94%",height:"94%",okButton:false,cancelButton:false});return}var i=$("#wdlsetup");if(i.length<1){var g=[];g.push('<table id="wdlsetup"  style="position:absolute;top:0px;left:0px;border:4px solid #e00;margin:4px;width:98%;height:98%;background-color:#ccf;font-family: 微软雅黑, 宋体;font-size:12pt"><tbody>');g.push('<tr style="height:12%;"><td style="width:32px;"></td><td align="center" style=""><h3>'+f+'</h3></td><td style="width:32px"></td></tr>');g.push('<tr style="height:88%;"><td align="center" colspan="3"><iframe frameborder="1" width="99%" height="99%" src="'+k+'"/></td></tr>');g.push("</tbody></table>");$("body").append(g.join(""));i=$("#wdlsetup")}i.fadeTo(200,0.95)}$.Ocx=function(k,g){var f,h;if(arguments.length==1){f=false;h=arguments[0];if($.GLOBALCONFIG){if($.GLOBALCONFIG.basePath){f=$.GLOBALCONFIG.basePath}}}else{f=k;h=g}if(!f||f.length<1){alert("无法创建$.Ocx对象,basePath参数为空");return false}var i=new c(f,h,false,$("body"),$.browser.msie?"display:none;":"position:absolute;width:1px;height:1px");i.init();return i.$ocx};$.OcxCtrl=function(f){b++;var g=$.extend({basePath:false,id:"ocxc"+b,append:$("body"),style:"border:0 none;display:block;width:100%;height:100%;",initParam:""},f);if(!g.basePath||g.basePath.length<1){if($.GLOBALCONFIG){if($.GLOBALCONFIG.basePath){g.basePath=$.GLOBALCONFIG.basePath}}if(!g.basePath||g.basePath.length<1){alert("无法创建$.OcxCtrl对象,basePath参数为空");return false}}if(!g.name||g.name.length<1){alert("无法创建$.OcxCtrl对象,名称为空");return false}var h=new c(g.basePath,g.name,g.id,g.append,g.style);h.init();h.$ocx.loadlib(g.initParam);return h.$ocx}})();(function($){var printX=function(p){this.$ocx=false;this.sp="\u0001";this.doc=[]};printX.prototype.addp=function(str){this.doc.push(str+"\r\n")};printX.prototype._startDoc=function(p){if(this.$ocx){this.ops=$.extend({title:"无标题",pageWidth:1100,pageHeight:1100,unit:"I",defaultFontName:"宋体",defaultFontSize:11,x:0,y:0},p);this.doc=[];this.addp("@lesprintfile#$!");this.addp("startdoc"+this.sp+this.ops.title+this.sp+this.ops.pageWidth+this.sp+this.ops.pageHeight+this.sp+this.ops.unit+this.sp+this.ops.defaultFontName+this.sp+this.ops.defaultFontSize+this.sp+this.sp);this.addp("initorg"+this.sp+this.ops.x+this.sp+this.ops.y+this.sp);this.addPage()}};printX.prototype.addPage=function(){if(this.$ocx){this.addp("addPage"+this.sp+this.sp)}};printX.prototype.addFont=function(p){if(this.$ocx){this.addp("addFont"+this.sp+p.name+this.sp+p.size+this.sp)}};printX.prototype.text=function(param){if(this.$ocx){var p=$.extend({x:0,y:0,w:100,h:24,b:0,t:"",f:0,a:1},param);this.addp("text"+this.sp+p.x+this.sp+p.y+this.sp+p.w+this.sp+p.h+this.sp+p.b+this.sp+p.t+this.sp+p.f+this.sp+p.a+this.sp)}};printX.prototype.rect=function(param){if(this.$ocx){var p=$.extend({x:0,y:0,w:100,h:24,b:15},param);this.addp("rect"+this.sp+p.x+this.sp+p.y+this.sp+p.w+this.sp+p.h+this.sp+p.b+this.sp)}};printX.prototype.print=function(param){if(this.$ocx){var p=$.extend({flag:0,parentWnd:0},param);this.addp("print"+this.sp+p.flag+this.sp+p.parentWnd+this.sp);var r=window.eval("("+this.$ocx.call("$prtt",this.doc.join(""))+")");this.doc=[];if(typeof r==="object"){if(r.errorCode){alert(r.errorMsg)}}}};$.PrintDoc=function(p){var $p=new printX();$p.$ocx=$.Ocx("PrtEngine.wdl");if(p){$p._startDoc(p)}return $p};var $pbuffer=function(d){this.data=d;this.sp=["","","","","",""];this.f_buf=[];this.l_buf=[]};$pbuffer.prototype.fv=function(n,v){this.f_buf.push(n+this.sp[0]+v.toString()+this.sp[1])};$pbuffer.prototype.pobj=function(n,obj){for(var on in obj){var an=n?n+"."+on:on;var v=obj[on];if($.isArray(v)){this.plist(an,v)}else{if(typeof v=="object"){this.pobj(an,v)}else{this.fv(an,v)}}}};$pbuffer.prototype.plist=function(n,list){this.fv(n,"[$]");this.fv(n+".rows",list.length);if(list.length<1){return}var row1=list[0];if(typeof row1=="object"){var colnames=[];for(var cn in row1){colnames.push(cn)}this.fv(n+".cols",colnames.join(this.sp[3]));this.l_buf.push(this.sp[2]+"<"+n+">"+this.sp[2]);for(var i=0;i<list.length;i++){var rowdata=list[i];var rowdatajoin=[];for(var c=0;c<colnames.length;c++){rowdatajoin.push(rowdata[colnames[c]])}this.l_buf.push(rowdatajoin.join(this.sp[3])+this.sp[4])}}};$pbuffer.prototype.toStr=function(){var ret="";if(this.f_buf.length<1){return ret}ret=this.f_buf.join("")+this.sp[5];if(this.l_buf.length>0){ret=ret+this.l_buf.join("")+this.sp[5]}return ret};$.PrintData=function(data,templateUrl,bdefault){if(typeof data=="object"){var $pbuf=new $pbuffer(data);var url=templateUrl;if(url.indexOf("://")<0){if($.GLOBALCONFIG){if($.GLOBALCONFIG.basePath){url=$.GLOBALCONFIG.basePath+templateUrl}}}$pbuf.fv("tempfile",url);if($.Session){if($.Session.sessionid){$pbuf.fv("jsessionid",$.Session.sessionid)}}else{$pbuf.fv("jsessionid","")}$pbuf.pobj(false,data);var $ocx=$.Ocx("PrtEngine.wdl");var funname="$prtt";if(bdefault){funname="$prtt2"}var ret=$ocx.call(funname,$pbuf.toStr());var retObj=window.eval("("+ret+")");if(typeof retObj=="object"){if(retObj.errorCode){alert(retObj.errorMsg)}}}};$.PrintUrl=function(ops){if(!$.isPlainObject(ops)){alert("$.PrintUrl打印函数必需传参数对象!");return -1}var $ocx=$.Ocx("PrtEngine.wdl");if($ocx){var xdata=ops.data||{};if(ops.url.indexOf("jspaction/")>=0){xdata={jspactionreqjson:JSON.stringify(ops.data||{})}}$.ajax({url:ops.url,type:"POST",dataType:"text",data:$.extend({_resultType:"print",tempfile:ops.templateUrl},xdata),beforeSend:function(xhr){if(window.top){if(window.top.$showwaiting){window.top.$showwaiting("正在打印请稍候...")}}else{if($.ShowWaiting){$.ShowWaiting("正在打印请稍候...")}}},_closeWaiting:function(){if(window.top){if(window.top.$hidewaiting){window.top.$hidewaiting()}}else{if($.HideWaiting){$.HideWaiting()}}},success:function(data){var funname="$prtt";if(ops.bdefault){funname="$prtt2"}var r=$ocx.call(funname,data);var ro=window.eval("("+r+")");if(typeof ro=="object"){if(ro.errorCode){alert(ro.errorMsg)}}this._closeWaiting()},error:function(e){alert("请求打印数据出错!\n可能原因:\n	■与服务器的网络中断\n	■无法访问打印请求["+this.url+"]");this._closeWaiting()}})}return 0}})(jQuery);(function(d){var h=d.StringHelper,b={_prefix:"les_layout",_uidx:0,_kidx:0,_typeStrcuReg:/^([1-9]|1\d|2[0-6])[a-z]$/i,_defaultType:"2e",_panelIdReg:/(panel-[a-z])/ig},k={"2e":'<table style="width:100%;height:100%;" cellspacing="0" cellpadding="0" border="0"><tr><td id="panel-a" valign="top"></td></tr><tr><td id="panel-b" valign="top"></td></tr></table>',"3e":'<table style="width:100%;height:100%;" cellspacing="0" cellpadding="0" border="0"><tr><td id="panel-a" valign="top"></td></tr><tr><td id="panel-b" valign="top"></td></tr><tr><td id="panel-c" valign="top"></td></tr></table>',"2u":'<table style="width:100%;height:100%;" cellspacing="0" cellpadding="0" border="0"><tr><td id="panel-a" valign="top"></td><td id="panel-b" valign="top"></td></tr></table>',"3w":'<table style="width:100%;height:100%;" cellspacing="0" cellpadding="0" border="0"><tr><td id="panel-a" valign="top"></td><td id="panel-b" valign="top"></td><td id="panel-c" valign="top"></td></tr></table>'},i=function(n,o){this.uid=c();this.panelTemplateId="#"+this.uid+"_panel-{0}";this.$ele=n;this.layoutTable=null;this.panels={};this.ops=d.extend({type:b._defaultType},o);g.call(this)};function a(n){if(!this.panels.hasOwnProperty(n)){return null}return this.panels[n]}function e(){var o={},n=this;d.each(k,function(p,q){o[p]=q});d.each(o,function(p,q){o[p]=q.replace(b._panelIdReg,n.uid+"_$1")});return o}function g(){var o=this.ops,p,n=String(o.type).toLowerCase();!k.hasOwnProperty(n)&&(n=b._defaultType);p=e.call(this);this.layoutTable=d(p[n]);if(!this.layoutTable.length){return}m.call(this,n);f.call(this)}function m(s){var n=this.panels,r,q="",p,o;if(!b._typeStrcuReg.test(s)){return}r=RegExp["$1"];p=this.panelTemplateId;for(o=1;o<=r;o+=1){q+=h.format(p,String.fromCharCode(o+96))+","}q=q.slice(0,q.length-1);d(q,this.layoutTable).each(function(){n[this.id.charAt(this.id.length-1)]=d(this)})}function f(){var n=this.panels,o=this.ops;d.each(n,function(p,q){q.height(o[p]);o[p+"Style"]&&q.attr("style",o[p+"Style"])});this.$ele.append(this.layoutTable)}function c(){return b._prefix+"_"+b._uidx++}function l(n){!d.isNumeric(n)&&(n=b._kidx++);return b._prefix+"_"+n}i.prototype={constructor:i,panel:a,getPanel:a};d.Layout=function(r,n){var q=d(r),p=q[0],o;if(!p){throw new Error("页面上没有对应id的元素存在, 请检查")}if(d.isNumeric(n)){if(n<b._kidx&&n>=0){return d.data(p,l(n))}return null}o=new i(q,n);d.data(p,l(),o);return o}})(jQuery);(function(c,f){var b="";if(c.workflow){return}c.workflow={ver:"1.0"};if(c.GLOBALCONFIG.ctxpath){b=c.GLOBALCONFIG.ctxpath+"/"}function a(i){var h=f.parent.WFE_AUTH_FORM_ELM;if(!h){return false}for(var g=0;g<h.length;g++){if(i==h[g]){return true}}return false}function e(r,l,m){if(l.name&&l.type=="fillidea"){var q=r.getItem(l.name);var k=q.attr("fillidea");if(k&&k=="1"){var p=q.attr("id");var g=c("#"+p+"_ov");if(g.length<1){var n=[];var o=l.val.split("\u0001");for(var h=1;h<o.length;h++){n.push('<div data-fid="'+p+'" class="hfv-fillidea-item">'+o[h]+"</div>")}q.val("").before('<div id="'+p+'_ov">'+n.join("")+"</div>");if(m){q.hide()}}}}}c.workflow.initForm=function(r,h){var p=f.parent.WFE_ALL_FORM_ELM;var k=f.parent.WFE_TASK_TEMPVARS;var o,n,q,s;var l=function(i){var t=i.split(".");if(t.length>1){if(r.ops.name==t[0]){return t[1]}return false}return i};if(p){n={};for(var m=0;m<p.length;m++){o=p[m];s=l(o.name);if(s){n[s]=o.val}}r.setData(n);r.itemOff();r.btnOff();for(var m=0;m<p.length;m++){o=p[m];if(a(o.name)){s=l(o.name);if(s){if(o.type=="button"){r.btnOn(s)}else{r.itemOn(s)}}q=false}else{if(o.type=="button"){s=l(o.name);if(s){r.btnHide(s)}}q=true}e(r,o,q)}if(k){n={};for(var g in k){if(a(g)){n[g]=k[g]}}r.setData(n)}}else{throw new Error("本页面$.workflow.initForm函数必须在工作流表单框架下运行，无法单独运行!")}};function d(){this._action=false;this.$vars={}}d.prototype.setAction=function(g){this._action=g};d.prototype.setVar=function(g,h){if(arguments.length<2){if(c.isPlainObject(g)){this.setVars(g);return}throw new Error("wfe事件对象的方法setVar参数为name和val,请正确传入")}this.$vars[g]=h};d.prototype.setVars=function(g){c.extend(this.$vars,g)};d.prototype.getAction=function(){return this._action};d.prototype.getVars=function(){return this.$vars};d.prototype.getVar=function(){return this.$vars[name]};c.workflow.NewWfeEventObject=function(){return new d()};c.workflow.bind=function(h,g){if(f.self==f.parent){throw new Error("本页面$.workflow.bind函数必须在工作流表单框架下运行，无法单独运行!")}if((typeof h=="string")&&c.isFunction(g)){f.parent[h]=g;return true}return false};c.workflow.formPageReady=function(g){if(f.self!=f.parent){if(c.isFunction(f.parent.OnFormPageReady)){f.parent.OnFormPageReady(g)}}};c.workflow.elemInAuth=function(g){return a(g)};c.workflow.InstCreate=function(k){var i,l,h="workflow/execute",g;if(typeof k=="string"){i=k;l=h+templid;g={}}else{i=k.tmplId||k.tempid;l=k.action||(h+i);g=k.initVars||{}}g._actid=i;g._event="OnInstCreate";c.callAjax({url:l,data:g,ok:k.ok,fail:k.fail})};c.workflow.InstCreateAndOpen=function(g,h){if(!c.ShowDlg){throw new Error("$.workflow.InstCreateAndOpen需要les.ui2.dialogview.js的支持")}c.ShowWaiting();if(typeof g=="string"){g={tmplId:""+g}}var i=c.extend({ok:function(k){alert(JSON.stringify(k));c.HideWaiting();c.ShowDlg("pages/workflow/task_deal.jsp?taskid="+k.taskId,c.extend({okButton:false,width:"98%",height:"98%",title:k.instName+"-->"+k.nodeName},h))},fail:function(k){c.HideWaiting()}},g);c.workflow.InstCreate(i)}})(jQuery,window);